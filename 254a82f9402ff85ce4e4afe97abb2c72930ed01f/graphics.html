<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { color: #585cf6; } /* Constant */
code span.co { color: #4c886b; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.dv { color: #0000cd; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cd; } /* Float */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { color: #687687; } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #036a07; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>OCEAN 5098: Graphics</title>


  <link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>
  <link rel="icon" type="image/png" href="images/logo.png"/>


  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="OCEAN 5098: Graphics"/>
  <meta property="og:type" content="article"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="OCEAN 5098"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="OCEAN 5098: Graphics"/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title"]}},"value":[{"type":"character","attributes":{},"value":["Graphics"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <meta name="distill:offset" content=""/>

  <script type="application/javascript">

    window.headroom_prevent_pin = false;

    window.document.addEventListener("DOMContentLoaded", function (event) {

      // initialize headroom for banner
      var header = $('header').get(0);
      var headerHeight = header.offsetHeight;
      var headroom = new Headroom(header, {
        tolerance: 5,
        onPin : function() {
          if (window.headroom_prevent_pin) {
            window.headroom_prevent_pin = false;
            headroom.unpin();
          }
        }
      });
      headroom.init();
      if(window.location.hash)
        headroom.unpin();
      $(header).addClass('headroom--transition');

      // offset scroll location for banner on hash change
      // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
      window.addEventListener("hashchange", function(event) {
        window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
      });

      // responsive menu
      $('.distill-site-header').each(function(i, val) {
        var topnav = $(this);
        var toggle = topnav.find('.nav-toggle');
        toggle.on('click', function() {
          topnav.toggleClass('responsive');
        });
      });

      // nav dropdowns
      $('.nav-dropbtn').click(function(e) {
        $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
        $(this).parent().siblings('.nav-dropdown')
           .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $("body").click(function(e){
        $('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $(".nav-dropdown").click(function(e){
        e.stopPropagation();
      });
    });
  </script>

  <style type="text/css">

  /* Theme (user-documented overrideables for nav appearance) */

  .distill-site-nav {
    color: rgba(255, 255, 255, 0.8);
    background-color: #0F2E3D;
    font-size: 15px;
    font-weight: 300;
  }

  .distill-site-nav a {
    color: inherit;
    text-decoration: none;
  }

  .distill-site-nav a:hover {
    color: white;
  }

  @media print {
    .distill-site-nav {
      display: none;
    }
  }

  .distill-site-header {

  }

  .distill-site-footer {

  }


  /* Site Header */

  .distill-site-header {
    width: 100%;
    box-sizing: border-box;
    z-index: 3;
  }

  .distill-site-header .nav-left {
    display: inline-block;
    margin-left: 8px;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header .nav-left {
      margin-left: 0;
    }
  }


  .distill-site-header .nav-right {
    float: right;
    margin-right: 8px;
  }

  .distill-site-header a,
  .distill-site-header .title {
    display: inline-block;
    text-align: center;
    padding: 14px 10px 14px 10px;
  }

  .distill-site-header .title {
    font-size: 18px;
    min-width: 150px;
  }

  .distill-site-header .logo {
    padding: 0;
  }

  .distill-site-header .logo img {
    display: none;
    max-height: 20px;
    width: auto;
    margin-bottom: -4px;
  }

  .distill-site-header .nav-image img {
    max-height: 18px;
    width: auto;
    display: inline-block;
    margin-bottom: -3px;
  }



  @media screen and (min-width: 1000px) {
    .distill-site-header .logo img {
      display: inline-block;
    }
    .distill-site-header .nav-left {
      margin-left: 20px;
    }
    .distill-site-header .nav-right {
      margin-right: 20px;
    }
    .distill-site-header .title {
      padding-left: 12px;
    }
  }


  .distill-site-header .nav-toggle {
    display: none;
  }

  .nav-dropdown {
    display: inline-block;
    position: relative;
  }

  .nav-dropdown .nav-dropbtn {
    border: none;
    outline: none;
    color: rgba(255, 255, 255, 0.8);
    padding: 16px 10px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    margin: 0;
    margin-top: 1px;
    z-index: 2;
  }

  .nav-dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 200px;
    border: 1px solid rgba(0,0,0,0.15);
    border-radius: 4px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
    z-index: 1;
    margin-top: 2px;
    white-space: nowrap;
    padding-top: 4px;
    padding-bottom: 4px;
  }

  .nav-dropdown-content hr {
    margin-top: 4px;
    margin-bottom: 4px;
    border: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .nav-dropdown-active {
    display: block;
  }

  .nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
    color: black;
    padding: 6px 24px;
    text-decoration: none;
    display: block;
    text-align: left;
  }

  .nav-dropdown-content .nav-dropdown-header {
    display: block;
    padding: 5px 24px;
    padding-bottom: 0;
    text-transform: uppercase;
    font-size: 14px;
    color: #999999;
    white-space: nowrap;
  }

  .nav-dropdown:hover .nav-dropbtn {
    color: white;
  }

  .nav-dropdown-content a:hover {
    background-color: #ddd;
    color: black;
  }

  .nav-right .nav-dropdown-content {
    margin-left: -45%;
    right: 0;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
    .distill-site-header a.nav-toggle {
      float: right;
      display: block;
    }
    .distill-site-header .title {
      margin-left: 0;
    }
    .distill-site-header .nav-right {
      margin-right: 0;
    }
    .distill-site-header {
      overflow: hidden;
    }
    .nav-right .nav-dropdown-content {
      margin-left: 0;
    }
  }


  @media screen and (max-width: 768px) {
    .distill-site-header.responsive {position: relative; min-height: 500px; }
    .distill-site-header.responsive a.nav-toggle {
      position: absolute;
      right: 0;
      top: 0;
    }
    .distill-site-header.responsive a,
    .distill-site-header.responsive .nav-dropdown {
      display: block;
      text-align: left;
    }
    .distill-site-header.responsive .nav-left,
    .distill-site-header.responsive .nav-right {
      width: 100%;
    }
    .distill-site-header.responsive .nav-dropdown {float: none;}
    .distill-site-header.responsive .nav-dropdown-content {position: relative;}
    .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
      display: block;
      width: 100%;
      text-align: left;
    }
  }

  /* Site Footer */

  .distill-site-footer {
    width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    z-index: 3;
    margin-top: 30px;
    padding-top: 30px;
    padding-bottom: 30px;
    text-align: center;
  }

  /* Headroom */

  d-title {
    padding-top: 6rem;
  }

  @media print {
    d-title {
      padding-top: 4rem;
    }
  }

  .headroom {
    z-index: 1000;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
  }

  .headroom--transition {
    transition: all .4s ease-in-out;
  }

  .headroom--unpinned {
    top: -100px;
  }

  .headroom--pinned {
    top: 0;
  }

  /* adjust viewport for navbar height */
  /* helps vertically center bootstrap (non-distill) content */
  .min-vh-100 {
    min-height: calc(100vh - 100px) !important;
  }

  </style>

  <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
  <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
  <script src="site_libs/headroom-0.9.4/headroom.min.js"></script>
  <script src="site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
  <script src="site_libs/fuse-6.4.1/fuse.min.js"></script>

  <script type="application/javascript">

  function getMeta(metaName) {
    var metas = document.getElementsByTagName('meta');
    for (let i = 0; i < metas.length; i++) {
      if (metas[i].getAttribute('name') === metaName) {
        return metas[i].getAttribute('content');
      }
    }
    return '';
  }

  function offsetURL(url) {
    var offset = getMeta('distill:offset');
    return offset ? offset + '/' + url : url;
  }

  function createFuseIndex() {

    // create fuse index
    var options = {
      keys: [
        { name: 'title', weight: 20 },
        { name: 'categories', weight: 15 },
        { name: 'description', weight: 10 },
        { name: 'contents', weight: 5 },
      ],
      ignoreLocation: true,
      threshold: 0
    };
    var fuse = new window.Fuse([], options);

    // fetch the main search.json
    return fetch(offsetURL('search.json'))
      .then(function(response) {
        if (response.status == 200) {
          return response.json().then(function(json) {
            // index main articles
            json.articles.forEach(function(article) {
              fuse.add(article);
            });
            // download collections and index their articles
            return Promise.all(json.collections.map(function(collection) {
              return fetch(offsetURL(collection)).then(function(response) {
                if (response.status === 200) {
                  return response.json().then(function(articles) {
                    articles.forEach(function(article) {
                      fuse.add(article);
                    });
                  })
                } else {
                  return Promise.reject(
                    new Error('Unexpected status from search index request: ' +
                              response.status)
                  );
                }
              });
            })).then(function() {
              return fuse;
            });
          });

        } else {
          return Promise.reject(
            new Error('Unexpected status from search index request: ' +
                        response.status)
          );
        }
      });
  }

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // get search element (bail if we don't have one)
    var searchEl = window.document.getElementById('distill-search');
    if (!searchEl)
      return;

    createFuseIndex()
      .then(function(fuse) {

        // make search box visible
        searchEl.classList.remove('hidden');

        // initialize autocomplete
        var options = {
          autoselect: true,
          hint: false,
          minLength: 2,
        };
        window.autocomplete(searchEl, options, [{
          source: function(query, callback) {
            const searchOptions = {
              isCaseSensitive: false,
              shouldSort: true,
              minMatchCharLength: 2,
              limit: 10,
            };
            var results = fuse.search(query, searchOptions);
            callback(results
              .map(function(result) { return result.item; })
            );
          },
          templates: {
            suggestion: function(suggestion) {
              var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
                ? `<img src="${offsetURL(suggestion.preview)}"</img>`
                : '';
              var html = `
                <div class="search-item">
                  <h3>${suggestion.title}</h3>
                  <div class="search-item-description">
                    ${suggestion.description || ''}
                  </div>
                  <div class="search-item-preview">
                    ${img}
                  </div>
                </div>
              `;
              return html;
            }
          }
        }]).on('autocomplete:selected', function(event, suggestion) {
          window.location.href = offsetURL(suggestion.path);
        });
        // remove inline display style on autocompleter (we want to
        // manage responsive display via css)
        $('.algolia-autocomplete').css("display", "");
      })
      .catch(function(error) {
        console.log(error);
      });

  });

  </script>

  <style type="text/css">

  .nav-search {
    font-size: x-small;
  }

  /* Algolioa Autocomplete */

  .algolia-autocomplete {
    display: inline-block;
    margin-left: 10px;
    vertical-align: sub;
    background-color: white;
    color: black;
    padding: 6px;
    padding-top: 8px;
    padding-bottom: 0;
    border-radius: 6px;
    border: 1px #0F2E3D solid;
    width: 180px;
  }


  @media screen and (max-width: 768px) {
    .distill-site-nav .algolia-autocomplete {
      display: none;
      visibility: hidden;
    }
    .distill-site-nav.responsive .algolia-autocomplete {
      display: inline-block;
      visibility: visible;
    }
    .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
      margin-left: 0;
      width: 400px;
      max-height: 400px;
    }
  }

  .algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
    width: 90%;
    outline: none;
    border: none;
  }

  .algolia-autocomplete .aa-hint {
    color: #999;
  }
  .algolia-autocomplete .aa-dropdown-menu {
    width: 550px;
    max-height: 70vh;
    overflow-x: visible;
    overflow-y: scroll;
    padding: 5px;
    margin-top: 3px;
    margin-left: -150px;
    background-color: #fff;
    border-radius: 5px;
    border: 1px solid #999;
    border-top: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
    cursor: pointer;
    padding: 5px 4px;
    border-bottom: 1px solid #eee;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
    border-bottom: none;
    margin-bottom: 2px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
    overflow: hidden;
    font-size: 0.8em;
    line-height: 1.4em;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
    font-size: 1rem;
    margin-block-start: 0;
    margin-block-end: 5px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
    display: inline-block;
    overflow: hidden;
    height: 2.8em;
    width: 80%;
    margin-right: 4%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
    display: inline-block;
    width: 15%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
    height: 3em;
    width: auto;
    display: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
    display: initial;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
    background-color: #eee;
  }
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
    font-weight: bold;
    font-style: normal;
  }

  </style>


  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <style type="text/css">
  /* base variables */

  /* Edit the CSS properties in this file to create a custom
     Distill theme. Only edit values in the right column
     for each row; values shown are the CSS defaults.
     To return any property to the default,
     you may set its value to: unset
     All rows must end with a semi-colon.                      */

  /* Optional: embed custom fonts here with `@import`          */
  /* This must remain at the top of this file.                 */



  html {
    /*-- Main font sizes --*/
    --title-size:      50px;
    --body-size:       1.06rem;
    --code-size:       14px;
    --aside-size:      12px;
    --fig-cap-size:    13px;
    /*-- Main font colors --*/
    --title-color:     #000000;
    --header-color:    rgba(0, 0, 0, 0.8);
    --body-color:      rgba(0, 0, 0, 0.8);
    --aside-color:     rgba(0, 0, 0, 0.6);
    --fig-cap-color:   rgba(0, 0, 0, 0.6);
    /*-- Specify custom fonts ~~~ must be imported above   --*/
    --heading-font:    sans-serif;
    --mono-font:       monospace;
    --body-font:       sans-serif;
    --navbar-font:     sans-serif;  /* websites + blogs only */
  }

  /*-- ARTICLE METADATA --*/
  d-byline {
    --heading-size:    0.6rem;
    --heading-color:   rgba(0, 0, 0, 0.5);
    --body-size:       0.8rem;
    --body-color:      rgba(0, 0, 0, 0.8);
  }

  /*-- ARTICLE TABLE OF CONTENTS --*/
  .d-contents {
    --heading-size:    18px;
    --contents-size:   13px;
  }

  /*-- ARTICLE APPENDIX --*/
  d-appendix {
    --heading-size:    15px;
    --heading-color:   rgba(0, 0, 0, 0.65);
    --text-size:       0.8em;
    --text-color:      rgba(0, 0, 0, 0.5);
  }

  /*-- WEBSITE HEADER + FOOTER --*/
  /* These properties only apply to Distill sites and blogs  */

  .distill-site-header {
    --title-size:       18px;
    --text-color:       rgba(255, 255, 255, 0.8);
    --text-size:        15px;
    --hover-color:      white;
    --bkgd-color:       #0F2E3D;
  }

  .distill-site-footer {
    --text-color:       rgba(255, 255, 255, 0.8);
    --text-size:        15px;
    --hover-color:      white;
    --bkgd-color:       #0F2E3D;
  }

  /*-- Additional custom styles --*/
  /* Add any additional CSS rules below                      */
  </style>
  <style type="text/css">
  /* base variables */

  /* Edit the CSS properties in this file to create a custom
     Distill theme. Only edit values in the right column
     for each row; values shown are the CSS defaults.
     To return any property to the default,
     you may set its value to: unset
     All rows must end with a semi-colon.                      */

  /* Optional: embed custom fonts here with `@import`          */
  /* This must remain at the top of this file.                 */



  html {
    /*-- Main font sizes --*/
    --title-size:      50px;
    --body-size:       1.06rem;
    --code-size:       14px;
    --aside-size:      12px;
    --fig-cap-size:    13px;
    /*-- Main font colors --*/
    --title-color:     #000000;
    --header-color:    rgba(0, 0, 0, 0.8);
    --body-color:      rgba(0, 0, 0, 0.8);
    --aside-color:     rgba(0, 0, 0, 0.6);
    --fig-cap-color:   rgba(0, 0, 0, 0.6);
    /*-- Specify custom fonts ~~~ must be imported above   --*/
    --heading-font:    sans-serif;
    --mono-font:       monospace;
    --body-font:       sans-serif;
    --navbar-font:     sans-serif;  /* websites + blogs only */
  }

  /*-- ARTICLE METADATA --*/
  d-byline {
    --heading-size:    0.6rem;
    --heading-color:   rgba(0, 0, 0, 0.5);
    --body-size:       0.8rem;
    --body-color:      rgba(0, 0, 0, 0.8);
  }

  /*-- ARTICLE TABLE OF CONTENTS --*/
  .d-contents {
    --heading-size:    18px;
    --contents-size:   13px;
  }

  /*-- ARTICLE APPENDIX --*/
  d-appendix {
    --heading-size:    15px;
    --heading-color:   rgba(0, 0, 0, 0.65);
    --text-size:       0.8em;
    --text-color:      rgba(0, 0, 0, 0.5);
  }

  /*-- WEBSITE HEADER + FOOTER --*/
  /* These properties only apply to Distill sites and blogs  */

  .distill-site-header {
    --title-size:       18px;
    --text-color:       rgba(255, 255, 255, 0.8);
    --text-size:        15px;
    --hover-color:      white;
    --bkgd-color:       #4C4C4C;
  }

  .distill-site-footer {
    --text-color:       rgba(255, 255, 255, 0.8);
    --text-size:        15px;
    --hover-color:      white;
    --bkgd-color:       #0F2E3D;
  }

    .distill-site-header .logo img {
      max-height: 30px;
      width: auto;
      margin-bottom: -7px;
    }

  /*-- Additional custom styles --*/
  /* Add any additional CSS rules below                      */
  </style>
  <style type="text/css">
  /* base style */

  /* FONT FAMILIES */

  :root {
    --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  body,
  .posts-list .post-preview p,
  .posts-list .description p {
    font-family: var(--body-font), var(--body-default);
  }

  h1, h2, h3, h4, h5, h6,
  .posts-list .post-preview h2,
  .posts-list .description h2 {
    font-family: var(--heading-font), var(--heading-default);
  }

  d-article div.sourceCode code,
  d-article pre code {
    font-family: var(--mono-font), var(--mono-default);
  }


  /*-- TITLE --*/
  d-title h1,
  .posts-list > h1 {
    color: var(--title-color, black);
  }

  d-title h1 {
    font-size: var(--title-size, 50px);
  }

  /*-- HEADERS --*/
  d-article h1,
  d-article h2,
  d-article h3,
  d-article h4,
  d-article h5,
  d-article h6 {
    color: var(--header-color, rgba(0, 0, 0, 0.8));
  }

  /*-- BODY --*/
  d-article > p,  /* only text inside of <p> tags */
  d-article > ul, /* lists */
  d-article > ol {
    color: var(--body-color, rgba(0, 0, 0, 0.8));
    font-size: var(--body-size, 1.06rem);
  }


  /*-- CODE --*/
  d-article div.sourceCode code,
  d-article pre code {
    font-size: var(--code-size, 14px);
  }

  /*-- ASIDE --*/
  d-article aside {
    font-size: var(--aside-size, 12px);
    color: var(--aside-color, rgba(0, 0, 0, 0.6));
  }

  /*-- FIGURE CAPTIONS --*/
  figure .caption,
  figure figcaption,
  .figure .caption {
    font-size: var(--fig-cap-size, 13px);
    color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
  }

  /*-- METADATA --*/
  d-byline h3 {
    font-size: var(--heading-size, 0.6rem);
    color: var(--heading-color, rgba(0, 0, 0, 0.5));
  }

  d-byline {
    font-size: var(--body-size, 0.8rem);
    color: var(--body-color, rgba(0, 0, 0, 0.8));
  }

  d-byline a,
  d-article d-byline a {
    color: var(--body-color, rgba(0, 0, 0, 0.8));
  }

  /*-- TABLE OF CONTENTS --*/
  .d-contents nav h3 {
    font-size: var(--heading-size, 18px);
  }

  .d-contents nav a {
    font-size: var(--contents-size, 13px);
  }

  /*-- APPENDIX --*/
  d-appendix h3 {
    font-size: var(--heading-size, 15px);
    color: var(--heading-color, rgba(0, 0, 0, 0.65));
  }

  d-appendix {
    font-size: var(--text-size, 0.8em);
    color: var(--text-color, rgba(0, 0, 0, 0.5));
  }

  d-appendix d-footnote-list a.footnote-backlink {
    color: var(--text-color, rgba(0, 0, 0, 0.5));
  }

  /*-- WEBSITE HEADER + FOOTER --*/
  .distill-site-header .title {
    font-size: var(--title-size, 18px);
    font-family: var(--navbar-font), var(--heading-default);
  }

  .distill-site-header a,
  .nav-dropdown .nav-dropbtn {
    font-family: var(--navbar-font), var(--heading-default);
  }

  .nav-dropdown .nav-dropbtn {
    color: var(--text-color, rgba(255, 255, 255, 0.8));
    font-size: var(--text-size, 15px);
  }

  .distill-site-header a:hover,
  .nav-dropdown:hover .nav-dropbtn {
    color: var(--hover-color, white);
  }

  .distill-site-header {
    font-size: var(--text-size, 15px);
    color: var(--text-color, rgba(255, 255, 255, 0.8));
    background-color: var(--bkgd-color, #0F2E3D);
  }

  .distill-site-footer {
    font-size: var(--text-size, 15px);
    color: var(--text-color, rgba(255, 255, 255, 0.8));
    background-color: var(--bkgd-color, #0F2E3D);
  }

  .distill-site-footer a:hover {
    color: var(--hover-color, white);
  }</style>
  <!--/radix_placeholder_distill-->
  <script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
  <script src="site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <style type="text/css">
  .screenshot {
    border: 1px solid rgba(0, 0, 0, 0.2);
  }

  .fake-img {
    background: #bbb;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 0px 4px rgba(0, 0, 0, 0.1);
    margin-bottom: 12px;
  }
  .fake-img p {
    font-family: monospace;
    color: white;
    text-align: left;
    margin: 12px 0;
    text-align: center;
    font-size: 16px;
  }


  html {
    scroll-behavior: smooth;
  }
  d-article {
      contain: none;
    }
  #TOC {
    position: fixed;
    z-index: 50;
    background: #ebebeb;     /* or   background: white; */
    padding: 10px;           /* optional */
    border-radius: 5px;      /* optional */
    }

  /* Hide the ToC when resized to mobile or tablet:  480px, 768px, 900px */
  @media screen and (max-width: 900px) {
  #TOC {
      position: relative;
    }
  }

  p.comment {
  background-color: #94F99B;
  padding: 10px;
  border: 1px solid black;
  margin-left: 25px;
  border-radius: 5px;
  font-style: normal;
  }

  p.alert {
  background-color: #F0756D;
  padding: 10px;
  border: 1px solid black;
  margin-left: 25px;
  border-radius: 5px;
  font-style: normal;
  }


  </style>
  <!--/radix_placeholder_site_in_header-->

  <link rel="stylesheet" href="styles.css" type="text/css"/>

</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Graphics","authors":[]}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo" href="https://www.dipintothereef.com/">
<img src="images/logo.png" alt="Logo"/>
</a>
<a href="index.html" class="title">OCEAN 5098</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="index.html">Home</a>
<a href="environment.html">Environment</a>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Manipulation
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="manipulation.html">Basics</a>
<a href="dplyr.html">dplyr</a>
<a href="tidyr.html">tidyr</a>
</div>
</div>
<a href="types.html">Types &amp; Structures</a>
<span class="nav-dropdown-header">Graphics</span>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Graphics</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->

</div>


<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#base-plot"><code>base</code> plot</a></li>
<li><a href="#settings">Settings</a></li>
<li><a href="#exporting">Exporting</a></li>
<li><a href="#package-lattice">Package <code>lattice</code></a></li>
<li><a href="#package-ggplot">Package <code>ggplot</code></a></li>
</ul>
</nav>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><a href="data:text/x-markdown;base64,LS0tDQp0aXRsZTogIkdyYXBoaWNzIg0KLS0tDQoNCmBgYHtyIGV2YWwgPSBUUlVFLCAgbWVzc2FnZT1GLCBpbmNsdWRlPUYsIHdhcm5pbmc9RiwgcHVybD1GLCByZXN1bHRzPSJoaWRlIn0NCmtuaXRyOjpwdXJsKCdncmFwaGljcy5SbWQnLCBkb2N1bWVudGF0aW9uID0gRikNCmBgYA0KDQpgYGB7ciBlY2hvPUZBTFNFLCBwdXJsPUZ9DQp4ZnVuOjplbWJlZF9maWxlKCdncmFwaGljcy5SbWQnKQ0KYGBgDQoNCmBgYHtyIGVjaG89RkFMU0UsIHB1cmw9Rn0NCnhmdW46OmVtYmVkX2ZpbGUoJ2dyYXBoaWNzLlInKQ0KYGBgDQoNCiMgYGJhc2VgIHBsb3QNCg0KIyMgUG9pbnQgYW5kIGxpbmUgcGxvdHMNCg0KIyMjIEJhc2ljcw0KDQpUaGUgbW9zdCBpbnR1aXRpdmUgcGxvdCBmdW5jdGlvbiBpbiBSIGlzIGBwbG90YCB3aGljaCBnZW5lcmF0ZXMgYm90aCBwb2ludHMgYW5kIGxpbmUgcGxvdHMuIEZvciBleGFtcGxlLCB0byBwbG90IGBQZXRhbC5MZW5ndGhgLCAgYFBldGFsLldpZHRoYCwgb3IgYFBldGFsLkxlbmd0aGAgdnMgYFBldGFsLldpZHRoYCB3ZSBjYW4gZG86DQoNCi0gSW5kZXggb2JzZXJ2YXRpb25zDQoNCmBgYHtyLCAgZXZhbD1UfQ0KcGxvdChpcmlzJFBldGFsLkxlbmd0aCkgIyBpbmRleCBvYnNlcnZhdGlvbiBmb3IgUGV0YWwuTGVuZ3RoDQpwbG90KGlyaXMkUGV0YWwuV2lkdGgpICMgaW5kZXggb2JzZXJ2YXRpb24gZm9yIFBldGFsLldpZHRoDQpgYGANCg0KLSBTY2F0dGVyIHBsb3RzDQoNCmBgYHtyLCAgZXZhbD1UfQ0KcGxvdChQZXRhbC5MZW5ndGggfiBQZXRhbC5XaWR0aCwgZGF0YSA9IGlyaXMpICMgcGFpcndpc2UNCmBgYA0KDQojIyMgQ3VzdG9taXphdGlvbg0KDQpUaGUgbGF0ZXN0IHRha2VzIHR3byBhcmd1bWVudHM6IFBldGFsLkxlbmd0aCB+IFBldGFsLldpZHRoIHdoaWNoIGlzIHRvIGJlIHJlYWQgYXMgcGxvdHRpbmcgdGhlIHZhcmlhYmxlIGBQZXRhbC5MZW5ndGhgIGFzIGEgZnVuY3Rpb24gb2YgYFBldGFsLldpZHRoYC4gKipBcmd1bWVudCoqIGBkYXRhYCBpbmRpY2F0ZXMgdGhlIHBsb3QgZnVuY3Rpb24gZnJvbSB3aGljaCBkYXRhIGZyYW1lIHRvIGV4dHJhY3QgdGhlIHZhcmlhYmxlcyAgQW5vdGhlciB3YXkgdG8gY2FsbCB0aGlzIGNvbW1hbmQgaXMgdG8gdHlwZToNCg0KYGBge3IsICBldmFsPUZ9DQpwbG90KGlyaXMkUGV0YWwuTGVuZ3RoIH4gaXJpcyRQZXRhbC5XaWR0aCkgIyB1c2luZyB0aGUgJCBvcGVyYXRvcg0KYGBgDQoNClRoZSBgcGxvdGAgZnVuY3Rpb24gY2FuIHRha2Ugb24gbWFueSBvdGhlciBhcmd1bWVudHMgdG8gaGVscCBjdXN0b21pemUgdGhlIGRlZmF1bHQgcGxvdCBvcHRpb25zLiBGb3IgZXhhbXBsZSwgd2UgbWF5IHdhbnQgdG8gY2hhbmdlIHRoZSBheGlzIGxhYmVscyB0byBzb21ldGhpbmcgbW9yZSBkZXNjcmlwdGl2ZSB0aGFuIHRoZSBzaW1wbGUgdmFyaWFibGUgbmFtZToNCg0KYGBge3IsICBldmFsPVR9DQojIGFkZCBsYWJlbHMgdG8geC0gYW5kIHktYXhlcywgdGl0bGUgDQpwbG90KFBldGFsLkxlbmd0aCB+IFBldGFsLldpZHRoLCBkYXRhID0gaXJpcywNCiAgICAgeGxhYiA9ICdQZXRhbCB3aWR0aCAoY20pJywgDQogICAgIHlsYWIgPSAnUGV0YWwgbGVuZ3RoIChjbSknLA0KICAgICBtYWluID0gJ1BldGFsIHdpZHRoICYgbGVuZ3RoIG9mIGlyaXMgZmxvd2VyJykgDQpgYGANCg0KV2UgY2FuIGNoYW5nZSB0aGUgc3ltYm9sZSB0eXBlIHVzaW5nIGFyZ3VtZW50IGBwY2hgICgqKnAqKmxvdHRpbmcgKipjaCoqYXJhY3RlcuKAmSwgc2VlIGA/cGNoYCBmb3Igb3B0aW9ucykuIGBwY2ggPSAxOWAgd2lsbCBwcm9kdWNlIGEgc29saWQgY2lyY2xlLiBUaGUgYXJndW1lbnQgYGNleGAgd2lsbCBjb250cm9sIGhpcyBzaXplIChjaGFyYWN0ZXIgKipleHAqKmFuc2lvbikuIFdlIGNhbiBhbHNvIHNldCBpdHMgKipjb2wqKm9ycyB0byBiZSA5MCUgdHJhbnNwYXJlbnQgKDEwJSBvcGFxdWUpIHVzaW5nIGV4cHJlc3Npb24gYGNvbCA9IHJnYiAoMCwwLDAsMC4xMClgLiBUaGUgYHJnYmAgZnVuY3Rpb24gZGVmaW5lcyB0aGUgaW50ZW5zaXR5IGZvciBlYWNoIG9mIHRoZSBkaXNwbGF5IHByaW1hcnkgY29sb3JzIChvbiBhIHNjYWxlIG9mIDAgdG8gMSkuIFRoZSBwcmltYXJ5IGNvbG9ycyBhcmUgKipyZWQqKiwgKipncmVlbioqIGFuZCAqKmJsdWUqKi4gVGhlIGZvcnRoIHZhbHVlIGlzIG9wdGlvbmFsIGFuZCBwcm92aWRlcyB0aGUgZnJhY3Rpb24gb3BhcXVlbmVzcyAob3IgdHJhbnNwYXJlbmN5KSB3aXRoIGEgdmFsdWUgb2YgMSBiZWluZyBjb21wbGV0ZWx5IG9wYXF1ZS4gDQoNCmBgYHtyLCAgZXZhbD1UfQ0KcGxvdChQZXRhbC5MZW5ndGggfiBQZXRhbC5XaWR0aCwgZGF0YSA9IGlyaXMsDQogICAgIHhsYWIgPSAnUGV0YWwgd2lkdGggKGNtKScsIA0KICAgICB5bGFiID0gJ1BldGFsIGxlbmd0aCAoY20pJywgDQogICAgIG1haW4gPSAnUGV0YWwgd2lkdGggYW5kIGxlbmd0aCBvZiBpcmlzIGZsb3dlcicsDQogICAgIHBjaCA9IDE5LCBjZXg9MiwgDQogICAgIGNvbCA9IHJnYiAoMSwwLDAsMC4xMCkpDQpgYGANCg0KTm93IGl0IGlzIHRpbWUgdG8gY29tYmluZSB0aGlzIHdpdGggd2hhdCB3ZSBwcmV2aW91c2x5IGxlYXJuZWQgb24gY29uZGl0aW9uYWwgc2VsZWN0aW9uLiBIb3cgdG8gYWRkIGRpZmZlcmVudCBjb2xvcnMgZm9yIHRoZSB0aHJlZSBkaWZmZXJlbnQgc3BlY2llcy4gUmVtZW1iZXIgdGhlIGBpZmVsc2VgPw0KDQpgYGB7ciwgIGV2YWw9VH0NCiMgY3JlYXRlIGEgdmVjdG9yIG9mIGNoYXJhY3RlciB3aXRoIGNvbG9yIG5hbWVzDQpjb2wuaXJpczwtaWZlbHNlKGlyaXMkU3BlY2llcz09J3NldG9zYScsJ3B1cnBsZScsaWZlbHNlKGlyaXMkU3BlY2llcz09J3ZlcnNpY29sb3InLCdibHVlJywncGluaycpKSANCmNvbC5pcmlzDQpgYGANCg0KV2UgY2FuIGluc2VydCB0aGlzIGNvbG9yIHZlY3RvciBpbiB0aGUgYXJndW1lbnQgYGNvbGAgYW5kIGNvbnRyb2xsaW5nIGl0cyBvcGFjaXR5IHdpdGggdGhlIGBhbHBoYWAgZnVuY3Rpb24gZnJvbSB0aGUgcGFja2FnZSBgc2NhbGVzYC4gWW91IGNhbiBndWVzcyB0aGUgYXJndW1lbnQgYGNvbGAgY2FuIGFjY2VwdCBhIHZlY3RvciBvZiBjaGFyYWN0ZXIgd2l0aCBqdXN0IHRoZSBuYW1lIG9mIGNvbG9yIGluc3RlYWQgb2YgYSBgcmdiYCBjb2RlLg0KDQpgYGB7ciwgIGV2YWw9VH0NCmxpYnJhcnkoc2NhbGVzKQ0KcGxvdChQZXRhbC5MZW5ndGggfiBQZXRhbC5XaWR0aCwgZGF0YSA9IGlyaXMsDQogICAgIHhsYWIgPSAnUGV0YWwgd2lkdGggKGNtKScsIA0KICAgICB5bGFiID0gJ1BldGFsIGxlbmd0aCAoY20pJywgDQogICAgIG1haW4gPSAnUGV0YWwgd2lkdGggYW5kIGxlbmd0aCBvZiBpcmlzIGZsb3dlcicsDQogICAgIHBjaCA9IDE5LCBjZXg9MiwgDQogICAgIGNvbCA9IGFscGhhKGNvbC5pcmlzLCAwLjIpKQ0KYGBgDQogDQpXZSBub3cgbXVzdCBhZGQgYSBsZWdlbmQgdG8gb3VyIHBsb3QuIE9ic2VydmUgdGhlIGNvbnZlcnNpb24gb2YgdGhlIGNvbG9yIGxpc3QgaW50byBhIGZhY3RvciwgYW5kIHRoZSBleHRyYWN0aW9uIG9mIGxldmVscyBpbiB0aGUgYGNvbGAgYXJndW1lbnQuDQoNCmBgYHtyLCAgZXZhbD1UfQ0KcGxvdChQZXRhbC5MZW5ndGggfiBQZXRhbC5XaWR0aCwgZGF0ID0gaXJpcywNCiAgICAgeGxhYiA9ICdQZXRhbCB3aWR0aCAoY20pJywgDQogICAgIHlsYWIgPSAnUGV0YWwgbGVuZ3RoIChjbSknLCANCiAgICAgbWFpbiA9ICdQZXRhbCB3aWR0aCBhbmQgbGVuZ3RoIG9mIGlyaXMgZmxvd2VyJywNCiAgICAgcGNoID0gMTksIGNleD0yLCANCiAgICAgY29sID0gYWxwaGEoY29sLmlyaXMsIDAuMikpDQoNCmxlZ2VuZCh4PSJib3R0b21yaWdodCIsIHBjaD0gMTksIGNleD0xLjUsIGxlZ2VuZD0gYygidmVyc2ljb2xvciIsInNldG9zYSIsICJ2aXJnaW5pY2EiKSwgY29sPWxldmVscyhhcy5mYWN0b3IoYWxwaGEoY29sLmlyaXMsIDAuMikpKSkNCiAgICANCmBgYA0KDQpUaGUgYXJndW1lbnQgYGxhcz0xYCB3aWxsIHJvdGF0ZSB5LWF4aXMgbGFiZWxzLiBUaGlzIGlzIG9mdGVuIGEgcmVxdWlyZW1lbnQgZm9yIHB1YmxpY2F0aW9uIHF1YWxpdHkgcGxvdHMuIA0KDQpgYGB7ciwgIGV2YWw9VH0NCnBsb3QoUGV0YWwuTGVuZ3RoIH4gUGV0YWwuV2lkdGgsIGRhdCA9IGlyaXMsDQogICAgIHhsYWIgPSAnUGV0YWwgd2lkdGggKGNtKScsIA0KICAgICB5bGFiID0gJ1BldGFsIGxlbmd0aCAoY20pJywgDQogICAgIG1haW4gPSAnUGV0YWwgd2lkdGggYW5kIGxlbmd0aCBvZiBpcmlzIGZsb3dlcicsDQogICAgIHBjaCA9IDE5LCBjZXg9MiwgbGFzPTEsDQogICAgIGNvbCA9IGFscGhhKGNvbC5pcmlzLCAwLjIpKSANCg0KbGVnZW5kKHg9ImJvdHRvbXJpZ2h0IiwgcGNoPSAxOSwgY2V4PTEuNSwgbGVnZW5kPSBjKCJ2ZXJzaWNvbG9yIiwic2V0b3NhIiwgInZpcmdpbmljYSIpLCBjb2w9bGV2ZWxzKGFzLmZhY3RvcihhbHBoYShjb2wuaXJpcywgMC4yKSkpKQ0KYGBgDQoNClRoZSBzaXplIG9mIHRoZSBtYWluIHRpdGxlLCBheGlzLCBsYWJlbHMgaXMgYWxzbyBjb250cm9sIHdpdGggYGNleGAgYXJndW1lbnRzIA0KDQpgYGB7ciwgIGV2YWw9VH0NCnBsb3QoUGV0YWwuTGVuZ3RoIH4gUGV0YWwuV2lkdGgsIGRhdCA9IGlyaXMsDQogICAgIHhsYWIgPSAnUGV0YWwgd2lkdGggKGNtKScsIA0KICAgICB5bGFiID0gJ1BldGFsIGxlbmd0aCAoY20pJywgDQogICAgIG1haW4gPSAnUGV0YWwgd2lkdGggYW5kIGxlbmd0aCBvZiBpcmlzIGZsb3dlcicsDQogICAgIGNleC5heGlzPTEuMCwgY2V4LmxhYj0xLjUsIGNleC5tYWluPTEuNSwNCiAgICAgcGNoID0gMTksIGNleD0yLCBsYXM9MSwNCiAgICAgY29sID0gYWxwaGEoY29sLmlyaXMsIDAuMikpDQoNCmxlZ2VuZCh4PSJib3R0b21yaWdodCIsIHBjaD0gMTksIGNleD0xLjUsIGxlZ2VuZD0gYygidmVyc2ljb2xvciIsInNldG9zYSIsICJ2aXJnaW5pY2EiKSwgY29sPWxldmVscyhhcy5mYWN0b3IoYWxwaGEoY29sLmlyaXMsIDAuMikpKSkNCg0KYGBgDQoNClRoZSBzaXplIG9mIHRoZSBwb2ludHMgY2FuIGJlIHNldCBhcyBhIHByb3BvcnRpb24gb2YgYSBnaXZlbiBjb250aW51b3VzIHZhcmlhYmxlDQoNCmBgYHtyLCAgZXZhbD1UfQ0KcmF0aW88LWlyaXMkUGV0YWwuTGVuZ3RoL2lyaXMkU2VwYWwuV2lkdGggICMgcmF0aW8gYmV0d2VlbiB0aGUgbGVuZ3RoIG9mIHBldGFsIGFuZCB0aGUgd2lkdGggb2YgU2VwYWwNCnBsb3QoUGV0YWwuTGVuZ3RoIH4gUGV0YWwuV2lkdGgsIGRhdCA9IGlyaXMsDQogICAgIHhsYWIgPSAnUGV0YWwgd2lkdGggKGNtKScsIA0KICAgICB5bGFiID0gJ1BldGFsIGxlbmd0aCAoY20pJywgDQogICAgIG1haW4gPSAnUGV0YWwgd2lkdGggYW5kIGxlbmd0aCBvZiBpcmlzIGZsb3dlcicsDQogICAgIGNleC5heGlzPTEuMCwgY2V4LmxhYj0xLjUsIGNleC5tYWluPTEuNSwNCiAgICAgcGNoID0gMTksIGxhcz0xLCBjZXg9IHJhdGlvICogMiwgDQogICAgIGNvbCA9IGFscGhhKGNvbC5pcmlzLCAwLjIpKQ0KDQpsZWdlbmQoeD0iYm90dG9tcmlnaHQiLCBwY2g9IDE5LCBjZXg9MS41LCBsZWdlbmQ9IGMoInZlcnNpY29sb3IiLCJzZXRvc2EiLCAidmlyZ2luaWNhIiksIGNvbD1sZXZlbHMoYXMuZmFjdG9yKGFscGhhKGNvbC5pcmlzLCAwLjIpKSkpDQpgYGANCg0KSXQgbG9va3MgbGlrZSB0aGUgdmFyaWFibGVgU2VwYWwuV2lkdGhgIGlzIHBvb3JseSBpbmZvcm1hdGl2ZSBpbiBkaXNjcmltaW5hdGluZyB0aGUgdGhyZWUgc3BlY2llcy4NCg0KDQpUaGUgZnVuY3Rpb24gYHBhaXJzYCBhbGxvd3MgYSBxdWljayBleGFtaW5hdGlvbiBvZiB0aGUgcmVsYXRpb25zaGlwIGFtb25nIHZhcmlhYmxlcyBvZiBpbnRlcmVzdDogYSBzY2F0dGVycGxvdCBtYXRyaXguIA0KDQojIyMgVHlwZXMNCg0KIyMjIyBQYW5lbCBwbG90DQoNCmBgYHtyLCAgZXZhbD1UfQ0KcGFpcnMoaXJpc1sxOjRdLCBwY2g9MTksIGNvbCA9IGFscGhhKGNvbC5pcmlzLCAwLjIpKQ0KYGBgDQoNCiMjIyMgTGluZSBwbG90DQoNCkEgY29udmVyc2lvbiB0byBhIGxpbmUgcGxvdCBpcyBlYXNpbHkgbWFkZSBieSBzcGVjaWZ5aW5nIHRoZSBgdHlwZWAgb2YgcGxvdC4NCg0KYGBge3IsICBldmFsPVR9DQojIGdlbmVyYXRlIGEgZGF0YSBmcmFtZSB3aXRoIGNocm9ub2xvZ2ljYWwgdmFyaWFibGUNCmJsb3Nzb208LU5VTEwNCmJsb3Nzb20keWVhciA8LSAyMDEwOjIwMTkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgDQpibG9zc29tJGNvdW50LmFsYXNrYSA8LSBjKDMsIDEsIDUsIDIsIDMsIDgsIDQsIDcsIDYsIDkpDQpibG9zc29tJGNvdW50LmNhbmFkYSA8LSBjKDQsIDYsIDUsIDcsIDEwLCA4LCAxMCwgMTEsIDE1LCAxNykNCmFzLmRhdGEuZnJhbWUoYmxvc3NvbSkNCnBsb3QoY291bnQuYWxhc2thIH4geWVhcixkYXQgPSBibG9zc29tLCB0eXBlPSdsJywNCiAgICAgIHlsYWIgPSAiTm8uIG9mIGZsb3dlciBibG9zc29taW5nIikgDQpgYGANCg0KVG8gcGxvdCBib3RoIHBvaW50cyBhbmQgbGluZSwgc2V0IHRoZSB0eXBlIHBhcmFtZXRlciB0byAiYiIgKGZvciBib3RoKS4gV2XigJlsbCBhbHNvIHNldCB0aGUgcG9pbnQgc3ltYm9sIHRvIDIwLg0KDQpgYGB7ciwgIGV2YWw9VH0NCnBsb3QoY291bnQuYWxhc2thIH4geWVhcixkYXQgPSBibG9zc29tLCB0eXBlPSdiJywgcGNoPTIwLA0KICAgICAgeWxhYiA9ICJOby4gb2YgZmxvd2VyIGJsb3Nzb21pbmciKSANCmBgYA0KDQpXZSBjYW4gcm90YXRlIHRoZSBheGlzLCBpbmNyZWFzZSB0aGUgd2lkdGggb2YgdGhlIGxpbmUsIGNoYW5nZSBpdHMgdHlwZSBhbmQgY29sb3I6ICANCg0KYGBge3IsICBldmFsPVR9DQpwbG90KGNvdW50LmFsYXNrYSB+IHllYXIsZGF0ID0gYmxvc3NvbSwgdHlwZT0nYicsIHBjaD0yMCwNCiAgICAgbHR5PTIsIGx3ZD0wLjUsIGNvbD0ncmVkJywNCiAgICAgeWxhYiA9ICJOby4gb2YgZmxvd2VyIGJsb3Nzb21pbmciKSANCmBgYA0KDQoNCldlIGNhbiBhZGQgdGhlIG90aGVyIHZhcmlhYmxlIGJ5IGFkZGluZyBhIGxpbmUgb2YgYW5vdGhlciB0eXBlIGFuZCBjb2xvcjogDQoNCmBgYHtyLCAgZXZhbD1UfQ0KcGxvdChjb3VudC5hbGFza2EgfiB5ZWFyLGRhdCA9IGJsb3Nzb20sIHR5cGU9J2InLCBwY2g9MjAsDQogICAgIGx0eT0yLCBsd2Q9MC41LCBjb2w9J3JlZCcsDQogICAgIHlsYWIgPSAiTm8uIG9mIGZsb3dlciBibG9zc29taW5nIikgDQpsaW5lcyhjb3VudC5jYW5hZGEgfiB5ZWFyLGRhdCA9IGJsb3Nzb20sIHR5cGU9J2InLCBwY2g9MjAsDQogICAgIGx0eT0zLCBsd2Q9MC41LCBjb2w9J2JsdWUnKQ0KYGBgDQoNClRoZSBwbG90IGlzIGEgc3RhdGljIG9iamVjdCBtZWFuaW5nIHRoYXQgd2UgbmVlZCB0byBkZWZpbmUgdGhlIGF4ZXMgbGltaXRzIGJlZm9yZSBjYWxsaW5nIHRoZSBvcmlnaW5hbCBwbG90IGZ1bmN0aW9uLiBCb3RoIGF4ZXMgbGltaXRzIGNhbiBiZSBzZXQgdXNpbmcgdGhlIGB4bGltYCBhbmQgYHlsaW1gIHBhcmFtZXRlcnMuIFdlIGRvbuKAmXQgbmVlZCB0byBzZXQgdGhlIHgtYXhpcyByYW5nZSBzaW5jZSBib3RoIHZhcmlhYmxlcyBjb3ZlciB0aGUgc2FtZSB5ZWFyIHJhbmdlLiBXZSB3aWxsIHRoZXJlZm9yZSBvbmx5IGZvY3VzIG9uIHRoZSB5LWF4aXMgbGltaXRzLiBXZSBjYW4gZ3JhYiBib3RoIHRoZSBtaW5pbXVtIGFuZCBtYXhpbXVtIHZhbHVlcyBmb3IgdGhlIHZhcmlhYmxlcyBgY291bnQuYWxhc2thYCBhbmQgYGNvdW50LmNhbmFkYWAgdXNpbmcgdGhlIGByYW5nZWAgZnVuY3Rpb24sIHRoZW4gcGFzcyB0aGUgcmFuZ2UgdG8gdGhlIGB5bGltYCBwYXJhbWV0ZXIgaW4gdGhlIGNhbGwgdG8gcGxvdC4NCg0KYGBge3IsICBldmFsPVR9DQp5LnJuZzwtcmFuZ2UoYyhibG9zc29tJGNvdW50LmFsYXNrYSwgYmxvc3NvbSRjb3VudC5jYW5hZGEpKQ0KDQpwbG90KGNvdW50LmFsYXNrYSB+IHllYXIsZGF0ID0gYmxvc3NvbSwgdHlwZT0nbCcsIHlsaW0gPSB5LnJuZywNCiAgICAgbHR5PTIsIGx3ZD0xLCBjb2w9J3JlZCcsDQogICAgIHlsYWIgPSAiTm8uIG9mIGZsb3dlciBibG9zc29taW5nIikgDQpsaW5lcyhjb3VudC5jYW5hZGEgfiB5ZWFyLGRhdCA9IGJsb3Nzb20sDQogICAgIGx0eT0xLCBsd2Q9MSwgY29sPSdibHVlJykNCmBgYA0KDQoNCk5vdGU6IHBvaW50IHBsb3RzIGZyb20gZGlmZmVyZW50IHZhcmlhYmxlcyBjYW4gYWxzbyBiZSBjb21iaW5lZCBpbnRvIGEgc2luZ2xlIHBsb3QgdXNpbmcgdGhlIGBwb2ludHNgIGZ1bmN0aW9uIGluc3RlYWQgb2YgdGhlIGBsaW5lc2AgZnVuY3Rpb24uIExldCdzIGdldCBiYWNrIHRvIG91ciBpcmlzIGRhdGFzZXQgYW5kIGJ1aWxkIG91ciBwbG90IHNlcXVlbnRpYWxseSBmb3IgdHdvIHNwZWNpZXMuDQoNCg0KYGBge3IsICBldmFsPVR9DQppcmlzLnZlcjwtIHN1YnNldChpcmlzLCBTcGVjaWVzID09ICJ2ZXJzaWNvbG9yIikNCmlyaXMudmlyPC0gc3Vic2V0KGlyaXMsIFNwZWNpZXMgPT0gInZpcmdpbmljYSIpDQoNCnkucm5nIDwtIHJhbmdlKCBjKGlyaXMudmVyJFBldGFsLkxlbmd0aCwgaXJpcy52aXIkUGV0YWwuTGVuZ3RoKSAsIG5hLnJtID0gVFJVRSkgDQp4LnJuZyA8LSByYW5nZSggYyhpcmlzLnZlciRQZXRhbC5XaWR0aCwgaXJpcy52aXIkUGV0YWwud2lkdGgpICwgbmEucm0gPSBUUlVFKSANCg0KIyBQbG90IGFuIGVtcHR5IHBsb3QNCg0KcGxvdChQZXRhbC5MZW5ndGggfiBQZXRhbC5XaWR0aCwgZGF0ID0gaXJpcy52ZXIsDQogICAgIHhsYWIgPSAnUGV0YWwgd2lkdGggKGNtKScsIA0KICAgICB5bGFiID0gJ1BldGFsIGxlbmd0aCAoY20pJywgDQogICAgIG1haW4gPSAnUGV0YWwgd2lkdGggYW5kIGxlbmd0aCBvZiBpcmlzIGZsb3dlcicsDQogICAgIGNleC5heGlzPTEuMCwgY2V4LmxhYj0xLjUsIGNleC5tYWluPTEuNSwgdHlwZT0nbicsDQogICAgIHhsaW09eC5ybmcsICB5bGltPXkucm5nKQ0KDQojIEFkZCBwb2ludHMgZm9yIHZlcnNpY29sb3INCnBvaW50cyhQZXRhbC5MZW5ndGggfiBQZXRhbC5XaWR0aCwgZGF0ID0gaXJpcy52ZXIsIHBjaCA9IDIwLGNleD0yLCANCiAgICAgICBjb2wgPSByZ2IoMCwwLDEsMC4xMCkpDQogICAgICAgDQojIEFkZCBwb2ludHMgZm9yIHZlcnNpY29sb3INCnBvaW50cyhQZXRhbC5MZW5ndGggfiBQZXRhbC5XaWR0aCwgZGF0ID0gaXJpcy52aXIsIHBjaCA9IDIwLGNleD0yLCANCiAgICAgIGNvbCA9ICBhbHBoYSgnI2ZjMDNjNicsIDAuMikpDQoNCiMgQWRkIGxlZ2VuZA0KbGVnZW5kKCJ0b3BsZWZ0IiwgYygidmVyc2ljb2xvciIsICJ2aXJnaW5pY2EiKSwgcGNoID0gMTksIGNleD0xLjIsDQogICAgICAgY29sID0gYyhyZ2IoMCwwLDEsMC4xMCksIGFscGhhKCcjZmMwM2M2JywgMC4yKSkpDQpgYGANCg0KTm90ZSAxOiB0aGF0IGBuYS5ybT1UYCBpcyBhZGRlZCBpbiB0aGUgYHJhbmdlYCBmdW5jdGlvbiB0byBwcmV2ZW50IGBOQWAgdmFsdWUgaW4gdGhlIGRhdGEgZnJvbSByZXR1cm5pbmcgYW4gYE5BYCB2YWx1ZSBpbiB0aGUgcmFuZ2UuDQoNCk5vdGUgMjogWW91IGNhbiBkZWZpbmUgdGhlIGNvbG9yIHVzaW5nIHRoZSBgcmdiYCBmdW5jdGlvbiwgb3IgYnkgY29sb3IgbmFtZSBzdWNoIGFzIGBjb2wgPSAicmVkImAgb3IgYGNvbCA9ICJiaXNxdWUiYC4gRm9yIGEgZnVsbCBsaXN0IG9mIGNvbG9yIG5hbWVzLCB0eXBlIGNvbG9ycygpIGF0IGEgY29tbWFuZCBwcm9tcHQuIFlvdSBjYW4gYWxzbyB0aGUgaGV4YWRlY2ltYWwgY29kZSBvZiB0aGUgY29sb3IuIEdvb2dsZSAiY29sb3IgcGlja2VyIi4gQ29sb3IgZ3JhZGllbnQgY2FuIGVhc2lseSBiZSBjcmVhdGVkIGFuZCBwZXJzb25hbGl6ZWQgW2hlcmVdKGh0dHBzOi8vd3d3LndlYmZ4LmNvbS93ZWItZGVzaWduL2NvbG9yLXBpY2tlci8pIGFuZCBpbiBtYW55IG90aGVyIHdlYnNpdGVzLg0KDQoNCiMjIyMgQm94IHBsb3QNCg0KQSBib3hwbG90IGlzIG9uZSBvZiBtYW55IGdyYXBoaWNhbCB0b29scyB1c2VkIHRvIHN1bW1hcml6ZSB0aGUgZGlzdHJpYnV0aW9uIG9mIGEgZGF0YSBiYXRjaDogYmVoaW5kIHRoZSBzaW1wbGUgdmlzdWFsaXphdGlvbiwgaXQgaW5mb3JtIG9uIHRoZSBkYXRhIHRoZW1zZWx2ZXMuIFRoZSBncmFwaGljIGNvbnNpc3RzIG9mIGEg4oCcYm944oCdIHRoYXQgZGVwaWN0cyB0aGUgcmFuZ2UgY292ZXJlZCBieSA1MCUgb2YgdGhlIGRhdGEgKCpha2EqIHRoZSBpbnRlcnF1YXJ0aWxlIHJhbmdlLCBJUVIpLCBhIGhvcml6b250YWwgbGluZSB0aGF0IGRpc3BsYXlzIHRoZSBtZWRpYW4sIGFuZCDigJx3aGlza2Vyc+KAnSB0aGF0IGRlcGljdCAxLjUgdGltZXMgdGhlIElRUiBvciB0aGUgbGFyZ2VzdCAoZm9yIHRoZSB0b3AgaGFsZikgb3Igc21hbGxlc3QgKGZvciB0aGUgYm90dG9tIGhhbGYpIHZhbHVlcy4NCg0KRm9yIGV4YW1wbGUsIHdlIGNhbiBzdW1tYXJpemUgdGhlIHdpZHRoIG9mIHRoZSBzZXBhbCBmb3IgYWxsIGluZGl2aWR1YWxzIGluIG91ciBpcmlzIGRhdGFzZXQ6DQoNCmBgYHtyLCAgZXZhbD1UfQ0KYm94cGxvdChpcmlzJFNlcGFsLldpZHRoLCBuYS5ybSA9IFRSVUUpDQpgYGANCg0KU2V2ZXJhbCB2YXJpYWJsZXMgY2FuIGJlIHN1bW1hcml6ZWQgb24gdGhlIHNhbWUgcGxvdC4NCg0KYGBge3IsICBldmFsPVR9DQpib3hwbG90KGlyaXMkU2VwYWwuV2lkdGgsaXJpcyRTZXBhbC5MZW5ndGgsIGlyaXMkUGV0YWwuV2lkdGgsaXJpcyRQZXRhbC5MZW5ndGgsIG5hbWVzID0gYygiU2VwYWwuV2lkdGgiLCAiU2VwYWwuTGVuZ3RoIiwgIlBldGFsLkxlbmd0aCIsIlBldGFsLldpZHRoIiksIG1haW4gPSAiSXJpcyBmbG93ZXIgdHJhaXRzIikNCmBgYA0KDQpUaGUgYG5hbWVzYCBhcmd1bWVudCBsYWJlbHMgdGhlIHgtYXhpcyBhbmQgdGhlIGBtYWluYCBhcmd1bWVudCBsYWJlbHMgdGhlIHBsb3QgdGl0bGUuIFRoZSBvdXRsaWVycyBjYW4gYmUgcmVtb3ZlZCBmcm9tIHRoZSBwbG90LCBpZiBkZXNpcmVkLCBieSBzZXR0aW5nIHRoZSBgb3V0bGluZWAgcGFyYW1ldGVyIHRvIEZBTFNFLiBUaGUgYm94cGxvdCBncmFwaCBjYW4gYWxzbyBiZSBwbG90dGVkIGhvcml6b250YWxseSBieSBzZXR0aW5nIHRoZSBgaG9yaXpvbnRhbGAgcGFyYW1ldGVyIHRvIGBUUlVFYDoNCg0KYGBge3IsICBldmFsPVR9DQpib3hwbG90KGlyaXMkU2VwYWwuV2lkdGgsaXJpcyRTZXBhbC5MZW5ndGgsIGlyaXMkUGV0YWwuV2lkdGgsaXJpcyRQZXRhbC5MZW5ndGgsIG5hbWVzID0gYygiU2VwYWwuV2lkdGgiLCAiU2VwYWwuTGVuZ3RoIiwgIlBldGFsLkxlbmd0aCIsIlBldGFsLldpZHRoIiksIG1haW4gPSAiSXJpcyBmbG93ZXIgdHJhaXRzIixvdXRsaW5lID0gRkFMU0UsIGhvcml6b250YWwgPSBUUlVFICkNCmBgYA0KDQpVc2luZyBhIGxvbmcgdmVyc2lvbiBvZiBhIHRhYmxlIChgcGl2b3RfbG9uZ2VyYCksIHRoZSB2YXJpYWJsZSBjYW4gYmUgc3VtbWFyaXplZCBieSB0aGUgbGV2ZWxzIG9mIGEgZmFjdG9yLCBoZXJlIHRoZSBgU3BlY2llc2AgbGV2ZWxzDQoNCmBgYHtyLCAgZXZhbD1UfQ0KYm94cGxvdChTZXBhbC5XaWR0aCB+IFNwZWNpZXMsaXJpcykgDQpgYGANCg0KV2UgY2FuIGByZW9yZGVyYCB0aGUgYm94cGxvdHMgYmFzZWQgb24gdGhlIG1lZGlhbiB2YWx1ZS4gQnkgZGVmYXVsdCwgYGJveHBsb3RgIHdpbGwgb3JkZXIgdGhlIGJveHBsb3RzIGZvbGxvd2luZyB0aGUgZmFjdG9y4oCZcyBsZXZlbCBvcmRlci4NCiAgICAgICAgDQpgYGB7ciwgIGV2YWw9VH0NCmlyaXMkU3BlY2llcy5vcmQgPC0gcmVvcmRlcihpcmlzJFNwZWNpZXMsaXJpcyRTZXBhbC5XaWR0aCwgbWVkaWFuKQ0KbGV2ZWxzKGlyaXMkU3BlY2llcy5vcmQpDQpib3hwbG90KFNlcGFsLldpZHRoIH4gU3BlY2llcy5vcmQsIGlyaXMpDQpgYGAgICAgICAgDQogICAgICAgIA0KIyMjIyBIaXN0b2dyYW0gcGxvdA0KDQpUaGUgaGlzdG9ncmFtIGlzIGFub3RoZXIgZm9ybSBvZiBkYXRhIGRpc3RyaWJ1dGlvbiB2aXN1YWxpemF0aW9uLiBJdCBjb25zaXN0cyBvZiBwYXJ0aXRpb25pbmcgYSBiYXRjaCBvZiB2YWx1ZXMgaW50byBpbnRlcnZhbHMgb2YgZXF1YWwgbGVuZ3RoIHRoZW4gdGFsbHlpbmcgdGhlaXIgY291bnQgaW4gZWFjaCBpbnRlcnZhbC4gVGhlIGhlaWdodCBvZiBlYWNoIGJhciByZXByZXNlbnRzIHRoZXNlIGNvdW50cy4gRm9yIGV4YW1wbGUsIHdlIGNhbiBwbG90IHRoZSBoaXN0b2dyYW0gb2YgdGhlIHdpZHRoIG9kIHNlcGFsIHVzaW5nIHRoZSBgaGlzdGAgZnVuY3Rpb24gYXMgZm9sbG93czoNCiAgICAgICAgDQpgYGB7ciwgIGV2YWw9VH0NCmhpc3QoaXJpcyRTZXBhbC5XaWR0aCwgeGxhYiA9ICJXaWR0aCBvZiBTZXBhbCIsIG1haW4gPSBOQSkNCmBgYA0KDQpUbyBjb250cm9sIHRoZSBudW1iZXIgb2YgYmlucyBhZGQgdGhlIGBicmVha3NgIGFyZ3VtZW50LiBUaGUgYGJyZWFrc2AgYXJndW1lbnQgY2FuIGJlIHBhc3NlZCBkaWZmZXJlbnQgdHlwZXMgb2YgdmFsdWVzLiBUaGUgc2ltcGxlc3QgdmFsdWUgaXMgdGhlIGRlc2lyZWQgbnVtYmVyIG9mIGJpbnMuIE5vdGUsIGhvd2V2ZXIsIHRoYXQgeW91IG1pZ2h0IG5vdCBuZWNlc3NhcmlseSBnZXQgdGhlIG51bWJlciBvZiBiaW5zIGRlZmluZWQgd2l0aCB0aGUgYGJyZWFrc2AgYXJndW1lbnQuDQoNCmBgYHtyLCAgZXZhbD1UfQ0KaGlzdChpcmlzJFNlcGFsLldpZHRoLCB4bGFiID0gIldpZHRoIG9mIFNlcGFsIiwgbWFpbiA9IE5BLCBicmVha3M9MTApDQpgYGANCg0KVGhlIGRvY3VtZW50YXRpb24gc3RhdGVzIHRoYXQgdGhlIGJyZWFrcyB2YWx1ZSDigJwqKmlzIGEgc3VnZ2VzdGlvbiBvbmx5IGFzIHRoZSBicmVha3BvaW50cyB3aWxsIGJlIHNldCB0byBgcHJldHR5YCB2YWx1ZXMqKuKAnS4gYHByZXR0eWAgcmVmZXJzIHRvIGEgZnVuY3Rpb24gdGhhdCByb3VuZHMgdmFsdWVzIHRvIHBvd2VycyBvZiAxLCAyIG9yIDUgdGltZXMgYSBwb3dlciBvZiAxMC4NCg0KSWYgeW91IHdhbnQgdG90YWwgY29udHJvbCBvZiB0aGUgYmluIG51bWJlcnMsIG1hbnVhbGx5IGNyZWF0ZSB0aGUgYnJlYWtzIGFzIGZvbGxvd3M6ICAgICANCg0KYGBge3IsICBldmFsPVR9DQpuIDwtIDEwICAjIERlZmluZSB0aGUgbnVtYmVyIG9mIGJpbg0KbWlueCA8LSBtaW4oaXJpcyRTZXBhbC5XaWR0aCwgbmEucm0gPSBUUlVFKQ0KbWF4eCA8LSBtYXgoaXJpcyRTZXBhbC5XaWR0aCwgbmEucm0gPSBUUlVFKQ0KYmlucyA8LSBzZXEobWlueCwgbWF4eCwgbGVuZ3RoLm91dCA9IG4gKzEpDQpoaXN0KGlyaXMkU2VwYWwuV2lkdGgsIHhsYWIgPSAiV2lkdGggb2YgU2VwYWwiLCBtYWluID0gTkEsIGJyZWFrcyA9IGJpbnMpDQpgYGANCg0KIyMjIyBEZW5zaXR5IHBsb3QNCg0KSGlzdG9ncmFtcyBoYXZlIHRoZWlyIHBpdGZhbGxzLiBGb3IgZXhhbXBsZSwgdGhlIG51bWJlciBvZiBiaW5zIGNhbiBkcmFzdGljYWxseSBhZmZlY3QgdGhlIGFwcGVhcmFuY2Ugb2YgYSBkaXN0cmlidXRpb24uIE9uZSBhbHRlcm5hdGl2ZSBpcyB0aGUgZGVuc2l0eSBwbG90IHdoaWNoLCBmb3IgYSBzZXJpZXMgb2YgeC12YWx1ZXMsIGNvbXB1dGVzIHRoZSBkZW5zaXR5IG9mIG9ic2VydmF0aW9ucyBhdCBlYWNoIHgtdmFsdWUuIFRoaXMgZ2VuZXJhdGVzIGEg4oCcc21vb3RoZWTigJ0gZGlzdHJpYnV0aW9uIG9mIHZhbHVlcy4NCg0KVW5saWtlIHRoZSBvdGhlciBwbG90dGluZyBmdW5jdGlvbnMsIGBkZW5zaXR5YCBkb2VzIG5vdCBnZW5lcmF0ZSBhIHBsb3QgYnV0IGEgbGlzdCBvYmplY3QgaW5zdGVhZC4gQnV0IHRoZSBvdXRwdXQgb2YgYGRlbnNpdHlgIGNhbiBiZSB3cmFwcGVkIHdpdGggYSBgcGxvdGAgZnVuY3Rpb24gdG8gZ2VuZXJhdGUgdGhlIHBsb3QuDQoNCg0KYGBge3IsICBldmFsPVR9ICAgDQpkZW5zIDwtIGRlbnNpdHkoaXJpcyRTZXBhbC5XaWR0aCkNCnBsb3QoZGVucywgbWFpbiA9ICJEZW5zaXR5IGRpc3RyaWJ1dGlvbiBvZiB0aGUgd2lkdGggb2Ygc2VwYWwiKQ0KYGBgDQoNCllvdSBjYW4gY29udHJvbCB0aGUgYmFuZHdpZHRoIHVzaW5nIHRoZSBgYndgIGFyZ3VtZW50LiBGb3IgZXhhbXBsZToNCg0KYGBge3IsICBldmFsPVR9ICAgDQpkZW5zIDwtIGRlbnNpdHkoaXJpcyRTZXBhbC5XaWR0aCwgYnc9MC4wNSkNCnBsb3QoZGVucywgbWFpbiA9ICJEZW5zaXR5IGRpc3RyaWJ1dGlvbiBvZiB0aGUgd2lkdGggb2Ygc2VwYWwiKQ0KYGBgDQoNClRoZSBiYW5kd2lkdGggcGFyYW1ldGVyIGFkb3B0cyB0aGUgdmFyaWFibGXigJlzIHVuaXRzLg0KDQojIyMjIFFRIHBsb3QNCg0KVGhpcyBpcyBhbiBpbXBvcnRhbnQgcGxvdCBjYWxsZWQgYnkgdGhlIGZ1bmN0aW9uIGBxcW5vcm1gIHRvIGV4YW1pbmUgdGhlIG5vcm1hbGl0eSBvZiBhIHZhcmlhYmxlLiBBIGBxcWxpbmVgIGNhbiBiZSBhZGRlZCB0byByZXByZXNlbnQgYSDigJx0aGVvcmV0aWNhbOKAnSwgYnkgZGVmYXVsdCBub3JtYWwsIHF1YW50aWxlLXF1YW50aWxlIHBsb3QuICANCg0KYGBge3IsICBldmFsPUZ9DQpxcW5vcm0oaXJpcyRTZXBhbC5XaWR0aCkNCnFxbGluZShpcmlzJFNlcGFsLldpZHRoKQ0KYGBgDQoNCg0KPHAgY2xhc3M9ImNvbW1lbnQiPg0KKipQcmFjdGljZSAxOioqIFVzaW5nIGByYWlydW9ob2AgZGF0YXNldCwgZXhhbWluZSB0aGUgcmVsYXRpb25zaGlwIGJldHdlZW4gdGhlIGxlbmd0aCBvZiB0aGUgcGxhbnQgYXQgYGRheTNgIGFuZCB0aGUgbGVuZ3RoIGF0IGBkYXk3YDogY3JlYXRlIGEgc2NhdHRlcnBsb3QuIEV4YW1pbmUgaWYgdGhlIGxlbmd0aCBhdCBgZGF5N2AgaXMgcHJldHR5IG5vcm1hbCAoaS5lLiBmb2xsb3dpbmcgYSBub3JtYWwgZGlzdHJpYnV0aW9uLCBub3QganVzdCB5b3VyIGZlZWxpbmcpOiB5b3Ugd2lsbCB1c2UgYGhpc3RgLCBhIGBkZW5zaXR5YCBwbG90IGFuZCBgcXFub3JtYC4gSG93IGRvZXMgdGhlYHRyZWF0bWVudGAgYWZmZWN0IHRoZSBsZW5ndGggYXQgZGF5NzogbWFrZSBhIGBib3hwbG90YC5NYWtlIGEgY29tcGFyaXNvbiBvZiB0aGUgbGVuZ3RoIG9mIHRoZSBwbGFudCBiZXR3ZWVuIGVhY2ggZGF5IHVzaW5nIGZ1bmN0aW9uIGBwYWlyc2AuDQo8L3A+DQoNCmBgYHtyLCBjb2RlX2ZvbGRpbmcgPSAnU2hvdyBTb2x1dGlvbicsICBldmFsPUZBTFNFfQ0KcmFpcnVvaG88LXJlYWQudGFibGUoJ0RhdGEvcmFpcnVvaG8udHh0JyxoZWFkZXI9VCwgc2VwPSJcdCIsIGRlYz0iLiIpDQpwbG90KGRheTMgfiBkYXk3LGRhdD1yYWlydW9obywNCiAgICB4bGFiID0gJ0xlbmd0aCBhdCBkYXkgMycsIA0KICAgIHlsYWIgPSAnTGVuZ3RoIGF0IGRheSA3JywgDQogICAgbWFpbiA9ICdSZWFsdGlvbnNoaXAgYmV0d2VlbiB0aGUgbGVuZ3RoIGF0IGRheSAzIGFuZCBkYXkgNycpDQpoaXN0KHJhaXJ1b2hvJGRheTcpDQpkZW5zLnJhaSA8LSBkZW5zaXR5KHJhaXJ1b2hvJGRheTcsIGJ3PTYpDQpwbG90KGRlbnMucmFpLCBtYWluID0gIkRlbnNpdHkgZGlzdHJpYnV0aW9uIG9mIHRoZSBsZW5ndGggYXQgZGF5IDciKQ0KcXFub3JtKHJhaXJ1b2hvJGRheTcpDQpxcWxpbmUocmFpcnVvaG8kZGF5NykNCmJveHBsb3QoZGF5N350cmVhdG1lbnQsIGRhdGE9cmFpcnVvaG8pIA0KcGFpcnMocmFpcnVvaG9bLDE6Nl0pDQpgYGANCg0KIyBTZXR0aW5ncw0KDQpTZWUgdGhlIGN1cnJlbnQgZ3JhcGhpY2FsIHNldHRpbmdzIHVzaW5nOg0KDQpgYGB7ciBjbGFzcy5zb3VyY2UgPSAiZm9sZC1zaG93IiwgIGV2YWw9VH0NCnBhcigpICMgZ3JhcGhpY2FsIG9wdGlvbnMNCmBgYA0KDQpUaGUgYHBhcmAgZnVuY3Rpb24gYWxsb3dzIHlvdSB0byBzZXQgdXAgZ3JhcGhpY2FsIHBhcmFtZXRlcnMgKGZvciBhbGwgY29taW5nIHBsb3RzKQ0KDQpgYGB7ciwgIGV2YWw9Rn0NCiMgYGxhc2Agd2l0aGluIHRoZSBgcGxvdGAgZnVuY3Rpb24NCnBsb3QoUGV0YWwuTGVuZ3RoIH4gUGV0YWwuV2lkdGgsIGRhdCA9IGlyaXMsbGFzPTEpDQoNCiMgYGxhc2Agc2V0IGFzIGEgZ3JhcGhpY2FsIHNldHRpbmcNCnBhcihsYXM9MSkgDQpwbG90KFBldGFsLkxlbmd0aCB+IFBldGFsLldpZHRoLCBkYXQgPSBpcmlzKQ0KYGBgDQoNClRoZSBsYXRlc3Qgd2lsbCBhcHBseSB0byBhbGwgdGhlIGZvbGxvd2luZyBwbG90cyBhbmQgdW50aWwgdGhlIGdyYXBoaWNhbCBwYXJhbWV0ZXJzICBhcmUgcmVpbml0aWFsaXplIHVzaW5nIGBkZXYub2ZmKClgDQoNCmBgYHtyLCAgZXZhbD1GfQ0KZGV2Lm9mZigpDQpgYGANCg0KKipTb21lIHVzZWZ1bCBzZXR0aW5ncyBjb250cm9sIGJ5IHRoZSBmdW5jdGlvbiBgcGFyYDoqKg0KDQotICpUZXh0IGFuZCBzeW1ib2wgc2l6ZSoNCg0KYGNleGAgcG9pbnQgYW5kIHRleHQgc2l6ZSANCg0KYGNleC5heGlzYCAgYXhpcyB0aWNrIGxhYmVsIHNpemUgDQoNCmBjZXgubGFiYCBheGlzIGxhYmVsIHNpemUNCg0KYGNleC5tYWluYCB0aXRsZSBzaXplDQoNCmBjZXguc3ViYCBzdWJ0aXRsZSBzaXplIA0KDQotICpQbG90dGluZyBzeW1ib2wgKGUuZy4sIGZvciBzY2F0dGVyIHBsb3RzKSoNCg0KYHBjaGAgcGxvdHRpbmcgc3ltYm9sIChgcGNoPTE5YCBvciBgcGNoPSIqImApIA0KDQotICpMaW5lcyAoZS5nLiwgZm9yIGxpbmUgcGxvdHMpKg0KDQpgbHR5YCBsaW5lIHR5cGUgKDE9c29saWQsMi42PWRhc2hlZCBvciBkb3R0ZWQpDQoJDQpgbHdkYCBsaW5lIHdpZHRoIA0KDQotICpNYXJnaW5zIChoYXZlIHRvIGJlIHNldHVwIGJlZm9yZSBwbG90dGluZykqDQoNCmBtYXJgIG1hcmdpbnMgKGluIG9yZGVyOiBib3R0b20sIGxlZnQsIHRvcCwgcmlnaHQpDQoNCi0gKlBhbmVscyAoaGF2ZSB0byBiZSBzZXR1cCBiZWZvcmUgcGxvdHRpbmcpKg0KDQpgbWZyb3dgIG5vLiBvZiByb3dzIGFuZCBjb2x1bW4sIGUuZy4gYHBhcihtZnJvdz1jKDIsMikpYA0KDQpgYGB7ciwgIGV2YWw9Rn0NCnBhcihtZnJvdz1jKDEsMikpIyBkZWZpbmUgZ3JhcGhpY2FsIHBhcmFtZXRlcjogMSByb3csIDIgY29sdW1ucw0KcGxvdCAoMSwgMSwgY2V4PTE1LCBwY2g9MTUpICMgMXN0IHBsb3QNCnBsb3QgKDEsIDEsIGNleD0xNSwgcGNoPTE5KSAjIDJuZCBwbG90DQpgYGANCg0KLSAqQXhpcyByYW5nZSoNCg0KYHhsaW1gIG1pbiwgbWF4DQoNCmB5bGltYCBtaW4sIG1heA0KDQoqKkRFTU8qKg0KDQpgYGB7ciwgIGV2YWw9VH0NCnBhcihiZz0iI0ZDRThDNSIsIG1hcj1jKDQsNCw0LDQpLCBwY2ggPSAxOSwgbGFzPTEsIGNleD0xLjIsIGNleC5tYWluPTEuMiwgY2V4LmF4aXM9MSxjZXgubGFiPTEpDQoNCnBsb3QoUGV0YWwuTGVuZ3RoIH4gUGV0YWwuV2lkdGgsIGRhdCA9IGlyaXMsDQogICAgIHhsYWIgPSAnUGV0YWwgd2lkdGggKGNtKScsIA0KICAgICB5bGFiID0gJ1BldGFsIGxlbmd0aCAoY20pJywgDQogICAgIG1haW4gPSAnUGV0YWwgd2lkdGggYW5kIGxlbmd0aCBvZiBpcmlzIGZsb3dlcicsDQogICAgIGNvbCA9IGFscGhhKGNvbC5pcmlzLCAwLjIpKSAjIHNldCB1cCBzeW1ib2wgdHlwZXMgYW5kIHRoZWlyIGNvbG9yIA0KDQpsZWdlbmQoeD0iYm90dG9tcmlnaHQiLCBwY2g9IDE5LCBjZXg9MC44LCBsZWdlbmQ9IGMoInZlcnNpY29sb3IiLCJzZXRvc2EiLCAidmlyZ2luaWNhIiksIGNvbD1sZXZlbHMoYXMuZmFjdG9yKGFscGhhKGNvbC5pcmlzLCAwLjIpKSkpDQpgYGAgDQoNCg0KRXh0cmEgZWxlbWVudHMgdG8gYWRkIGluIGEgcGxvdCBjYW4gYmUgZW50ZXJlZCBzZXBlcmF0ZWx5Og0KDQoNCi0gVGl0bGUgYW5kIGxhYmVscyBgdGl0bGVgICANCg0KYGBge3IsICBldmFsPUZ9DQp0aXRsZSAobWFpbj0ndGl0bGUnLCB5bGFiPSd5LWF4aXMgdGl0bGUiLCB4bGFiJ3gtYXhpcyB0aXRsZScpDQpgYGANCg0KDQotIFRleHQgYW5ub3RhdGlvbiBgdGV4dGAgb3IgaW4gdGhlIG1hcmdpbiB1c2luZyBgbXRleHRgDQoNCmBgYHtyLCAgZXZhbD1GfQ0KdGV4dCAoeD0xLCB5PTEsJ3RleHQnKQ0KbXRleHQgKCd0ZXh0Jywgc2lkZT0xLCBsaW5lPTEpDQpgYGANCg0KDQotIEhvcml6b250YWwgb3IgdmVydGljYWwgbGluZSBgYWJsaW5lYA0KDQpgYGB7ciwgIGV2YWw9Rn0NCmFibGluZSAoaD0xKQ0KYWJsaW5lICh2PTEpDQpgYGANCg0KLSBBbHJlYWR5IG1lbnRpb25lZDogYGxpbmVgLCBgcG9pbnRzYCwgYGxlZ2VuZGAsIGV0Yy4NCg0KIyBFeHBvcnRpbmcNCg0KWW91IG1pZ2h0IG5lZWQgdG8gZXhwb3J0IHlvdXIgcGxvdHMgYXMgc3RhbmRhbG9uZSBpbWFnZSBmaWxlcyBmb3IgcHVibGljYXRpb25zLiBSIGNhbiBleHBvcnQgdG8gbWFueSBkaWZmZXJlbnQgKipyYXN0ZXIqKiBpbWFnZSBmaWxlIGZvcm1hdHMgc3VjaCBhcyBqcGcsIHBuZywgZ2lmIGFuZCB0aWZmLCBhbmQgc2V2ZXJhbCAqKnZlY3RvcioqIGZpbGUgZm9ybWF0cyBzdWNoIGFzIFBvc3RTY3JpcHQsIHN2ZyBhbmQgUERGLiBZb3UgY2FuIHNwZWNpZnkgdGhlIGltYWdlIHJlc29sdXRpb24gKGluIGRwaSksIHRoZSBpbWFnZSBoZWlnaHQgYW5kIHdpZHRoLCBhbmQgdGhlIHNpemUgb2YgdGhlIG1hcmdpbnMuDQoNClRoZSBmb2xsb3dpbmcgZXhhbXBsZSBzYXZlcyB0aGUgbGFzdCBwbG90IGFzIGFuIHVuY29tcHJlc3NlZCB0aWZmIGZpbGUgd2l0aCBhIDXigJx4NuKAnSBkaW1lbnNpb24gYW5kIGEgcmVzb2x1dGlvbiBvZiAzMDAgZHBpLiBUaGlzIGlzIGFjY29tcGxpc2hlZCBieSBzaW1wbHkgYm9vay1lbmRpbmcgdGhlIHBsb3R0aW5nIHJvdXRpbmVzIGJldHdlZW4gdGhlIGB0aWZmYCBhbmQgYGRldi5vZmZgZnVuY3Rpb25zOg0KDQpgYGB7ciwgIGV2YWw9VH0NCnRpZmYoZmlsZW5hbWUgPSAiRmlndXJlcy9pcmlzX3Bsb3QudGlmIiwgd2lkdGggPSA1LCBoZWlnaHQgPSA2LCB1bml0cyA9ICJpbiIsIGNvbXByZXNzaW9uID0gIm5vbmUiLCByZXMgPSAzMDApDQoNCnBhcihiZz0iI0ZDRThDNSIsIG1hcj1jKDQsNCw0LDQpLCBwY2ggPSAxOSwgbGFzPTEsIGNleD0xLjIsIGNleC5tYWluPTEuMiwgY2V4LmF4aXM9MSxjZXgubGFiPTEpDQoNCnBsb3QoUGV0YWwuTGVuZ3RoIH4gUGV0YWwuV2lkdGgsIGRhdCA9IGlyaXMsDQogICAgIHhsYWIgPSAnUGV0YWwgd2lkdGggKGNtKScsIA0KICAgICB5bGFiID0gJ1BldGFsIGxlbmd0aCAoY20pJywgDQogICAgIG1haW4gPSAnUGV0YWwgd2lkdGggYW5kIGxlbmd0aCBvZiBpcmlzIGZsb3dlcicsDQogICAgIGNvbCA9IGFscGhhKGNvbC5pcmlzLCAwLjIpKSAjIHNldCB1cCBzeW1ib2wgdHlwZXMgYW5kIHRoZWlyIGNvbG9yIA0KDQpsZWdlbmQoeD0iYm90dG9tcmlnaHQiLCBwY2g9IDE5LCBjZXg9MC44LCBsZWdlbmQ9IGMoInZlcnNpY29sb3IiLCJzZXRvc2EiLCAidmlyZ2luaWNhIiksIGNvbD1sZXZlbHMoYXMuZmFjdG9yKGFscGhhKGNvbC5pcmlzLCAwLjIpKSkpDQoNCmRldi5vZmYoKQ0KYGBgDQoNClRvIHNhdmUgdGhlIHNhbWUgcGxvdCB0byBhIHBkZiBmaWxlIGZvcm1hdCwgc2ltcGx5IHN1YnN0aXR1dGUgYHRpZmZgIHdpdGggYHBkZmAgYW5kIGFkanVzdCB0aGUgcmVsZXZhbnQgcGFyYW1ldGVyczoNCg0KYGBge3IsICBldmFsPVR9DQpwZGYoZmlsZT0gIkZpZ3VyZXMvaXJpc19wbG90LnBkZiIsIHdpZHRoID0gNSwgaGVpZ2h0ID0gNikNCg0KcGFyKGJnPSIjRkNFOEM1IiwgbWFyPWMoNCw0LDQsNCksIHBjaCA9IDE5LCBsYXM9MSwgY2V4PTEuMiwgY2V4Lm1haW49MS4yLCBjZXguYXhpcz0xLGNleC5sYWI9MSkNCg0KcGxvdChQZXRhbC5MZW5ndGggfiBQZXRhbC5XaWR0aCwgZGF0ID0gaXJpcywNCiAgICAgeGxhYiA9ICdQZXRhbCB3aWR0aCAoY20pJywgDQogICAgIHlsYWIgPSAnUGV0YWwgbGVuZ3RoIChjbSknLCANCiAgICAgbWFpbiA9ICdQZXRhbCB3aWR0aCBhbmQgbGVuZ3RoIG9mIGlyaXMgZmxvd2VyJywNCiAgICAgY29sID0gYWxwaGEoY29sLmlyaXMsIDAuMikpICMgc2V0IHVwIHN5bWJvbCB0eXBlcyBhbmQgdGhlaXIgY29sb3IgDQoNCmxlZ2VuZCh4PSJib3R0b21yaWdodCIsIHBjaD0gMTksIGNleD0wLjgsIGxlZ2VuZD0gYygidmVyc2ljb2xvciIsInNldG9zYSIsICJ2aXJnaW5pY2EiKSwgY29sPWxldmVscyhhcy5mYWN0b3IoYWxwaGEoY29sLmlyaXMsIDAuMikpKSkNCg0KZGV2Lm9mZigpDQpgYGANCg0KDQoNCg0KDQo8cCBjbGFzcz0iY29tbWVudCI+DQoqKlByYWN0aWNlIDI6KiogRXhwb3J0IHlvdXIgcHJldmlvdXMgYHJhaXJ1b2hvYCBzY2F0dGVycGxvdC4gTWFrZSBpdCBtb3JlIGluZm9ybWF0aXZlIGJ5IGFkZGluZyBhcyBtYW55IGVsZW1lbnRzIHlvdSB0aGluayBpdCBuZWVkcyBhbmQgYnkgY3VzdG9taXppbmcgZ3JhcGhpY2FsIG9wdGlvbnMuIE1ha2UgdGhlIHktYXhpcyBzdGFydGluZyBhdCAqKmV4YWN0bHkqKiAwIGFuZCBlbmRpbmcgYXQgMTMwLiBTYXZlIHlvdXIgcGxvdCBhcyBhIGBwZGZgLCByZWFkeSBmb3IgcHVibGljYXRpb24hDQo8L3A+DQoNCmBgYHtyLCBjb2RlX2ZvbGRpbmcgPSAnU2hvdyBNZSBUaGUgU29sdXRpb24nLCAgZXZhbD1GQUxTRX0NCiNBcyB0aXRsZSwgY2FsbCBtZSBhbmQgc2hvdyBtZSB5b3VyIHBkZg0KYGBgDQoNCiMgUGFja2FnZSBgbGF0dGljZWAgDQoNClRoZSBgbGF0dGljZWAgcGFja2FnZSBpcyBhbiBpbXBsZW1lbnRhdGlvbiBvZiB0aGUgKipUcmVsbGlzKiogZGlzcGxheSAob3IgbXVsdGktcGFuZWwgZGlzcGxheSkgdXNlZCB0byB2aXN1YWxpemUgbXVsdGl2YXJpYXRlIGRhdGEgb3IsIG1vcmUgc3BlY2lmaWNhbGx5LCB0byB2aXN1YWxpemUgdGhlIGRlcGVuZGVuY2llcyBhbmQgaW50ZXJhY3Rpb25zIGJldHdlZW4gbXVsdGlwbGUgdmFyaWFibGVzLiANCg0KYGBge3IsICBldmFsPVR9DQpsaWJyYXJ5KGxhdHRpY2UpDQpgYGANCg0KIyMgVW5pdmFyaWF0ZSBkYXRhIHNldA0KDQpMZXTigJlzIGxvb2sgYXQgYSBzaW1wbGUgZXhhbXBsZSB3aGVyZSB0aGUgZGVuc2l0eSBkaXN0cmlidXRpb24gb2YgYFBldGFsLkxlbmd0aGAgaXMgY29uZGl0aW9uZWQgYnkgU3BlY2llcy4NCg0KYGBge3IsICBldmFsPVR9DQpsaWJyYXJ5KGxhdHRpY2UpDQpkZW5zaXR5cGxvdCh+IFBldGFsLkxlbmd0aCB8IFNwZWNpZXMsIGlyaXMsIHBsb3QucG9pbnRzID0gIiIsIGxheW91dD1jKDEsMykpDQpgYGANCg0KVGhlIGBsYXlvdXQ9YygxLDMpYCBwYXJhbWV0ZXIgaW5zdHJ1Y3RzIHRoZSBsYXR0aWNlIGZ1bmN0aW9uIHRvIGxheW91dCB0aGUgcGFuZWxzIGFsb25nIDEgY29sdW1uIGFuZCAzIHJvdy4gSWYgeW91IHdhbnRlZCB0aGUgcGxvdHMgdG8gYmUgZGlzcGxheWVkIGluIDEgcm93cyBhbmQgMyBjb2x1bW4geW91IHdvdWxkIHNpbXBseSB0eXBlIGBsYXlvdXQ9YygzLDEpYCB3aGljaCBpcyB0aGUgZGVmYXVsdCBvcHRpb24uDQoNClRoZSBmaXJzdCB0aGluZyB0byBub3RlIGlzIHRoYXQgdGhlIHgtc2NhbGUgYXhpcyByYW5nZSBpcyB0aGUgc2FtZSBmb3IgYWxsIGZpdmUgcGxvdHMuIEF0IGZpcnN0LCB0aGlzIG1heSBzZWVtIGFzIGFuIGluZWZmaWNpZW50IHVzZSBvZiB0aGUgcmFuZ2Ugb2YgeCB2YWx1ZXPigJNmb3IgZXhhbXBsZSwgdGhlIGBzZXRvc2FgIGRlbnNpdHkgcGxvdCBpcyBzcXVlZXplZCBpbiB0aGUgbGVmdC1oYW5kIHNpZGUgb2YgdGhlIHBsb3QsIGJ1dCBpdCBpcyBpbXBvcnRhbnQgdG8gdW5kZXJzdGFuZCB0aGUgcHVycG9zZSBvZiBhIHRyZWxsaXMgcGxvdDogdG8gZmFjaWxpdGF0ZSBjb21wYXJpc29uIG9mIHBsb3RzLiBCeSBlbnN1cmluZyB0aGF0IGFsbCBzY2FsZSByYW5nZXMgcmVtYWluIHRoZSBzYW1lLCB3ZSBjYW4gZWFzaWx5IGNvbXBhcmUgdGhlIHBsb3Qgc2hhcGUuIEluIHRoZSBhYm92ZSBwbG90LCBpdCBpcyBjbGVhciB0aGF0IHRoZSBgcGV0YWwubGVuZ3RoYCBkaWZmZXJzIGFtb25nIGBTcGVjaWVzYC4NCg0KVGhlIGBsYXR0aWNlYCBwYWNrYWdlcyBhbHNvIGhhcyBhIGBoaXN0b2dyYW1gIGZ1bmN0aW9uDQoNCmBgYHtyLCAgZXZhbD1UfQ0KaGlzdG9ncmFtKH4gUGV0YWwuTGVuZ3RoIHwgU3BlY2llcywgaXJpcywgcGxvdC5wb2ludHMgPSAiIiwgbmludCA9IDIwLCBsYXlvdXQ9YygxLDMpKQ0KYGBgDQoNCk5vdGUgdGhlIGltcG9ydGFuY2Ugb2YgaGF2aW5nIGEgdGFibGUgc2hhcGVkIGluICoqbG9uZyBmb3JtYXQqKi4gVGhlIGRlbnNpdHkgcGxvdHMgYXJlIGNvbmRpdGlvbmVkIG9uICoqc3BlY2llcyoqIHdoaWNoIHJlcXVpcmVzIHRoYXQgIHNwZWNpZXMgYmUgdHJlYXRlZCBhcyBkaWZmZXJlbnQgdmFsdWVzIG9mIGEgc2FtZSB2YXJpYWJsZSAoaS5lLiBjb2x1bW4gYFNwZWNpZXNgIGluIGBpcmlzYCkuIFRoZSBhYm92ZSBwbG90IGNvdWxkIG5vdCBiZSBnZW5lcmF0ZWQgaWYgdGhlIHZhcmlvdXMgKipzcGVjaWVzKiogIHdlcmUgdHJlYXRlZCBhcyBzZXBhcmF0ZSB2YXJpYWJsZXMgKGkuZS4gY29sdW1ucykuDQoNCllvdSBjYW4gYWxzbyBjb21wYXJlIHRoZSBkaXN0cmlidXRpb25zIHRvIGEgbm9ybWFsIGRpc3RyaWJ1dGlvbiB1c2luZyBgcXFtYXRoYCAoaS5lLiBhIFEtUSBwbG90KToNCg0KYGBge3IsICBldmFsPVR9DQpxcW1hdGgofiBQZXRhbC5MZW5ndGggfCBTcGVjaWVzLCBpcmlzLCBwbG90LnBvaW50cyA9ICIiLCBuaW50ID0gMjAsIGxheW91dD1jKDMsMSkpDQpgYGANCg0KKipCb3hwbG90cyoqIGFyZSBhbm90aGVyIHBvcHVsYXIgd2F5IHRvIHZpZXcgdGhlIGRpc3RyaWJ1dGlvbiBvZiB2YWx1ZXMuIEluIHRoZSBmb2xsb3dpbmcgZXhhbXBsZSwgd2UgY3JlYXRlIGJveHBsb3RzIG9mIFBldGFsIExlbmd0aCBhcyBhIGZ1bmN0aW9uIG9mIGEgZHVtbXkgdmFyaWFibGUgYHZhcmlldHlgIChgUGV0YWwuTGVuZ3RoIH4gIHZhcmlldHlgKSBjcmVhdGVkIGZybyB0aGUgcHVycG9zZSBvZiB0aGlzIGRlbW8uIFdlIGNvbmRpdGlvbiB0aGlzIGNvbXBhcmlzb24gdXNpbmcgc3BlY2llcyBpbmZvcm1hdGlvbiAoYHxTcGVjaWVzYCkgDQoNCmBgYHtyLCAgZXZhbD1UfQ0KaXJpcyR2YXJpZXR5PC1yZXAoYyhyZXAoJ3B1cmUnLDI1KSwgcmVwKCdoeWJyaWQnLDI1KSksMykgIyBkdW1teSB2YXJpYWJsZQ0KYndwbG90KFBldGFsLkxlbmd0aCB+ICB2YXJpZXR5fFNwZWNpZXMsIGlyaXMpDQpgYGANCg0KIyMgTXVsdGl2YXJpYXRlIGRhdGEgc2V0DQoNCiMjIyBTY2F0dGVyIHBsb3RzDQoNClRoZSBgbGF0dGljZWAgcGFja2FnZSBhbGxvd3MgbG9naWNhbGx5IHRvIHBsb3Qgc2V2ZXJhbCB2YXJpYWJsZXMgb24gYSBzYW1lIHBsb3QuIEZvciBleGFtcGxlLCB3ZSBjYW4gcGxvdCBgU2VwYWwuTGVuZ3RoICsgU2VwYWwuV2lkdGhgIHZzIGBQZXRhbC5MZW5ndGggKyBQZXRhbC5XaWR0aGAgZm9yIGVhY2ggYFNwZWNpZXNgIG9uIGEgc2FtZSBwbG90Og0KDQpgYGB7ciwgIGV2YWw9VH0NCnh5cGxvdChTZXBhbC5MZW5ndGggKyBTZXBhbC5XaWR0aCB+IFBldGFsLkxlbmd0aCArIFBldGFsLldpZHRoIHwgU3BlY2llcywNCiAgICAgICBkYXRhID0gaXJpcywgc2NhbGVzID0gImZyZWUiLCBsYXlvdXQgPSBjKDIsIDIpLCB0eXBlPWMoInAiLCJnIiksDQogICAgICAgYXV0by5rZXkgPSBsaXN0KHggPSAuNiwgeSA9IC43LCBjb3JuZXIgPSBjKDAsIDApKSkNCmBgYA0KDQpUaGUgYHh5cGxvdGAgZnVuY3Rpb24gaXMgcGFzc2VkIHNldmVyYWwgcGFyYW1ldGVycy4gVGhlIHBhcmFtZXRlciBgdHlwZSA9IGMoInAiLCJnIilgIGluc3RydWN0cyB0aGUgZnVuY3Rpb24gdG8gZ2VuZXJhdGUgYm90aCBwb2ludHMsIGAicCJgLCBhbmQgYSBiYWNrZ3JvdW5kIGdyaWQgYCJnImAuIFBhcmFtZXRlciBgdHlwZWAgY2FuIGFjY2VwdCBtYW55IG90aGVyIG9wdGlvbnMsIGEgZmV3IGFyZSBsaXN0ZWQgaW4gdGhlIGZvbGxvd2luZyB0YWJsZToNCg0KDQpPcHRpb258QWRkcw0KLS0tLS0tfC0tLS0tDQpgInAiYHxgUG9pbnRzYA0KYCJsImB8YExpbmVzYA0KYCJiImB8YEJvdGggcG9pbnRzIGFuZCBsaW5lc2ANCmAibyJgfGBCb3RoIHBvaW50cyBhbmQgbGluZXNgDQpgInIiYHxgUmVncmVzc2lvbiBsaW5lYA0KYCJnImB8YAlSZWZlcmVuY2UgZ3JpZGANCmAic21vb3RoImB8YExPRVNTIGZpdGANCmAic3BsaW5lImB8YEN1YmljIHNwbGluZSBmaXRgDQoNCg0KTGV0J3MgY2hlY2sgaG93IGBQZXRhbC5MZW5ndGhgIGlzIHJlbGF0ZWQgdG8gb3RoZXIgdmFyaWFibGVzIGluIGVhY2ggc3BlY2llcw0KDQpgYGB7ciwgIGV2YWw9VH0NCnh5cGxvdChTZXBhbC5MZW5ndGggKyBTZXBhbC5XaWR0aCArIFBldGFsLldpZHRoIH4gUGV0YWwuTGVuZ3RoICB8IFNwZWNpZXMsDQogICAgICAgZGF0YSA9IGlyaXMsIHNjYWxlcyA9ICJmcmVlIiwgbGF5b3V0ID0gYygyLCAyKSwgdHlwZT1jKCJwIiwiciIpLA0KICAgICAgIGF1dG8ua2V5ID0gbGlzdCh4ID0gLjYsIHkgPSAuNywgY29ybmVyID0gYygwLCAwKSkpDQpgYGANCg0KIyMjIExpbmUgcGxvdHMNCg0KQWZ0ZXIgYG9yZGVyYCBteSBkYXRhIGBpcmlzYCBieSBgUGV0YWwuTGVuZ3RoYCENCg0KYGBge3IsICBldmFsPVR9DQp4eXBsb3QoU2VwYWwuTGVuZ3RoICsgU2VwYWwuV2lkdGggKyBQZXRhbC5XaWR0aCB+IFBldGFsLkxlbmd0aCAgfCBTcGVjaWVzLA0KICAgICAgIGRhdGEgPSBpcmlzW29yZGVyKGlyaXMkUGV0YWwuTGVuZ3RoKSxdLCBzY2FsZXMgPSAiZnJlZSIsIGxheW91dCA9IGMoMiwgMiksIA0KICAgICAgIHR5cGU9YygibCIpLCBhdXRvLmtleSA9IGxpc3QoeCA9IC42LCB5ID0gLjcsIGNvcm5lciA9IGMoMCwgMCkpKQ0KYGBgDQoNClRoZSBwYXJhbWV0ZXJzIGBwY2hgIGFuZCBgY2V4YCBkZWZpbmUgdGhlIHN5bWJvbCBzaGFwZSBhbmQgc2l6ZS4gVGhlIHBhcmFtZXRlciBgY29sLnN5bWJvbGAgZGVmaW5lcyB0aGUgcG9pbnQgY29sb3IuIFRoZSBwYXJhbWV0ZXIgYGFzcGVjdD0iaXNvImAgc2V0cyB0aGUgYXNwZWN0IHJhdGlvIGluIHN1Y2ggYSB3YXkgdGhhdCBhIHVuaXQgb2YgbWVhc3VyZSBhbG9uZyB4IG1hdGNoZXMgdGhhdCBvZiB5LiBUaGUgcGFyYW1ldGVyIGBhYmxpbmU9YygwLDEpYCBnZW5lcmF0ZWQgYSA0NcKwIGxpbmUuIEV0Yy4NCg0KV2UgY2FuIHRha2UgdGhpcyBhIHN0ZXAgZnVydGhlci4gV2UgY291bGQgY29uZGl0aW9uIHRoZSBwcmV2aW91cyByZWxhdGlvbnNoaXAgYnkgc3BlY2llcyBhbmQgdmFyaWV0eS4NCg0KYGBge3IsICBldmFsPVR9DQp4eXBsb3QoU2VwYWwuTGVuZ3RoICsgU2VwYWwuV2lkdGggKyBQZXRhbC5XaWR0aCB+IFBldGFsLkxlbmd0aCAgfCB2YXJpZXR5K1NwZWNpZXMsDQogICAgICAgZGF0YSA9IGlyaXNbb3JkZXIoaXJpcyRQZXRhbC5MZW5ndGgpLF0sIHNjYWxlcyA9ICJmcmVlIiwgbGF5b3V0ID0gYygzLCAyKSwNCiAgICAgICB0eXBlPWMoImwiKSwgYXV0by5rZXkgPSBUKQ0KYGBgDQoNCiMjIEN1c3RvbWl6YXRpb24NCg0KQXMgdGhlIGBwYXJgIGZ1bmN0aW9uIG1lbnRpb25lZCBlYXJsaWVyLCBWYXJpb3VzIGVsZW1lbnRzIG9mIGEgdHJlbGxpcyBwbG90IGNhbiBiZSBjdXN0b21pemVkIGJ5IHBhc3NpbmcgdGhlIGdyYXBoaWMgcGFyYW1ldGVycyB0byB0aGUgYHRyZWxsaXMucGFyLnNldGAgZnVuY3Rpb24uIFRvIGdldCB0aGUgbGlzdCBvZiBncmFwaGljIHBhcmFtZXRlcnMgYW5kIHRoZWlyIHZhbHVlcyBjYWxsOg0KDQpgYGB7ciwgIGV2YWw9Rn0NCnRyZWxsaXMucGFyLmdldCgpDQpgYGANCg0KSXQgZ2l2ZXMgeW91IGFuIGlkZWEgYWJvdXQgaG93IG1hbnkgcGFyYW1ldGVycyBjYW4gYmUgY3VzdG9taXplZC4gVGhvc2UgZGVmYXVsdHMgY2FuIGJlIHN0b3JlIGluIGFuIG9iamVjdCB0byBmdXJ0aGVyIHJlc3RvcmUgdGhlbS4gTWFueSB0dXRvcmlhbHMgYXJlIGF2YWlsYWJsZSBvbmxpbmUgb24gdGhlIGBsYXR0aWNlYCBwYWNrYWdlIGluIG9yZGVyIHRvIGN1c3RvbWl6ZSB5b3VyIHBsb3RzIGFzIHlvdSBuZWVkLiBIb3dldmVyLCB0aGUgYGxhdHRpY2VgIHBhY2thZ2UgaXMgbm90IGFsd2F5cyBlYXN5IHRvIHVzZSwgYW5kIGluc3BpcmUgdGhlIG1haW4gYXV0aG9yIG9mIGFub3RoZXIgcGFja2FnZSBgZ2dwbG90YCB0aGF0IG5vdyBiZWNvbWVzIHRoZSAicmVmZXJlbmNlIiBpbiBtYXR0ZXIgb2YgZ3JhcGhpY3MgaW4gUi4NCg0KDQojIFBhY2thZ2UgYGdncGxvdGAgDQoNCipUdXRvcmlhbCBmcm9tIE1hbm55IEdpbW9uZCAoMjAyMCkqDQoNCiMjIEJhc2ljIGdyYW1tYXINCg0KVGhlIGBnZ3Bsb3QyYCBwYWNrYWdlIGlzIGRlc2lnbmVkIGFyb3VuZCB0aGUgaWRlYSB0aGF0IHN0YXRpc3RpY2FsIGdyYXBoaWNzIGNhbiBiZSBkZWNvbXBvc2VkIGludG8gYSBmb3JtYWwgc3lzdGVtIG9mIGdyYW1tYXRpY2FsIHJ1bGVzLiBUaGUgYGdncGxvdDJgIGxlYXJuaW5nIGN1cnZlIGlzIHN0ZWVwIGJ1dCBvbmNlIHlvdSAgbWFzdGVyZWQgeW91IHdpbGwgaGF2ZSBhIGdyZWF0IGNvbnRyb2wgb3ZlciBncmFwaGljYWwgZGVzaWduLiBGb3IgYW4gdXAtdG8tZGF0ZSBsaXN0IG9mIGBnZ3Bsb3QyYCBmdW5jdGlvbnMsIHlvdSBtYXkgd2FudCB0byByZWZlciB0byBnZ3Bsb3Qy4oCZcyBbd2Vic2l0ZV0oaHR0cHM6Ly9nZ3Bsb3QyLnRpZHl2ZXJzZS5vcmcvcmVmZXJlbmNlLykuDQoNCkEgcGxvdCBpbiBgZ2dwbG90MmAgY29uc2lzdHMgb2YgZGlmZmVyZW50ICoqcHJpbWFyeSBsYXllcmluZyBjb21wb25lbnRzKiosIHdpdGggdGhlIHRocmVlIHByaW1hcnkgY29tcG9uZW50cyBiZWluZzoNCg0KKyBUaGUgKipkYXRhc2V0KiogdGhhdCBob3VzZXMgdGhlIGRhdGEgdG8gYmUgcGxvdHRlZDsNCisgVGhlICoqYWVzdGhldGljcyoqIHdoaWNoIGRlc2NyaWJlIGhvdyBkYXRhIGFyZSB0byBiZSBtYXBwZWQgdG8gdGhlIGdlb21ldHJpYyBlbGVtZW50cyAoY29sb3IsIHNoYXBlLCBzaXplLCBldGMuLik7DQorIFRoZSAqKmdlb21ldHJpYyBlbGVtZW50cyoqIHRvIHVzZSBpbiB0aGUgcGxvdCAoaS5lLiBwb2ludHMsIGxpbmVzLCByZWN0YW5nbGVzLCBldGPigKYpLg0KDQoqKkFkZGl0aW9uYWwgKG9wdGlvbmFsKSBsYXllcmluZyBjb21wb25lbnRzKiogaW5jbHVkZToNCg0KKyAqKlN0YXRpc3RpY2FsKiogZWxlbWVudHMgc3VjaCBhcyBzbW9vdGhpbmcsIGJpbm5pbmcgb3IgdHJhbnNmb3JtaW5nIHRoZSB2YXJpYWJsZQ0KKyAqKkZhY2V0cyoqIGZvciBjb25kaXRpb25hbCBvciB0cmVsbGlzIHBsb3RzDQorICoqQ29vcmRpbmF0ZSBzeXN0ZW1zKiogZm9yIGRlZmluaW5nIHRoZSBwbG90cyBzaGFwZSAoaS5lLiBDYXJ0ZXNpYW4sIHBvbGFyLCBzcGF0aWFsIG1hcCBwcm9qZWN0aW9ucywgZXRj4oCmKQ0KDQpUbyBhY2Nlc3MgYGdncGxvdDJgIGZ1bmN0aW9ucywgeW91IHdpbGwgbmVlZCB0byBsb2FkIGl0cyBsaWJyYXJ5Og0KDQpgYGB7ciwgIGV2YWw9VH0NCmxpYnJhcnkoZ2dwbG90MikNCmBgYA0KDQpUb2RheSwgd2Ugd2lsbCB1c2UgdGhlIGZvbGxvd2luZyBkYXRhIHNldHMgKGV4YW1pbmUgb2JqZWN0cyBjcmVhdGVkKSA6IA0KDQooMSkgYGRhdDFgOiBbZ3JhaW4gaGFydmVzdCBmb3IgTm9ydGgtQW1lcmljYV0gKGh0dHA6Ly93d3cuZmFvLm9yZy9mYW9zdGF0L2VuLyNkYXRhL1FDKSArIHNldmVyYWwgbG9uZyBhbmQgd2lkZSB2ZXJzaW9ucyBvZiB0aGlzIGRhdGFzZXQuIEV4YW1pbmUgb2JqZWN0cyBjcmVhdGVkLiAgDQoNCmBgYHtyLCAgZXZhbD1ULCBtZXNzYWdlPUZ9DQpsaWJyYXJ5KHRpZHlyKQ0KbGlicmFyeShkcGx5cikNCmRhdDEgPC0gcmVhZC5jc3YoIkRhdGEvRkFPX2dyYWluc19OQS5jc3YiLCBoZWFkZXI9VFJVRSkNCmRhdDF3IDwtIGRhdDEgJT4lIGZpbHRlcihJbmZvcm1hdGlvbiA9PSAiWWllbGQgKEhnL0hhKSIsIENvdW50cnkgPT0iVW5pdGVkIFN0YXRlcyBvZiBBbWVyaWNhIiwgQ3JvcCAlaW4lIGMoIk9hdHMiLCAiTWFpemUiLCAiQmFybGV5IiwgIkJ1Y2t3aGVhdCIsIlJ5ZSIpKSAlPiUgc2VsZWN0IChZZWFyLCBDcm9wLCBWYWx1ZSkgJT4lIHNwcmVhZChrZXkgPSBDcm9wLHZhbHVlPSJWYWx1ZSIpDQpkYXQxbCA8LSBkYXQxdyAlPiUgcGl2b3RfbG9uZ2VyKDI6NiwgbmFtZXNfdG8gPSAiQ3JvcCIsIHZhbHVlc190byA9ICJZaWVsZCIpDQpkYXQxbDIgPC0gZGF0MSAlPiUgZmlsdGVyKEluZm9ybWF0aW9uID09ICJZaWVsZCAoSGcvSGEpIiwgQ3JvcCAlaW4lIGMoIk9hdHMiLCAiTWFpemUiLCAiQmFybGV5IiwgIkJ1Y2t3aGVhdCIsIlJ5ZSIpKSAlPiUgc2VsZWN0KCBZZWFyLCBDcm9wLCBDb3VudHJ5LCBZaWVsZCA9IFZhbHVlKSAgIyBOb3RlIHRoYXQgd2UgYXJlIHJlbmFtaW5nIHRoZSBWYWx1ZSBmaWVsZA0KYGBgDQoNCigyKSBgZGF0MmA6IFtpbmNvbWUvZWR1Y2F0aW9uIGNlbnN1cyBkYXRhXSAoaHR0cHM6Ly93d3cuc29jaWFsZXhwbG9yZXIuY29tL2RhdGEvQUNTMjAxNi9tZXRhZGF0YS8/ZHM9QUNTMTYmdGFibGU9QjIwMDA0KSBmb3IgdGhlIFVTIGFuZCBpdHMgbG9uZyB2ZXJzaW9uIChvbmx5IGZvciBhZHZhbmNlIHVzZSBsYXRlcikuICANCg0KYGBge3IsICBldmFsPVR9DQpsaWJyYXJ5KHN0cmluZ3IpDQpkYXQyIDwtIHJlYWQuY3N2KCJEYXRhL0luY29tZV9lZHVjYXRpb24uY3N2IiwgaGVhZGVyPVRSVUUpDQpFZHUuR2VuZCA8LSBkYXRhLmZyYW1lKCANCiAgICAgICAgICAgICAgIHZhcmlhYmxlID0gcGFzdGUoIkIyMDAwNDAiLCBzdHJfcGFkKDE6MTgsIHdpZHRoPTIgLCBwYWQ9IjAiKSxzZXA9IiIgKSwNCiAgICAgICAgICAgICAgIExldmVsID0gcmVwKGMoIkFsbCIsICJOb0hTIiwiSFMiLCJBRCIsIkJEIiwiR3JhZCIpLCB0aW1lcz0zKSwNCiAgICAgICAgICAgICAgIEdlbmRlciA9IHJlcChjKCJBbGwiLCAiTSIsIkYiKSwgZWFjaD02KSkNCiMgQ3JlYXRlIGEgcmVnaW9uL3N0YXRlIGpvaW4gdGFibGUNCnN0LnJlZyA8LSBkYXRhLmZyYW1lKFN0YXRlID0gdG9sb3dlcihzdGF0ZS5hYmIpLCBSZWdpb24gPSBzdGF0ZS5yZWdpb24pDQpzdC5yZWcgPC0gcmJpbmQoc3QucmVnICwgZGF0YS5mcmFtZShTdGF0ZT0iZGMiLCBSZWdpb249IlNvdXRoIikpDQoNCiMgU3RhcnQgdGhlIHBpcGluZyBvcGVyYXRpb25zDQpkYXQyYiA8LSBkYXQyICU+JQ0KICBnYXRoZXIoa2V5ID0gInZhcmlhYmxlIiwgdmFsdWUgPSAidmFsdWUiLCAtMTotMikgICU+JQ0KICBsZWZ0X2pvaW4oRWR1LkdlbmQsIGJ5PSJ2YXJpYWJsZSIgKSAgICAgICAgICAgICAgJT4lDQogIHNlbGVjdChTdGF0ZSwgQ291bnR5LCBMZXZlbCwgR2VuZGVyLCB2YWx1ZSkgICAgICAgJT4lDQogIG11dGF0ZShMZXZlbCA9IGZhY3RvcihMZXZlbCwgbGV2ZWxzID0gYygiQWxsIiwiTm9IUyIsIkhTIiwgIkFEIiwgIkJEIiwgIkdyYWQiKSkpICU+JQ0KICBsZWZ0X2pvaW4oc3QucmVnICwgYnk9IlN0YXRlIikNCg0KZGF0MmMgPC0gc3ByZWFkKGRhdDJiLCBrZXkgPSBHZW5kZXIsIHZhbHVlID0gdmFsdWUgKQ0KYGBgDQoNCkZyb20gYSBnZ3Bsb3QgKipncmFtbWF0aWNhbCBwZXJzcGVjdGl2ZSoqLCBhIHNjaWVudGlmaWMgZ3JhcGggaXMgdGhlIGNvbnZlcnNpb24gb2YgKmRhdGEqIHRvICoqYWVzdGhldGljKiogYXR0cmlidXRlcyBhbmQgKipnZW9tZXRyaWMqKiBvYmplY3RzLiBUaGlzIGlzIGFuIGltcG9ydGFudCBjb25jZXB0IHRvIGdyYXNwIHNpbmNlIGl0IHVuZGVybGllcyB0aGUgY29uc3RydWN0aW9uIG9mIGFsbCBncmFwaGljcyBpbiBgZ2dwbG90MmAuDQoNCkZvciBleGFtcGxlLCBpZiB3ZSB3YW50IHRvIGdlbmVyYXRlIGEgcG9pbnQgcGxvdCBvZiBjcm9wIHlpZWxkIGFzIGEgZnVuY3Rpb24gb2YgeWVhciB1c2luZyB0aGUgYGRhdDFsYCBkYXRhIGZyYW1lLCB3ZSB0eXBlOg0KDQpgYGB7ciwgIGV2YWw9VH0NCmdncGxvdChkYXQxbCAsIGFlcyh4ID0gWWVhciwgeSA9IFlpZWxkKSkgKyBnZW9tX3BvaW50KCkNCmBgYA0KDQp3aGVyZSB0aGUgZnVuY3Rpb24sIGBnZ3Bsb3RgIHdpbGwgcGFzcyB0aGUgZGF0YSBmcmFtZSBuYW1lIHdob3NlIGNvbnRlbnQgd2lsbCBiZSBtYXBwZWQ7IHRoZSBgYWVzYCBmdW5jdGlvbiBpcyBnaXZlbiBkYXRhLXRvLWdlb21ldHJ5IG1hcHBpbmcgaW5zdHJ1Y3Rpb25zIChgWWVhcmAgaXMgbWFwcGVkIHRvIHRoZSB4LWF4aXMgYW5kIGBZaWVsZGAgaXMgbWFwcGVkIHRvIHRoZSB5LWF4aXMpOyBhbmQgYGdlb21fcG9pbnRgIGlzIHRoZSBnZW9tZXRyeSB0eXBlLg0KDQohW10oaW1hZ2VzL2dncGxvdF8xLnBuZykNCg0KSWYgd2Ugd2FudGVkIHRvIGluY2x1ZGUgYSB0aGlyZCB2YXJpYWJsZSwgY3JvcCB0eXBlLCB0byB0aGUgbWFwLCB3ZSB3b3VsZCBuZWVkIHRvIG1hcCBpdHMgYWVzdGhldGljczogaGVyZSB3ZeKAmWxsIG1hcCBgQ3JvcGAgdG8gdGhlIGNvbG9yIGVsZW1lbnQgb2YgdGhlIGdlb20uDQoNCmBgYHtyLCAgZXZhbD1UfQ0KZ2dwbG90KGRhdDFsICwgYWVzKHggPSBZZWFyLCB5ID0gWWllbGQsIGNvbG9yID0gQ3JvcCkpICsgZ2VvbV9wb2ludCgpDQpgYGANCg0KVGhlIHBhcmFtZXRlciBjb2xvciBhY3RzIGFzIGEgZ3JvdXBpbmcgcGFyYW1ldGVyIHdoZXJlYnkgdGhlIGdyb3VwcyBhcmUgYXNzaWduZWQgdW5pcXVlIGNvbG9ycy4NCg0KIVtdKGltYWdlcy9nZ3Bsb3RfMi5wbmcpDQoNCklmIHdlIHdhbnQgdG8gcGxvdCBsaW5lcyBpbnN0ZWFkIG9mIHBvaW50cywgc2ltcGx5IHN1YnN0aXR1dGUgdGhlIGdlb21ldHJ5IHR5cGUgd2l0aCB0aGUgYGdlb21fbGluZWAgZ2VvbWV0cnkuDQoNCmBgYHtyLCAgZXZhbD1UfQ0KZ2dwbG90KGRhdDFsICwgYWVzKHggPSBZZWFyLCB5ID0gWWllbGQsIGNvbG9yID0gQ3JvcCkpICsgZ2VvbV9saW5lKCkNCmBgYA0KDQpOb3RlIHRoYXQgdGhlIGFlc3RoZXRpY3MgYXJlIHN0aWxsIG1hcHBlZCBpbiB0aGUgc2FtZSB3YXkgd2l0aCBgWWVhcmAgbWFwcGVkIHRvIHRoZSB4IGNvb3JkaW5hdGUsIGBZaWVsZGAgbWFwcGVkIHRvIHRoZSB5IGNvb3JkaW5hdGUgYW5kIGBDcm9wYCBtYXBwZWQgdG8gdGhlIGdlb23igJlzIGNvbG9yLg0KDQpOb3RlIHRoYXQgdGhlIHBhcmFtZXRlcnMgYHg9YCBhbmQgYHk9YCBjYW4gYmUgb21pdHRlZCBmcm9tIHRoZSBzeW50YXggcmVkdWNpbmcgdGhlIGxpbmUgb2YgY29kZSB0bzoNCg0KYGBge3IsICBldmFsPVR9DQpnZ3Bsb3QoZGF0MWwgLCBhZXMoWWVhciwgWWllbGQsIGNvbG9yID0gQ3JvcCkpICsgZ2VvbV9saW5lKCkNCmBgYA0KDQoNCiMjIEdlb21ldHJpZXMNCg0KRXhhbXBsZXMgb2YgYSBmZXcgYXZhaWxhYmxlIGdlb21ldHJpYyBlbGVtZW50cyBmb2xsb3cuDQoNCiMjIyBgZ2VvbV9saW5lYA0KDQpgZ2VvbV9saW5lYCBnZW5lcmF0ZXMgbGluZSBnZW9tZXRyaWVzLiBXZeKAmWxsIHVzZSBkYXRhIGZyb20gYGRhdDF3YCB0byBnZW5lcmF0ZSBhIHNpbXBsZSBwbG90IG9mIG9hdCB5aWVsZCBhcyBhIGZ1bmN0aW9uIG9mIHllYXIuDQoNCmBgYHtyLCAgZXZhbD1UfQ0KZ2dwbG90KGRhdDF3LCBhZXMoeCA9IFllYXIsIHkgPSBPYXRzKSkgKyBnZW9tX2xpbmUoKSANCmBgYA0KDQpQYXJhbWV0ZXJzIHN1Y2ggYXMgY29sb3IgYW5kIGxpbmV0eXBlIGNhbiBiZSBwYXNzZWQgZGlyZWN0bHkgdG8gdGhlIGBnZW9tX2xpbmVgIGZ1bmN0aW9uOg0KDQpgYGB7ciwgIGV2YWw9VH0NCmdncGxvdChkYXQxdywgYWVzKHggPSBZZWFyLCB5ID0gT2F0cykpICsgDQogIGdlb21fbGluZShsaW5ldHlwZSA9IDIsIGNvbG9yID0gImJsdWUiLCBzaXplPTAuNCkNCmBgYA0KDQpOb3RlIHRoZSBkaWZmZXJlbmNlIGluIGhvdyBgY29sb3I9YCBpcyBpbXBsZW1lbnRlZCBoZXJlLiBJdOKAmXMgbm8gbG9uZ2VyICoqbWFwcGluZyoqIGEgdmFyaWFibGXigJlzIGxldmVscyB0byBhIHJhbmdlIG9mIGNvbG9ycyBhcyB3aGVuIGl04oCZcyBjYWxsZWQgaW5zaWRlIG9mIHRoZSBgYWVzYCBmdW5jdGlvbiwgaW5zdGVhZCwgaXTigJlzICoqc2V0dGluZyoqIHRoZSBsaW5lIGNvbG9yIHRvIGJsdWUuDQoNCiMjIyBgZ2VvbV9wb2ludGANCg0KVGhpcyBnZW5lcmF0ZXMgcG9pbnQgZ2VvbWV0cmllcy4gVGhpcyBpcyBvZnRlbiB1c2VkIGluIGdlbmVyYXRpbmcgc2NhdHRlcnBsb3RzLiBGb3IgZXhhbXBsZSwgdXNpbmcgYGRhdGAgZGF0YXN0ZSB0byBwbG90ICBmZW1hbGUgaW5jb21lICh2YXJpYWJsZSBgQjIwMDA0MDEzYCkgdnMgbWFsZSBpbmNvbWUgKHZhcmlhYmxlIGBCMjAwMDQwMDdgKToNCg0KYGBge3IsICBldmFsPVR9DQpnZ3Bsb3QoZGF0MiwgYWVzKHggPSBCMjAwMDQwMTMsIHkgPSBCMjAwMDQwMDcpKSArIGdlb21fcG9pbnQoYWxwaGEgPSAwLjMpIA0KYGBgDQoNCkFzIGRpZCBlYXJsaWVyLCB3ZSBtb2RpZnkgdGhlIHBvaW504oCZcyB0cmFuc3BhcmVuY3kgYnkgcGFzc2luZyB0aGUgYGFscGhhPTAuM2AgcGFyYW1ldGVyIHRvIHRoZSBgZ2VvbV9wb2ludGAgZnVuY3Rpb24uIE90aGVyIHBhcmFtZXRlcnMgdGhhdCBjYW4gYmUgcGFzc2VkIHRvIHBvaW50IGdlb21zIGluY2x1ZGUgYGNvbG91cmAsIGBwY2hgIGFuZCBgY2V4YC4NCg0KYGBge3IsICBldmFsPVR9DQpnZ3Bsb3QoZGF0MiwgYWVzKHggPSBCMjAwMDQwMTMsIHkgPSBCMjAwMDQwMDcpKSArIA0KICBnZW9tX3BvaW50KGNvbG91ciA9ICJyZWQiLCBwY2g9MyAsIGFscGhhID0gMC4zLCBjZXg9MC42KQ0KYGBgDQoNCiMjIyBgZ2VvbV9oZXhgDQoNCldoZW4gYSBiaXZhcmlhdGUgc2NhdHRlciBwbG90IGhhcyB0b28gbWFueSBvdmVybGFwcGluZyBwb2ludHMsIGl0IG1heSBiZSBoZWxwZnVsIHRvIGJpbiB0aGUgb2JzZXJ2YXRpb25zIGludG8gcmVndWxhciBoZXhhZ29ucy4gVGhpcyBwcm92aWRlcyB0aGUgbnVtYmVyIG9mIG9ic2VydmF0aW9ucyBwZXIgYmluLg0KDQpgYGB7ciwgIGV2YWw9VH0NCmxpYnJhcnkoaGV4YmluKQ0KZ2dwbG90KGRhdDIsIGFlcyh4ID0gQjIwMDA0MDEzLCB5ID0gQjIwMDA0MDA3KSkgKyANCiAgZ2VvbV9oZXgoYmlud2lkdGggPSBjKDEwMDAsIDEwMDApKQ0KYGBgDQoNClRoZSBgYmlud2lkdGhgIGFyZ3VtZW50IGRlZmluZXMgdGhlIHdpZHRoIGFuZCBoZWlnaHQgb2YgZWFjaCBiaW4gaW4gdGhlIHZhcmlhYmxlc+KAmSBheGVzIHVuaXRzLg0KDQojIyMgYGdlb21fYm94cGxvdGANCg0KSW4gdGhlIGZvbGxvd2luZyBleGFtcGxlLCBhIGJveHBsb3Qgb2YgYFlpZWxkYCBpcyBnZW5lcmF0ZWQgZm9yIGVhY2ggYENyb3BgIHR5cGUuDQoNCmBgYHtyLCAgZXZhbD1UfQ0KZ2dwbG90KGRhdDFsLCBhZXMoeCA9IENyb3AsIHkgPSBZaWVsZCkpICsgZ2VvbV9ib3hwbG90KGZpbGwgPSAiYmlzcXVlIikgDQpgYGANCg0KSWYgd2Ugd2FudCB0byBnZW5lcmF0ZSBhIHNpbmdsZSBib3hwbG90IChmb3IgZXhhbXBsZSBmb3IgYWxsIHlpZWxkcyBpcnJlc3BlY3RpdmUgb2YgY3JvcCB0eXBlKSB3ZSBuZWVkIHRvIHBhc3MgYSBkdW1teSB2YXJpYWJsZSB0byBgeD1gOg0KDQpgYGB7ciwgIGV2YWw9VH0NCmdncGxvdChkYXQxbCwgYWVzKHggPSAiIiwgeSA9IFlpZWxkKSkgKyANCiAgZ2VvbV9ib3hwbG90KGZpbGwgPSAiYmlzcXVlIikgKyB4bGFiKCJBbGwgY3JvcHMiKQ0KYGBgDQoNCiMjIyBgZ2VvbV92aW9saW5gDQoNCkEgdmlvbGluIHBsb3QgaXMgYSBzeW1tZXRyaWNhbCB2ZXJzaW9uIG9mIGEgZGVuc2l0eSBwbG90IHdoaWNoIHByb3ZpZGVzIGV2ZW4gZ3JlYXRlciBkZXRhaWwgb2YgYSBzYW1wbGXigJlzIGRpc3RyaWJ1dGlvbiB0aGFuIGEgYm94cGxvdC4NCg0KYGBge3IsICBldmFsPVR9DQpnZ3Bsb3QoZGF0MWwsIGFlcyh4ID0gIiIsIHkgPSBZaWVsZCkpICsgZ2VvbV92aW9saW4oZmlsbCA9ICJiaXNxdWUiKSANCmBgYA0KDQojIyMgYGdlb21faGlzdG9ncmFtYA0KDQpIaXN0b2dyYW1zIGNhbiBiZSBwbG90dGVkIGZvciBzaW5nbGUgdmFyaWFibGVzIG9ubHkgKHVubGVzcyBmYWNldGluZyBpcyB1c2VkKSBhcyBjYW4gYmUgbm90ZWQgYnkgdGhlIGFic2VuY2Ugb2YgYSBgeT1gIHBhcmFtZXRlciBpbiBgYWVzYDoNCg0KYGBge3IsICBldmFsPVR9DQpnZ3Bsb3QoZGF0MXcsIGFlcyh4ID0gT2F0cykpICsgZ2VvbV9oaXN0b2dyYW0oZmlsbCA9ICJncmV5NTAiKQ0KYGBgDQoNClRoZSBiaW4gd2lkdGhzIGNhbiBiZSBzcGVjaWZpZWQgaW4gdGVybXMgb2YgdGhlIHZhbHVl4oCZcyB1bml0cy4gSW4gb3VyIGV4YW1wbGUsIHRoZSB1bml0IGlzIHlpZWxkIG9mIG9hdHMgKGluIGhnL0hhKS4gU28gaWYgd2Ugd2FudCB0byBnZW5lcmF0ZSBiaW4gd2lkdGhzIHRoYXQgY292ZXIgMTAwMCBoZy9IYSAoPSAxMDAga2cgLyBIYSksIHdlIGNhbiB0eXBlOg0KDQpgYGB7ciwgIGV2YWw9VH0NCmdncGxvdChkYXQxdywgYWVzKHggPSBPYXRzKSkgKyANCiAgZ2VvbV9oaXN0b2dyYW0oZmlsbCA9ICJncmV5NTAiLCBiaW53aWR0aCA9IDEwMDApIA0KYGBgDQoNCklmIHlvdSB3YW50IHRvIGNvbnRyb2wgdGhlIG51bWJlciBvZiBiaW5zLCB1c2UgdGhlIHBhcmFtZXRlciBgYmlucz1gIGluc3RlYWQuIEZvciBleGFtcGxlLCB0byBzZXQgdGhlIG51bWJlciBvZiBiaW5zIHRvIDgsIG1vZGlmeSB0aGUgYWJvdmUgY29kZSBjaHVuayBhcyBmb2xsb3dzOg0KDQpgYGB7ciwgIGV2YWw9VH0NCmdncGxvdChkYXQxdywgYWVzKHggPSBPYXRzKSkgKyANCiAgZ2VvbV9oaXN0b2dyYW0oZmlsbCA9ICJncmV5NTAiLCBiaW5zID0gOCkgDQpgYGANCg0KIyMjIGBnZW9tX2JhcmANCg0KQmFyIHBsb3RzIGFyZSB1c2VkIHRvIHN1bW1hcmllcyB0aGUgY291bnRzIG9mIGEgY2F0ZWdvcmljYWwgdmFsdWUuIEZvciBleGFtcGxlLCB0byBwbG90IHRoZSBudW1iZXIgb2YgY291bnRpZXMgaW4gZWFjaCBzdGF0ZSAobm90ZSB0aGF0IGVhY2ggcmVjb3JkIGluIGBkYXQyYCBpcyBhc3NpZ25lZCBhIGNvdW50eSk6DQoNCmBgYHtyLCAgZXZhbD1UfQ0KZ2dwbG90KGRhdDIsIGFlcyhTdGF0ZSkpICsgZ2VvbV9iYXIoKQ0KYGBgDQoNClRvIHNvcnQgdGhlIGJhcnMgYnkgbGVuZ3RoIHdlIG5lZWQgdG8gcmVhcnJhbmdlIHRoZSBTdGF0ZSBmYWN0b3IgbGV2ZWwgb3JkZXIgYmFzZWQgb24gdGhlIG51bWJlciBvZiBjb3VudGllcyBpbiBlYWNoIHN0YXRlICh3aGljaCBpcyB0aGUgbnVtYmVyIG9mIHRpbWVzIGEgc3RhdGUgYXBwZWFycyBpbiB0aGUgZGF0YSBmcmFtZSkuIFdl4oCZbGwgbWFrZSB1c2Ugb2YgYGZvcmNhdHNg4oCZcyBgZmN0X2luZnJlcWAgZnVuY3Rpb24gdG8gcmVvcmRlciB0aGUgU3RhdGUgZmFjdG9yIGxldmVscyBiYXNlZCBvbiBmcmVxdWVuY3kuDQoNCmBgYHtyLCAgZXZhbD1UfQ0KbGlicmFyeShmb3JjYXRzKQ0KZ2dwbG90KGRhdDIsIGFlcyhmY3RfaW5mcmVxKFN0YXRlLG9yZGVyZWQgPSBUUlVFKSkpICsgZ2VvbV9iYXIoKQ0KYGBgDQoNCklmIHdlIHdhbnQgdG8gcmV2ZXJzZSB0aGUgb3JkZXIgKGkuZS4gcGxvdCBmcm9tIHNtYWxsZXN0IG51bWJlciBvZiBjb3VudGllcyB0byBncmVhdGVzdCksIHdyYXAgdGhlIGBmY3RfaW5mcmVxYCBmdW5jdGlvbiB3aXRoIGBmY3RfcmV2YC4NCg0KYGBge3IsICBldmFsPVR9DQpnZ3Bsb3QoZGF0MiwgYWVzKGZjdF9yZXYoZmN0X2luZnJlcShTdGF0ZSxvcmRlcmVkID0gVFJVRSkpKSkgKyBnZW9tX2JhcigpDQpgYGANCg0KVGhlIGBnZW9tX2JhcmAgZnVuY3Rpb24gY2FuIGFsc28gYmUgdXNlZCB3aXRoIGNvdW50IHZhbHVlcyAoaS5lLiB2YXJpYWJsZSBhbHJlYWR5IHN1bW1hcml6ZWQgYnkgY291bnQpLiBGaXJzdCwgd2XigJlsbCBzdW1tYXJpZXMgdGhlIG51bWJlciBvZiBjb3VudGllcyBieSBzdGF0ZSB1c2luZyB0aGUgZHBseXIgcGFja2FnZS4gVGhpcyB3aWxsIGdlbmVyYXRlIGEgZGF0YSBmcmFtZSB3aXRoIGp1c3QgNTEgcmVjb3Jkczogb25lIGZvciBlYWNoIG9mIHRoZSA1MCBzdGF0ZXMgYW5kIHRoZSBEaXN0cmljdCBvZiBDb2x1bWJpYS4NCg0KYGBge3IsICBldmFsPVR9DQpkYXQyLmN0IDwtIGRhdDIgJT4lIGdyb3VwX2J5KFN0YXRlKSAlPiUgDQogICAgICAgICAgICAgICAgc3VtbWFyaXplKENvdW50aWVzID0gbigpKQ0KaGVhZChkYXQyLmN0KQ0KYGBgDQoNCldoZW4gdXNpbmcgc3VtbWFyaXplZCBkYXRhLCB3ZSBtdXN0IHBhc3MgdGhlIHBhcmFtZXRlciBgc3RhdD0iaWRlbnRpdHkiYCB0byB0aGUgYGdlb21fYmFyYCBmdW5jdGlvbi4gV2UgbXVzdCBhbHNvIGV4cGxpY2l0bHkgbWFwIHRoZSAqeCogYW5kICp5KiBheGVzIGdlb21ldHJpZXMuIE5vdGUgdGhhdCBzaW5jZSB3ZSBhcmUgbm93IGdlbmVyYXRpbmcgYmFyIGhlaWdodHMgZnJvbSBhIHZhbHVlIGZpZWxkIGFuZCBub3QgYSBmcmVxdWVuY3ksIHdlIHdpbGwgbmVlZCB0byB1c2UgYW5vdGhlciBgZm9yY2F0c2Agb3JkZXJpbmcgZnVuY3Rpb24gY2FsbGVkIGBmY3RfcmVvcmRlcmAuIFRoaXMgZnVuY3Rpb24gdGFrZXMgdGhyZWUgcGFyYW1ldGVyczogdGhlIHZhcmlhYmxlIHRvIGJlIG9yZGVyZWQgKGBTdGF0ZWApLCB0aGUgdmFyaWFibGUgd2hvc2UgdmFsdWVzIHdpbGwgZGV0ZXJtaW5lIHRoZSBvcmRlciAoYENvdW50aWVzYCkgYW5kIHRoZSBmdW5jdGlvbiwgYGZ1bj1gLCB3aGljaCBkZWZpbmVzIHRoZSBzdGF0aXN0aWMgdXNlZCB0byBzdW1tYXJpZXMgdGhlIHNvcnRpbmcgdmFyaWFibGUuIFNpbmNlIHRoZXJlIGlzIGp1c3Qgb25lIHZhbHVlIHBlciBzdGF0ZSwgd2UgY2FuIHVzZSBhbnkgc3VtbWFyeSBzdGF0aXN0aWMgc3VjaCBhcyBgbWVkaWFuYCwgYG1lYW5gLCBgc3VtYCwgYG1pbmAgb3IgYG1heGAuDQoNCmBgYHtyLCAgZXZhbD1UfQ0KZ2dwbG90KGRhdDIuY3QsIGFlcyh4PWZjdF9yZW9yZGVyKFN0YXRlLCBDb3VudGllcywgLmZ1biA9IG1lZGlhbiksIHkgPSBDb3VudGllcykpICsgZ2VvbV9iYXIoc3RhdCA9ICJpZGVudGl0eSIpDQpgYGANCg0KTm90ZSB0aGF0IHlvdSBjYW4gcmVwbGFjZSBgZmN0X3Jlb3JkZXJgIGZyb20gdGhlIGBmb3JjYXRzYCBwYWNrYWdlcyB3aXRoIHRoZSBgYmFzZWAgZnVuY3Rpb24gYHJlb3JkZXJgIG1lbnRpb25lZCBlYWxpZXIgaW4gdGhlIGNsYXNzLg0KDQojIyMgZG90IHBsb3QNCg0KVGhlIGRvdCBwbG90IGlzIGFuIGFsdGVybmF0aXZlIHdheSB0byB2aXN1YWxpemUgY291bnRzIGFzIGEgZnVuY3Rpb24gb2YgYSBjYXRlZ29yaWNhbCB2YXJpYWJsZS4gSW5zdGVhZCBvZiBtYXBwaW5nIGBTdGF0ZWAgdG8gdGhlIHgtYXhpcywgd2XigJlsbCBtYXAgaXQgdG8gdGhlIHktYXhpcy4NCg0KYGBge3IsICBldmFsPVR9DQpnZ3Bsb3QoZGF0Mi5jdCAsIGFlcyh4ID0gQ291bnRpZXMsIHkgPSBTdGF0ZSkpICsgZ2VvbV9wb2ludCgpDQpgYGANCg0KRG90IHBsb3QgZ3JhcGhpY3MgYmVuZWZpdCBmcm9tIHNvcnRpbmfigJNtb3JlIHNvIHRoZW4gYmFyIHBsb3RzLiBIZXJlLCB3ZeKAmWxsIG1ha2UgdXNlIG9mICoqYGZvcmNhdHM6OmZjdF9yZW9yZGVyYCoqIGZ1bmN0aW9uIChub3RlIG9uIHRoaXMgbm90YXRpb246IGl0IGlzIHRvIGNhbGwgYSBmdW5jdGlvbiBmcm9tIGEgc3BlY2lmaWMgcGFja2FnZSwgc3VjaCBhcyBpdCBjYW4gYXZvaWQgY29uZmxpY3RzKS4NCg0KYGBge3IsICBldmFsPVR9DQpnZ3Bsb3QoZGF0Mi5jdCAsIGFlcyh4ID0gQ291bnRpZXMsIHkgPSBmY3RfcmVvcmRlcihTdGF0ZSwgQ291bnRpZXMsIC5mdW4gPSBtZWRpYW4pKSkgKyBnZW9tX3BvaW50KCkNCmBgYA0KDQojIyMgQ29tYmluaW5nIGdlb21ldHJpZXMNCg0KT2J2aW91c2x5LCBnZW9tZXRyaWVzIGNhbiBiZSAgbGF5ZXJlZC4gRm9yIGV4YW1wbGUsIHRvIG92ZXJsYXkgYSBsaW5lYXIgcmVncmVzc2lvbiBsaW5lIHRvIHRoZSBkYXRhIHdlIGNhbiBhZGQgYSBgZ2VvbV9zbW9vdGhgIGxheWVyOg0KDQpgYGB7ciwgIGV2YWw9VH0NCmdncGxvdChkYXQyLCBhZXMoeCA9IEIyMDAwNDAxMywgeSA9IEIyMDAwNDAwNykpICsgDQogIGdlb21fcG9pbnQoYWxwaGEgPSAwLjMsIGNvbG9yPScjNGY0YjRiJykgKyANCiAgZ2VvbV9zbW9vdGgobWV0aG9kID0gImxtIiwgY29sb3I9J2dyZWVuJykNCmBgYA0KDQpUaGUgYGdlb21fc21vb3RoYCBjYW4gYmUgdXNlZCB0byBmaXQgb3RoZXIgKmxpbmVzKiBzdWNoIGFzIGEgbG9lc3MgbGluZToNCg0KYGBge3IsICBldmFsPVR9DQpnZ3Bsb3QoZGF0MiwgYWVzKHggPSBCMjAwMDQwMTMsIHkgPSBCMjAwMDQwMDcpKSArIA0KICBnZW9tX3BvaW50KGFscGhhID0gMC4zLCBjb2xvcj0nIzRmNGI0YicpICsNCiAgZ2VvbV9zbW9vdGgobWV0aG9kID0gImxvZXNzIiwgY29sb3I9J2dyZWVuJykNCmBgYA0KDQpUaGUgY29uZmlkZW5jZSBpbnRlcnZhbCBjYW4gYmUgcmVtb3ZlZCBmcm9tIHRoZSBzbW9vdGggZ2VvbWV0cnkgYnkgc3BlY2lmeWluZyBgc2UgPSBGQUxTRWAuDQoNCiMjIFR3ZWFraW5nIGEgYGdncGxvdDJgIGdyYXBoDQoNCkxpdHRsZSB0cmljayBmb3IgZGF0YSB2aXN1YWxpemF0aW9uIHdpdGggYGdncGxvdDJgIHN1bW1hcml6ZWQgW2hlcmVdKGh0dHBzOi8vcnN0dWRpby5jb20vd3AtY29udGVudC91cGxvYWRzLzIwMTUvMDMvZ2dwbG90Mi1jaGVhdHNoZWV0LnBkZikuIFlvdSB3aWxsIGhhdmUgdG8gc3BlbmQgcXVpdGUgYSBsb3Qgb2YgdGltZSB0byBnZXQgYWxsIHRoZSBmdW5jdGlvbmFsaXR5IG9mZiB0aGUgYGdncGxvdDJgLiBIYXBwaWx5LCBtYW55IGRvY3VtZW50YXRpb25zIGFyZSBhdmFpbGFibGUgb25saW5lIC4gQ2hlY2sgdGhlIFtSIGdhbGxlcnldKGh0dHBzOi8vd3d3LnItZ3JhcGgtZ2FsbGVyeS5jb20vKS4NCg0KIyMjIFBsb3QgdGl0bGUgDQoNCllvdSBjYW4gYWRkIGEgcGxvdCB0aXRsZSB1c2luZyB0aGUgYGdndGlsZWAgZnVuY3Rpb24uDQoNCmBgYHtyLCAgZXZhbD1UfQ0KZ2dwbG90KGRhdDIsIGFlcyhTdGF0ZSkpICsgZ2VvbV9iYXIoKSArIGdndGl0bGUoIk51bWJlciBvZiBjb3VudGllcyBieSBzdGF0ZSIpDQpgYGANCg0KIyMjIEF4ZXMgdGl0bGVzDQoNCkF4ZXMgdGl0bGVzIGNhbiBiZSBleHBsaWNpdGx5IGRlZmluZWQgdXNpbmcgdGhlIGB4bGFiYCBhbmQgYHlsYWJgIGZ1bmN0aW9ucy4NCg0KYGBge3IsICBldmFsPVR9DQpnZ3Bsb3QoZGF0MiwgYWVzKHggPSBCMjAwMDQwMTMsIHkgPSBCMjAwMDQwMDcpKSArIGdlb21fcG9pbnQoYWxwaGEgPSAwLjMpICsgeGxhYigiRmVtYWxlIGluY29tZSAoJCkiKSArIHlsYWIoIk1hbGUgaW5jb21lICgkKSIpDQpgYGANCg0KVG8gcmVtb3ZlIGF4aXMgbGFiZWxzLCBzaW1wbHkgcGFzcyBOVUxMIHRvIHRoZSBmdW5jdGlvbnMgYXMgaW4gYHhsYWIoTlVMTClgIGFuZCBgeWxhYihOVUxMKWANCg0KDQojIyMgQXhlcyBsYWJlbHMNCg0KWW91IGNhbiBjdXN0b21pemUgYW4gYXhpc+KAmSBsYWJlbCBlbGVtZW50cy4gSWYgeW91IGFyZSBtYXBwaW5nIGNvbnRpbnVvdXMgdmFsdWVzIGFsb25nIHRoZSB4IGFuZCB5IGF4ZXMsIHVzZSB0aGUgYHNjYWxlX3hfY29udGludW91c2AgYW5kIGBzY2FsZV95X2NvbnRpbnVvdXNgIGZ1bmN0aW9ucy4gRm9yIGV4YW1wbGUsIHRvIHNwZWNpZnkgd2hlcmUgdG8gcGxhY2UgdGhlIHRpY3MgYW5kIHRoZSBhY2NvbXBhbnlpbmcgbGFiZWxzLCB0eXBlOg0KDQpgYGB7ciwgIGV2YWw9VH0NCmdncGxvdChkYXQyLCBhZXMoeCA9IEIyMDAwNDAxMywgeSA9IEIyMDAwNDAwNykpKyANCiAgZ2VvbV9wb2ludChhbHBoYSA9IDAuMykgKw0KICB4bGFiKCJGZW1hbGUgaW5jb21lICgkKSIpICsgDQogIHlsYWIoIk1hbGUgaW5jb21lICgkKSIpICsNCiAgc2NhbGVfeF9jb250aW51b3VzKGJyZWFrcyA9IGMoMTAwMDAsIDMwMDAwLCA1MDAwMCksbGFiZWxzID0gYygiJDEwLDAwMCIsICIkMzAsMDAwIiwgIiQ1MCwwMDAiKSkNCmBgYA0KDQpZb3UgY2hhbmdlIHRoZSBsYWJlbCBmb3JtYXRzIHdoZXJlYnkgdGhlIG51bWJlcnMgYXJlIHRydW5jYXRlZCB0byBhIHRob3VzYW5kdGggb2YgdGhlaXIgb3JpZ2luYWwgdmFsdWUsIHlvdSBjYW4gbWFrZSB1c2Ugb2YgYHVuaXRfZm9ybWF0YCBmcm9tIHRoZSBgc2NhbGVzYCBwYWNrYWdlOg0KDQpgYGB7ciwgIGV2YWw9VH0NCmdncGxvdChkYXQyLCBhZXMoeD1CMjAwMDQwMTMsIHk9QjIwMDA0MDA3KSkgKyBnZW9tX3BvaW50KGFscGhhPTAuMykgKw0KICAgeGxhYigiRmVtYWxlIGluY29tZSAoJCkiKSArIHlsYWIoIk1hbGUgaW5jb21lICgkKSIpICsNCiAgIHNjYWxlX3hfY29udGludW91cyhsYWJlbHM9c2NhbGVzOjp1bml0X2Zvcm1hdChzdWZmaXg9ImsiLHNjYWxlPTAuMDAxLCBzZXA9IiIpKSArDQogICBzY2FsZV95X2NvbnRpbnVvdXMobGFiZWxzPXNjYWxlczo6dW5pdF9mb3JtYXQoc3VmZml4PSJrIiwgc2NhbGU9MC4wMDEsIHNlcD0iIikpDQpgYGANCg0KWW91IGNhbiByb3RhdGUgYXhlcyBsYWJlbHMgdXNpbmcgdGhlIHRoZW1lIGZ1bmN0aW9uLg0KDQpgYGB7ciwgIGV2YWw9VH0NCmdncGxvdChkYXQyLCBhZXMoeD1CMjAwMDQwMTMsIHk9QjIwMDA0MDA3KSkgKyBnZW9tX3BvaW50KGFscGhhPTAuMykgKw0KICAgeGxhYigiRmVtYWxlIGluY29tZSAoJCkiKSArIHlsYWIoIk1hbGUgaW5jb21lICgkKSIpICsNCiAgIHNjYWxlX3hfY29udGludW91cyhsYWJlbHM9c2NhbGVzOjp1bml0X2Zvcm1hdChzdWZmaXg9ImsiLCBzY2FsZT0wLjAwMSwgc2VwPSIiKSkgKw0KICAgc2NhbGVfeV9jb250aW51b3VzKGxhYmVscz1zY2FsZXM6OnVuaXRfZm9ybWF0KHN1ZmZpeD0iayIsIHNjYWxlPTAuMDAxLCBzZXA9IiIpKSArDQogICB0aGVtZShheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChhbmdsZSA9IDQ1LCBoanVzdCA9IDEpKSANCmBgYA0KDQpUaGUgYGhqdXN0YCBhcmd1bWVudCBqdXN0aWZpZXMgdGhlIHZhbHVlcyBob3Jpem9udGFsbHkuIEl0cyB2YWx1ZSByYW5nZXMgZnJvbSBgMGAgdG8gYDFgIHdoZXJlIGAwYCBpcyBjb21wbGV0ZWx5IGxlZnQtanVzdGlmaWVkIGFuZCBgMWAgaXMgY29tcGxldGVseSByaWdodC1qdXN0aWZpZWQuIE5vdGUgdGhhdCB0aGUganVzdGlmaWNhdGlvbiBpcyAqcmVsYXRpdmUqIHRvIHRoZSB0ZXh04oCZcyBvcmllbnRhdGlvbiBhbmQgKm5vdCogdG8gdGhlIGF4aXMuIFNvIGl0IG1heSBiZSBiZXN0IHRvIGZpcnN0IHJvdGF0ZSB0aGUgbGFiZWwgdmFsdWVzLCB0aGVuIHRvIGFkanVzdCBqdXN0aWZpY2F0aW9uIGJhc2VkIG9uIHRoZSBwbG904oCZcyBsb29rIGFzIG5lZWRlZC4NCg0KSWYgeW91IHdhbnQgdGhlIGxhYmVsIHZhbHVlcyByb3RhdGVkIDkwwrAgeW91IG1pZ2h0IGFsc28gbmVlZCB0byBqdXN0aWZ5IHZlcnRpY2FsbHkgKHJlbGF0aXZlIHRvIHRoZSB0ZXh04oCZcyBvcmllbnRhdGlvbikgdXNpbmcgdGhlIGB2anVzdGAgYXJndW1lbnQgd2hlcmUgYDBgIGlzIGNvbXBsZXRlbHkgdG9wLWp1c3RpZmllZCBhbmQgYDFgIGlzIGNvbXBsZXRlbHkgYm90dG9tLWp1c3RpZmllZC4NCg0KIyMjIEF4ZXMgbGltaXRzDQoNCg0KVGhlIGF4aXMgcmFuZ2UgY2FuIGJlIHNldCB1c2luZyBgeGxpbWAgYW5kIGB5bGltYC4NCg0KDQpgYGB7ciwgIGV2YWw9VH0NCmdncGxvdChkYXQyLCBhZXMoeCA9IEIyMDAwNDAxMywgeSA9IEIyMDAwNDAwNykpICsgZ2VvbV9wb2ludChhbHBoYSA9IDAuMykgKw0KICAgICAgIHhsYWIoIkZlbWFsZSBpbmNvbWUgKCQpIikgKyB5bGFiKCJNYWxlIGluY29tZSAoJCkiKSArDQogICAgICAgeGxpbSgxMDAwMCwgNzUwMDApICsgeWxpbSgxMDAwMCwgNzUwMDApDQpgYGANCg0KSG93ZXZlciwgaWYgeW91IGFyZSBjYWxsaW5nIHRoZSBgc2NhbGVfeF9jb250aW51b3VzYCBhbmQgYHNjYWxlX3lfY29udGludW91c2AgZnVuY3Rpb25zLCB5b3UgZG8gbm90IHdhbnQgdG8gdXNlIGB4bGltYCBhbmQgYHlsaW1gLiBJbnN0ZWFkLCB5b3Ugc2hvdWxkIHNldCB0aGUgYGxpbWl0PWAgYXJndW1lbnQgdG8gdGhlIGFmb3JlbWVudGlvbmVkIGZ1bmN0aW9ucy4gRm9yIGV4YW1wbGU6DQoNCmBgYHtyLCAgZXZhbD1UfQ0KZ2dwbG90KGRhdDIsIGFlcyh4ID0gQjIwMDA0MDEzLCB5ID0gQjIwMDA0MDA3KSkgKyBnZW9tX3BvaW50KGFscGhhID0gMC4zKSArDQogICB4bGFiKCJGZW1hbGUgaW5jb21lICgkKSIpICsgeWxhYigiTWFsZSBpbmNvbWUgKCQpIikgKw0KICAgc2NhbGVfeF9jb250aW51b3VzKGxpbWl0ICA9IGMoMTAwMDAsIDc1MDAwKSxsYWJlbHMgPSBzY2FsZXM6OmNvbW1hX2Zvcm1hdCgpKSArDQogICBzY2FsZV95X2NvbnRpbnVvdXMobGltaXQgID0gYygxMDAwMCwgNzUwMDApLCBsYWJlbHMgPSBzY2FsZXM6OmNvbW1hX2Zvcm1hdCgpKQ0KYGBgDQoNCk5vdGUgdGhlIHVzZSBvZiB0aGUgZnVuY3Rpb24gYGNvbW1hX2Zvcm1hdGAgZnJvbSB0aGUgYHNjYWxlYCB0aGF0IHdpbGwgYWRkIGNvbW1hcyB0byBsYXJnZSBudW1iZXJzDQoNCiMjIyBBeGVzIGJyZWFrcw0KDQpZb3UgY2FuIGV4cGxpY2l0bHkgZGVmaW5lIHRoZSBicmVha3Mgd2l0aCB0aGUgYGJyZWFrc2AgYXJndW1lbnQuIENvbnRpbnVpbmcgd2l0aCB0aGUgbGFzdCBleGFtcGxlLCB3ZSBnZXQ6DQoNCmBgYHtyLCAgZXZhbD1UfQ0KZ2dwbG90KGRhdDIsIGFlcyh4ID0gQjIwMDA0MDEzLCB5ID0gQjIwMDA0MDA3KSkgKyBnZW9tX3BvaW50KGFscGhhID0gMC4zKSArDQogICB4bGFiKCJGZW1hbGUgaW5jb21lICgkKSIpICsgeWxhYigiTWFsZSBpbmNvbWUgKCQpIikgKw0KICAgc2NhbGVfeF9jb250aW51b3VzKGxpbWl0ICA9IGMoMTAwMDAsIDc1MDAwKSxsYWJlbHMgPSBzY2FsZXM6OmNvbW1hX2Zvcm1hdCgpLGJyZWFrcyA9IGMoMTAwMDAsIDMwMDAwLCA1MDAwMCwgNzAwMDApKSArDQogICBzY2FsZV95X2NvbnRpbnVvdXMobGltaXQgID0gYygxMDAwMCwgNzUwMDApLGxhYmVscyA9IHNjYWxlczo6Y29tbWFfZm9ybWF0KCksYnJlYWtzID0gYygxMDAwMCwgMzAwMDAsIDUwMDAwLCA3MDAwMCkpDQpgYGANCg0KTm90ZSB0aGF0IHRoZSBgYnJlYWtzYCBhcmd1bWVudCBjYW4gYmUgdXNlZCBpbiBjb25qdW5jdGlvbiB3aXRoIG90aGVyIGFyZ3VtZW50cyAoYXMgc2hvd24gaW4gdGhpcyBleGFtcGxlKSwgb3IgYnkgaXRzZWxmLg0KDQojIyMgQXhlcyBhbmQgZGF0YSB0cmFuc2Zvcm1hdGlvbnMNCg0KSWYgeW91IHdpc2ggdG8gYXBwbHkgYSBub24tbGluZWFyIHRyYW5zZm9ybWF0aW9uIHRvIGVpdGhlciBheGVzICh3aGlsZSBwcmVzZXJ2aW5nIHRoZSB1bnRyYW5zZm9ybWVkIGF4aXMgdmFsdWVzKSBhZGQgdGhlIGBjb29yZF90cmFuc2AgZnVuY3Rpb24gYXMgZm9sbG93czoNCg0KYGBge3IsICBldmFsPVR9DQpnZ3Bsb3QoZGF0MiwgYWVzKHggPSBCMjAwMDQwMTMsIHkgPSBCMjAwMDQwMDcpKSArIGdlb21fcG9pbnQoYWxwaGEgPSAwLjMpICsNCiAgICAgICB4bGFiKCJGZW1hbGUgaW5jb21lICgkKSIpICsgeWxhYigiTWFsZSBpbmNvbWUgKCQpIikgKw0KICAgICAgIGNvb3JkX3RyYW5zKHggPSAibG9nIikNCmBgYA0KDQpZb3UgY2FuIGFsc28gdHJhbnNmb3JtIHRoZSB5LWF4aXMgYnkgc3BlY2lmeWluZyB0aGUgcGFyYW1ldGVyIGB5PWAuIFRoZSBgbG9nYCB0cmFuc2Zvcm1hdGlvbiBkZWZhdWx0cyB0byB0aGUgbmF0dXJhbCBsb2cuIEZvciBhIGxvZyBiYXNlIDEwLCB1c2UiYGxvZzEwYCIgaW5zdGVhZC4gRm9yIGEgc3F1YXJlIHJvb3QgdHJhbnNmb3JtYXRpb24sIHVzZSAiYHNxcnRgIi4gRm9yIHRoZSBpbnZlcnNlIHVzZSAiYHJlY2lwcm9jYWxgIi4NCg0KQWR2YW5jZWQgdHJhbnNmb3JtYXRpb25zIGNhbiBiZSBjYWxsZWQgdmlhIHRoZSBgc2NhbGVzYCBwYWNrYWdlLiBGb3IgZXhhbXBsZSwgdG8gaW1wbGVtZW50IHRoZSBib3gtY294IHRyYW5zZm9ybWF0aW9uICh3aXRoIGEgcG93ZXIgb2YgYC0wLjNgKSwgdHlwZToNCg0KYGBge3IsICBldmFsPVR9DQpnZ3Bsb3QoZGF0MiwgYWVzKHggPSBCMjAwMDQwMTMsIHkgPSBCMjAwMDQwMDcpKSArIGdlb21fcG9pbnQoYWxwaGEgPSAwLjMpICsNCiAgICAgICB4bGFiKCJGZW1hbGUgaW5jb21lICgkKSIpICsgeWxhYigiTWFsZSBpbmNvbWUgKCQpIikgKw0KICAgICAgIGNvb3JkX3RyYW5zKHggPSBzY2FsZXM6OmJveGNveF90cmFucygtMC4zKSkNCmBgYA0KDQpOb3RlIHRoYXQgYW55IHN0YXRpc3RpY2FsIGdlb20gKHN1Y2ggYXMgdGhlIHJlZ3Jlc3Npb24gbGluZSkgd2lsbCBiZSBhcHBsaWVkIHRvIHRoZSAqdW4tdHJhbnNmb3JtZWQqIGRhdGEuIFNvIGEgbGluZWFyIG1vZGVsIG1heSBlbmQgdXAgbG9va2luZyBub24tbGluZWFyIGFmdGVyIGFuIGF4aXMgdHJhbnNmb3JtYXRpb24uIElmIGEgbGluZWFyIGZpdCBpcyB0byBiZSBhcHBsaWVkIHRvIHRoZSB0cmFuc2Zvcm1lZCBkYXRhLCBhIGJldHRlciBhbHRlcm5hdGl2ZSBpcyB0byB0cmFuc2Zvcm0gdGhlIHZhbHVlcyBpbnN0ZWFkIG9mIHRoZSBheGVzLiBUaGUgdHJhbnNmb3JtYXRpb24gY2FuIGJlIGRvbmUgb24gdGhlIG9yaWdpbmFsIGRhdGEgb3IgaXQgY2FuIGJlIGltcGxlbWVudGVkIGluIGdncGxvdCB1c2luZyB0aGUgYHNjYWxlX3hfY29udGludW91c2AgYW5kIGBzY2FsZV95X2NvbnRpbnVvdXNgIGZ1bmN0aW9ucyBzdWNoIGFzOg0KDQpgYGB7ciwgIGV2YWw9VH0NCmdncGxvdChkYXQyLCBhZXMoeCA9IEIyMDAwNDAxMywgeSA9IEIyMDAwNDAwNykpICsgZ2VvbV9wb2ludChhbHBoYSA9IDAuMykgKw0KICAgICAgIGdlb21fc21vb3RoKG1ldGhvZCA9ICJsbSIsIHNlID0gRkFMU0UpICsNCiAgICAgICB4bGFiKCJGZW1hbGUgaW5jb21lICgkKSIpICsgeWxhYigiTWFsZSBpbmNvbWUgKCQpIikgKw0KICAgICAgIHNjYWxlX3hfY29udGludW91cyh0cmFucyA9ICJsb2ciLCBicmVha3MgPSBzZXEoMTAwMDAsNjAwMDAsMTAwMDApKQ0KYGBgDQoNClRoZSBgc2NhbGVfeF9jb250aW51b3VzYCBhbmQgYHNjYWxlX3lfY29udGludW91c2AgZnVuY3Rpb25zIHdpbGwgYWNjZXB0IGBzY2FsZXNgIHRyYW5zZm9ybWF0aW9uIHBhcmFtZXRlcnPigJNlLmcuIGBzY2FsZV94X2NvbnRpbnVvdXModHJhbnMgPSBzY2FsZXM6OmJveGNveF90cmFucygtMC4zKSlgLiBOb3RlIHRoYXQgdGhlIHBhcmFtZXRlciBgYnJlYWtzYCBpcyBub3QgcmVxdWlyZWQgYnV0IGlzIHVzZWQgaGVyZSB0byBoaWdobGlnaHQgdGhlIHRyYW5zZm9ybWVkIG5hdHVyZSBvZiB0aGUgYXhpcy4NCg0KIyMjIEFzcGVjdCByYXRpbw0KDQpZb3UgY2FuIGltcG9zZSBhbiBhc3BlY3QgcmF0aW8gdG8geW91ciBwbG90IHVzaW5nIHRoZSBgY29vcmRfZXF1YWxgIGZ1bmN0aW9uLiBGb3IgZXhhbXBsZSwgdG8gc2V0IHRoZSBheGVzIHVuaXRzIGVxdWFsIChpbiBsZW5ndGgpIHRvIG9uZSBhbm90aGVyIHNldCBgcmF0aW89MWA6DQoNCmBgYHtyLCAgZXZhbD1UfQ0KZ2dwbG90KGRhdDIsIGFlcyh4ID0gQjIwMDA0MDEzLCB5ID0gQjIwMDA0MDA3KSkgKyBnZW9tX3BvaW50KGFscGhhID0gMC4zKSArDQogICAgICAgZ2VvbV9zbW9vdGgobWV0aG9kID0gImxtIikgKw0KICAgICAgIHhsYWIoIkZlbWFsZSBpbmNvbWUgKCQpIikgKyB5bGFiKCJNYWxlIGluY29tZSAoJCkiKSArDQogICAgICAgY29vcmRfZXF1YWwocmF0aW8gPSAxKQ0KYGBgDQoNCiMjIyBDb2xvcnMNCg0KWW91IGNhbiBjdXN0b21pemUgZ2VvbSBjb2xvcnMgdXNpbmcgb25lIG9mIHR3byBzZXRzIG9mIGNvbG9yIHNjaGVtZXM6IG9uZSBmb3IgY29udGludW91cyB2YWx1ZXMsIHRoZSBvdGhlciBmb3IgY2F0ZWdvcmljYWwgKGRpc2NyZXRlKSB2YWx1ZXMuDQoNCkNvbnRpbm91c3xDYXRlZ29yaWNhbA0KLS0tLS0tLS0tfC0tLS0tLS0tLS0tLQ0Kc2NhbGVfY29sb3VyX2dyYWRpZW50fHNjYWxlX2NvbG91cl9odWUNCnNjYWxlX2NvbG91cl9ncmFkaWVudDJ8c2NhbGVfY29sb3VyX2dyZXkNCnNjYWxlX2NvbG9yX2Rpc3RpbGxlcnxzY2FsZV9jb2xvdXJfbWFudWFsDQpzY2FsZV9maWxsX2dyYWRpZW50MnxzY2FsZV9jb2xvdXJfYnJld2VyDQpzY2FsZV9maWxsX2dyYWRpZW50fA0Kc2NhbGVfZmlsbF9kaXN0aWxsZXJ8DQoNCiMjIyMgQ29udGludW91cyBjb2xvciBzY2hlbWVzDQoNClRoZSBmb2xsb3dpbmcgY2h1bmsgb2YgY29kZSBzdW1tYXJpemVzIGRhdDIgYnkgdGFsbHlpbmcgdGhlIG51bWJlciBvZiBjb3VudGllcyBpbiBlYWNoIHN0YXRlIGFuZCBieSBjb21wdXRpbmcgdGhlIG1lZGlhbiBjb3VudHkgaW5jb21lIHZhbHVlcy4NCg0KYGBge3IsICBldmFsPVR9DQpkYXQyLmN0MiA8LSBkYXQyICU+JSBncm91cF9ieShTdGF0ZSkgJT4lIHN1bW1hcml6ZShDb3VudGllcyA9IG4oKSwgSW5jb21lID0gbWVkaWFuKEIyMDAwNDAwMSkpDQpgYGANCg0KVGhlIGZvbGxvd2luZyBjaHVuayBhcHBsaWVzIGEgZ3JlZW4gdG8gcmVkIGNvbG9yIGdyYWRpZW50IGZpbGwgdG8gZWFjaCBiYXIgYmFzZWQgb24gdGhlIG1lZGlhbiBjb3VudHkgaW5jb21lcy4gTm90ZSB0aGF0IHdlIGFyZSB1c2luZyB0aGUgc3VtbWFyaXplZCBjb3VudCB0YWJsZSAoYW5kIG5vdCB0aGUgb3JpZ2luYWwgZGF0MiB0YWJsZSkuIFJlY2FsbCB0aGF0IHdoZW4gcGxvdHRpbmcgYmFycyBmcm9tIGNvdW50cyB0aGF0IGFyZSBhbHJlYWR5IHRhYnVsYXRlZCB3ZSBtdXN0IHNwZWNpZnkgYHN0YXQ9ImlkZW50aXR5ImAgaW4gdGhlIGBnZW9tX2JhcmAgZnVuY3Rpb24uDQoNCmBgYHtyLCAgZXZhbD1UfQ0KZ2dwbG90KGRhdDIuY3QyLCBhZXMoeCA9IGZjdF9yZW9yZGVyKFN0YXRlLCBDb3VudGllcyksIHkgPSBDb3VudGllcywgZmlsbCA9IEluY29tZSkpICsNCiAgIGdlb21fYmFyKHN0YXQgPSAiaWRlbnRpdHkiKSArIA0KICAgc2NhbGVfZmlsbF9ncmFkaWVudChsb3cgPSAiZ3JlZW4iLCBoaWdoID0gInJlZCIpDQpgYGANCg0KVGhlIGZvbGxvd2luZyBjaHVuayBhcHBsaWVzIGEgZGl2ZXJnZW50IGNvbG9yIHNjaGVtZSB3aGlsZSBhbGxvd2luZyBvbmUgdG8gc3BlY2lmeSB0aGUgY2VudHJhbCB2YWx1ZSBvZiB0aGlzIHNjaGVtZS4gTm90ZSB0aGF0IHRoZSBjb2xvcnMgYXJlIHN5bW1ldHJpY2FsIGFib3V0IHRoZSBtaWRwb2ludCB3aGljaCBtYXkgcmVzdWx0IGluIG9ubHkgYSBwYXJ0aWFsIHJhbmdlIG9mIHRoZSBmdWxsIHBvc3NpYmxlIGdyYWRpZW50IG9mIGNvbG9ycy4NCg0KYGBge3IsICBldmFsPVR9DQpnZ3Bsb3QoZGF0Mi5jdDIsIGFlcyh4ID0gZmN0X3Jlb3JkZXIoU3RhdGUsIENvdW50aWVzKSwgeSA9IENvdW50aWVzLCBmaWxsID0gSW5jb21lKSkgKw0KICAgZ2VvbV9iYXIoc3RhdCA9ICJpZGVudGl0eSIpICsgDQogICBzY2FsZV9maWxsX2dyYWRpZW50Mihsb3cgPSAiZGFya3JlZCIsIG1pZCA9ICJ3aGl0ZSIsICBoaWdoID0gImRhcmtncmVlbiIsIG1pZHBvaW50ID0gMzA4OTIpDQpgYGANCg0KSW4gdGhlIGxhc3QgdHdvIGNodW5rLCB3ZSAqZmlsbGVkKiB0aGUgYmFycyB3aXRoIGNvbG9ycyAobm90ZSB0aGUgdXNlIG9mIGZ1bmN0aW9ucyB3aXRoIHRoZSBzdHJpbmcgYF9maWxsX2ApLiBXaGVuIGFzc2lnbmluZyBjb2xvciB0byBwb2ludCBvciBsaW5lIHN5bWJvbHMsIHVzZSB0aGUgZnVuY3Rpb24gd2l0aCB0aGUgYF9jb2xvdXJfYCBzdHJpbmcuIEZvciBleGFtcGxlOg0KDQpgYGB7ciwgIGV2YWw9VH0NCmdncGxvdChkYXQyLmN0MiwgYWVzKHkgPSBmY3RfcmVvcmRlcihTdGF0ZSwgQ291bnRpZXMpLCB4ID0gQ291bnRpZXMsIGNvbCA9IEluY29tZSkpICsNCiAgIGdlb21fcG9pbnQoKSArDQogICBzY2FsZV9jb2xvdXJfZ3JhZGllbnQyKGxvdyA9ICJkYXJrcmVkIiwgbWlkID0gIndoaXRlIiwgIGhpZ2ggPSAiZGFya2dyZWVuIiwgbWlkcG9pbnQgPSAzMDg5MikNCmBgYA0KDQojIyMjIERpc2NyZXRlIGNvbG9yIHNjaGVtZXMNCg0KSW4gdGhlIGZvbGxvd2luZyBjaHVuaywgd2UgYXNzaWduIGNvbG9ycyBtYW51YWxseSB0byBlYWNoIGxldmVsIGluIHRoZSB2YXJpYWJsZSBgWWllbGRgLiBUaGUgb3JkZXIgb2YgdGhlIGNvbG9yIG5hbWVzIG1pcnJvciB0aGUgb3JkZXIgb2YgdGhlIHZhcmlhYmxlIGxldmVscy4NCg0KYGBge3IsICBldmFsPVR9DQpnZ3Bsb3QoZGF0MWwsIGFlcyhZZWFyLCBZaWVsZCwgY29sID0gQ3JvcCkpICsgDQogICAgICAgZ2VvbV9saW5lKCkgKw0KICAgICAgIHNjYWxlX2NvbG91cl9tYW51YWwodmFsdWVzID0gYygicmVkIiwgIm9yYW5nZSIsICJncmVlbiIsICJibHVlIiwgInllbGxvdyIpKQ0KYGBgDQoNClRoZSBmb2xsb3dpbmcgY2h1bmsgYXBwbGllcyBhIHByZWRlZmluZWQgZGlzY3JldGUgY29sb3Igc2NoZW1lIHVzaW5nIG9uZSBvZiBCcmV3ZXLigJlzIHByZXNldCBxdWFsaXRhdGl2ZSBjb2xvcnMsIHBhbGV0dGUgYERhcmsyYCwgdG8gZWFjaCBsZXZlbC4NCg0KYGBge3IsICBldmFsPVR9DQpnZ3Bsb3QoZGF0MWwsIGFlcyhZZWFyLCBZaWVsZCwgY29sID0gQ3JvcCkpICsgDQogICAgICAgICAgICAgIGdlb21fbGluZSgpICsNCiAgICAgICAgICAgICAgc2NhbGVfY29sb3VyX2JyZXdlcihwYWxldHRlID0gIkRhcmsyIikNCmBgYA0KDQpZb3UgY2FuIGFsc28gYXBwbHkgc2VxdWVudGlhbCBvciBkaXZlcmdlbnQgIkJyZXdlciIgY29sb3Igc2NoZW1lcyB0byB2YXJpYWJsZXMgaGF2aW5nIGFuIGltcGxpZWQgb3JkZXIuDQoNCkxldOKAmXMgYXNzdW1lIHRoYXQgdGhlcmUgaXMgYW4gaW1wbGllZCBvcmRlciB0byB0aGUgY3JvcCB0eXBlcy4gRm9yIGV4YW1wbGUsIHdl4oCZbGwgcmVvcmRlciB0aGUgY3JvcCB0eXBlcyBiYXNlZCBvbiB0aGVpciBtZWRpYW4geWllbGQgKHRoaXMgY3JlYXRlcyBhbiBvcmRlcmVkIGZhY3RvciBmcm9tIHRoZSBgQ3JvcGAgdmFyaWFibGUpLiBXZSBjYW4gdGhlbiB1c2Ugb25lIG9mIEJyZXdlcuKAmXMgc2VxdWVudGlhbCBjb2xvciBzY2hlbWVzIHN1Y2ggYXMgYFJlZHNgLg0KDQpgYGB7ciwgIGV2YWw9VH0NCmdncGxvdChkYXQxbCwgYWVzKFllYXIsIFlpZWxkLCBjb2wgPSByZW9yZGVyKENyb3AsIFlpZWxkLCBtZWRpYW4pKSkgKyANCiAgICAgICAgICAgICAgZ2VvbV9saW5lKCkgKw0KICAgICAgICAgICAgICBndWlkZXMoY29sb3VyID0gZ3VpZGVfbGVnZW5kKHRpdGxlID0gIkNyb3BzIikpICsgIA0KICAgICAgICAgICAgICBzY2FsZV9jb2xvdXJfYnJld2VyKHBhbGV0dGUgPSAiUmVkcyIpIA0KYGBgDQoNCk5vdGUgdGhhdCB3ZeKAmXZlIGFkZGVkIGEgYGd1aWRlc2AgZnVuY3Rpb24gdG8gcmVuYW1lIHRoZSBsZWdlbmQgdGl0bGUuIFRoaXMgaXMgbm90IG5lZWRlZCB0byBnZW5lcmF0ZSB0aGUgc2VxdWVudGlhbCBjb2xvcnMuDQoNClRvIHJldmVyc2UgdGhlIGNvbG9yIHNjaGVtZSwgc2V0IHRoZSBgZGlyZWN0aW9uYCBhcmd1bWVudCB0byBgLTFgIGluIHRoZSBmdW5jdGlvbiBgc2NhbGVfY29sb3VyX2JyZXdlcmANCg0KWW91IGNhbiB2aWV3IGEgbGlzdCBvZiBwcmVkaWZpbmVkIEJyZXdlciBjb2xvciBzY2hlbWVzIHVzaW5nIGBSQ29sb3JCcmV3ZXI6OmRpc3BsYXkuYnJld2VyLmFsbCgpYC4NCg0KIyMjIEFkZGluZyBtYXRoZW1hdGljYWwgc3ltYm9scyB0byBhIHBsb3QNCg0KWW91IGNhbiBlbWJlZCBtYXRoIHN5bWJvbHMgdXNpbmcgYHBsb3RtYXRoYOKAmXMgbWF0aGVtYXRpY2FsIGV4cHJlc3Npb25zIGJ5IHdyYXBwaW5nIHRoZXNlIGV4cHJlc3Npb25zIGluIGFuIGBleHByZXNzaW9uYCBmdW5jdGlvbi4gRm9yIGV4YW1wbGU6DQoNCmBgYHtyLCAgZXZhbD1UfQ0KZ2dwbG90KGRhdDIsIGFlcyh4ID0gQjIwMDA0MDEzXjAuMzMzLCB5ID0gc3FydChCMjAwMDQwMDcpKSkgKyBnZW9tX3BvaW50KGFscGhhID0gMC4zKSArDQogICAgICAgeGxhYiggZXhwcmVzc2lvbigoIkZlbWFsZSBpbmNvbWUiKSBeIGZyYWMoMSwzKSkpICsgDQogICAgICAgeWxhYiggZXhwcmVzc2lvbihzcXJ0KCJNYWxlIGluY29tZSIpKSkNCmBgYA0KDQpUbyB2aWV3IHRoZSBmdWxsIGxpc3Qgb2YgbWF0aGVtYXRpY2FsIGV4cHJlc3Npb25zLCBjYWxsIGZvciBoZWxwIGA/cGxvdG1hdGhgLg0KDQojIyBGYWNldGluZw0KDQpUaGUgZnVuY3Rpb25hbGl0eSBvZiB0aGUgYGxhdHRpY2VgIHBhY2thZ2UgYXJlIGFsc28gYXZhaWxhYmxlIGluIGBnZ3Bsb3QyYC4gSXQgaXMgY2FsbGVkICpmYWNldGluZyoNCg0KIyMjIEZhY2V0aW5nIGJ5IGNhdGVnb3JpY2FsIHZhcmlhYmxlcw0KDQojIyMjIGBmYWNldF93cmFwYA0KDQpGYWNldGluZyAob3IgY29uZGl0aW9uaW5nIG9uIGEgdmFyaWFibGUpIGNhbiBiZSBpbXBsZW1lbnRlZCBpbiBgZ2dwbG90MmAgdXNpbmcgdGhlIGBmYWNldF93cmFwYCBmdW5jdGlvbi4NCg0KYGBge3IsICBldmFsPVR9DQpnZ3Bsb3QoZGF0MWwyLCBhZXMoeCA9IFllYXIsIHkgPSBZaWVsZCwgY29sb3IgPSBDcm9wKSkgKyBnZW9tX2xpbmUoKSArIA0KICAgICAgIGZhY2V0X3dyYXAoIH4gQ291bnRyeSwgbnJvdyA9IDEpDQpgYGANCg0KVGhlIHBhcmFtZXRlciBgfiBDb3VudHJ5YCB0ZWxscyBnZ3Bsb3QgdG8gY29uZGl0aW9uIHRoZSBwbG90cyBvbiBjb3VudHJ5LiBJZiB3ZSB3YW50ZWQgdGhlIHBsb3RzIHRvIGJlIHN0YWNrZWQsIHdlIHdvdWxkIHNldCBgbnJvd2AgdG8gYDJgLg0KDQpXZSBjYW4gYWxzbyBjb25kaXRpb24gdGhlIHBsb3RzIG9uIHR3byB2YXJpYWJsZXMgc3VjaCBhcyBgQ3JvcGAgYW5kIGBDb3VudHJ5YC4gSW4gZXNzZW5jZSwgdGhpcyBzdGFja3MgdGhlIGNhdGVnb3JpZXMgKE5vdGUgdGhhdCB3ZSB3aWxsIGFsc28gcm90YXRlIHRoZSB4LWF4aXMgbGFiZWxzIHRvIHByZXZlbnQgb3ZlcmxhcHMpLg0KDQpgYGB7ciwgIGV2YWw9VH0NCmdncGxvdChkYXQxbDIsIGFlcyh4ID0gWWVhciwgeT1ZaWVsZCkpICsgZ2VvbV9saW5lKCkgKw0KICAgIHRoZW1lKGF4aXMudGV4dC54ID0gZWxlbWVudF90ZXh0KGFuZ2xlID0gOTAsIHZqdXN0ID0gMC41LCBoanVzdCA9IDEpKSArDQogICAgZmFjZXRfd3JhcChDcm9wIH4gQ291bnRyeSwgbnJvdyA9IDEpDQpgYGANCg0KWW91IGNhbiB3cmFwIHRoZSBmYWNldCBoZWFkZXJzIHVzaW5nIHRoZSBgbGFiZWxfd3JhcF9nZW5gIGZ1bmN0aW9uIGFzIGFuIGFyZ3VtZW50IHZhbHVlIHRvIGBsYWJlbGVyYC4gRm9yIGV4YW1wbGUsIHRvIHdyYXAgdGhlIGBVbml0ZWQgU3RhdGVzIG9mIEFtZXJpY2FgIHZhbHVlLCB3ZeKAmWxsIHNwZWNpZnkgdGhlIG1heGltdW0gbnVtYmVyIG9mIGNoYXJhY3RlcnMgcGVyIGxpbmUgdXNpbmcgdGhlIGB3aWR0aGAgYXJndW1lbnQ6DQoNCmBgYHtyLCAgZXZhbD1UfQ0KZ2dwbG90KGRhdDFsMiwgYWVzKHggPSBZZWFyLCB5PVlpZWxkKSkgKyBnZW9tX2xpbmUoKSArDQogIHRoZW1lKGF4aXMudGV4dC54ID0gZWxlbWVudF90ZXh0KGFuZ2xlID0gOTAsIHZqdXN0ID0gMC41LCBoanVzdCA9IDEpKSArDQogIGZhY2V0X3dyYXAoQ3JvcCB+IENvdW50cnksIG5yb3cgPSAxLCBsYWJlbGxlciA9IGxhYmVsX3dyYXBfZ2VuKHdpZHRoID0gMTIpKQ0KYGBgDQoNCg0KIyMjIyBgZmFjZXRfZ3JpZGANCg0KVGhlIGFib3ZlIGBmYWNldF93cmFwYCBleGFtcGxlIGdlbmVyYXRlZCB1bmlxdWUgY29tYmluYXRpb25zIG9mIHRoZSB2YXJpYWJsZXMgYENyb3BgIGFuZCBgQ291bnRyeWAuIEJ1dCBzdWNoIHBsb3RzIGFyZSB1c3VhbGx5IGJlc3QgcmVwcmVzZW50ZWQgaW4gYSBncmlkIHN0cnVjdHVyZSB3aGVyZSBvbmUgdmFyaWFibGUgaXMgc3ByZWFkIGFsb25nIG9uZSBheGlzIGFuZCB0aGUgb3RoZXIgdmFyaWFibGUgaXMgc3ByZWFkIGFsb25nIGFub3RoZXIgYXhpcyBvZiB0aGUgcGxvdCBsYXlvdXQuIFRoaXMgY2FuIGJlIGFjY29tcGxpc2hlZCB1c2luZyB0aGUgYGZhY2V0X2dyaWRgIGZ1bmN0aW9uOg0KDQpgYGB7ciwgIGV2YWw9VH0NCmdncGxvdChkYXQxbDIsIGFlcyh4ID0gWWVhciwgeSA9IFlpZWxkKSkgKyBnZW9tX2xpbmUoKSArIA0KICAgICAgIGZhY2V0X2dyaWQoIENyb3AgfiBDb3VudHJ5KQ0KYGBgDQogDQojIyMgRmFjZXRpbmcgYnkgY29udGlub3VzIHZhcmlhYmxlcyAoYWR2YW5jZSkNCg0KSW4gdGhlIGFib3ZlIGV4YW1wbGVzLCB3ZSBhcmUgZmFjZXRpbmcgdGhlIHBsb3RzIGJhc2VkIG9uIGEgY2F0ZWdvcmljYWwgdmFyaWFibGU6IGBDb3VudHJ5YCBhbmQvb3IgYGNyb3BgLiBCdXQgd2hhdCBpZiB3ZSB3YW50IHRvIGZhY2V0IHRoZSBwbG90cyBiYXNlZCBvbiBhIGNvbnRpbnVvdXMgdmFyaWFibGU/IEZvciBleGFtcGxlLCB3ZSBtaWdodCBiZSBpbnRlcmVzdGVkIGluIGNvbXBhcmluZyBtYWxlIGFuZCBmZW1hbGUgaW5jb21lcyBhY3Jvc3MgZGlmZmVyZW50IGZlbWFsZSBpbmNvbWUgcmFuZ2VzLiBUaGlzIHJlcXVpcmVzIHRoYXQgYSBuZXcgY2F0ZWdvcmljYWwgZmllbGQgKGEgZmFjdG9yKSBiZSBjcmVhdGVkIGFzc2lnbmluZyB0byBlYWNoIGNhc2UgKHJvdykgYW4gaW5jb21lIGdyb3VwLiBXZSBjYW4gdXNlIHRoZSBgY3V0YCBmdW5jdGlvbiB0byBhY2NvbXBsaXNoIHRoaXMgdGFzayAod2XigJlsbCBhbHNvIG9taXQgYWxsIHZhbHVlcyBncmVhdGVyIHRoYW4gMTAwLDAwMCk6DQoNCmBgYHtyLCAgZXZhbD1UfQ0KZGF0MmMkaW5jcm5nIDwtIGN1dChkYXQyYyRGICwgYnJlYWtzID0gYygwLCAyNTAwMCwgNTAwMDAsIDc1MDAwLCAxMDAwMDApICkNCmBgYA0KDQpJbiB0aGlzIGNodW5rIG9mIGNvZGUsIHdlIGNyZWF0ZSBhIG5ldyB2YXJpYWJsZSwgYGluY3JuZ2AsIHdoaWNoIGlzIGFzc2lnbmVkIGFuIGluY29tZSBjYXRlZ29yeSBncm91cCBkZXBlbmRpbmcgb24gd2hpY2ggcmFuZ2UgYGRhdDJjJEZgIChmZW1hbGUgaW5jb21lKSBmYWxscyBpbnRvLiBUaGUgaW5jb21lIGludGVydmFsIGJyZWFrcyBhcmUgZGVmaW5lZCBpbiBgYnJlYWtzPWAuIEluIHRoZSBvdXRwdXQsIHlvdSB3aWxsIG5vdGUgdGhhdCB0aGUgZmFjdG9yIGBpbmNybmdgIGRlZmluZXMgYSByYW5nZSBvZiBpbmNvbWVzIChlLmcuIChgMGAgLCBgMi41ZSswNGBdKSB3aGVyZSB0aGUgcGFyZW50aGVzaXMgYChgIGluZGljYXRlcyB0aGF0IHRoZSBsZWZ0LW1vc3QgdmFsdWUgaXMgZXhjbHVzaXZlIGFuZCB0aGUgYnJhY2tldCBgXWAgaW5kaWNhdGVzIHRoYXQgdGhlIHJpZ2h0LW1vc3QgdmFsdWUgaXMgaW5jbHVzaXZlLg0KDQpIb3dldmVyLCBiZWNhdXNlIHdlIGRpZCBub3QgY3JlYXRlIGNhdGVnb3JpZXMgdGhhdCBjb3ZlcmVkIGFsbCBpbmNvbWUgdmFsdWVzIGluIGBkYXQyYyRGYCB3ZSBlbmRlZCB1cCB3aXRoIGEgZmV3IGBOQWDigJlzIGluIHRoZSBgaW5jcm5nYCBjb2x1bW46DQoNCmBgYHtyLCAgZXZhbD1UfQ0Kc3VtbWFyeShkYXQyYyRpbmNybmcpDQpgYGANCg0KV2Ugd2lsbCByZW1vdmUgYWxsIHJvd3MgYXNzb2NpYXRlZCB3aXRoIG1pc3NpbmcgYGluY3JuZ2AgdmFsdWVzOg0KDQpgYGB7ciwgIGV2YWw9VH0NCmRhdDJjIDwtIG5hLm9taXQoZGF0MmMpDQpgYGANCg0KV2UgY2FuIGxpc3QgYWxsIHVuaXF1ZSBsZXZlbHMgaW4gb3VyIG5ld2x5IGNyZWF0ZWQgZmFjdG9yIHVzaW5nIHRoZSBsZXZlbHMoKSBmdW5jdGlvbi4NCg0KYGBge3IsICBldmFsPVR9DQpsZXZlbHMoZGF0MmMkaW5jcm5nKSANCmBgYA0KDQpUaGUgaW50ZXJ2YWxzIGFyZSBub3QgbWVhbmluZ2Z1bCBkaXNwbGF5ZWQgYXMgaXMgKHBhcnRpY3VsYXJseSB3aGVuIHNjaWVudGlmaWMgbm90YXRpb24gaXMgYWRvcHRlZCkuIFNvIHdlIHdpbGwgYXNzaWduIG1vcmUgbWVhbmluZ2Z1bCBuYW1lcyB0byBvdXIgZmFjdG9yIGxldmVscyBhcyBmb2xsb3dzOg0KDQpgYGB7ciwgIGV2YWw9VH0NCmxldmVscyhkYXQyYyRpbmNybmcpIDwtICBjKCJVbmRlciAyNWsiLCAiMjVrLTUwayIsICI1MGstNzVrIiwgIjc1ay0xMDBrIikNCmhlYWQoZGF0MmMpDQpgYGANCg0KTm90ZSB0aGF0IHRoZSBvcmRlciBpbiB3aGljaCB0aGUgbmFtZXMgYXJlIHBhc3NlZCBtdXN0IG1hdGNoIHRoYXQgb2YgdGhlIG9yaWdpbmFsIGJyZWFrcy4NCg0KTm93IHdlIGNhbiBmYWNldCBtYWxlIHZzLiBmZW1hbGUgc2NhdHRlciBwbG90cyBieSBpbmNvbWUgcmFuZ2VzLiBXZSB3aWxsIGFsc28gdGhyb3cgaW4gYSBiZXN0IGZpdCBsaW5lIHRvIHRoZSBwbG90cy4NCg0KDQpgYGB7ciwgIGV2YWw9VH0NCmdncGxvdChkYXQyYywgYWVzKHggPSBGLCB5ID0gTSkpICsgZ2VvbV9wb2ludChhbHBoYT0wLjIsIHBjaD0yMCkgKw0KICAgICAgIGdlb21fc21vb3RoKG1ldGhvZCA9ICJsbSIsIGNvbCA9ICJyZWQiKSArDQogICAgICAgZmFjZXRfZ3JpZCggLiB+IGluY3JuZykgDQpgYGANCg0KT25lIHJlYXNvbiB3ZSB3b3VsZCB3YW50IHRvIGV4cGxvcmUgb3VyIGRhdGEgYWNyb3NzIGRpZmZlcmVudCByYW5nZXMgb2YgdmFsdWUgaXMgdG8gYXNzZXNzIHRoZSBjb25zaXN0ZW5jeSBpbiByZWxhdGlvbnNoaXAgYmV0d2VlbiB2YXJpYWJsZXMuIEluIG91ciBleGFtcGxlLCB0aGlzIHBsb3QgaGVscHMgYXNzZXNzIHdoZXRoZXIgdGhlIHJlbGF0aW9uc2hpcCBiZXR3ZWVuIG1hbGUgYW5kIGZlbWFsZSBpbmNvbWUgaXMgY29uc2lzdGVudCBhY3Jvc3MgaW5jb21lIGdyb3Vwcy4NCg0KIyMgRXhwb3J0aW5nIHRvIGFuIGltYWdlDQoNCnlvdSBjYW4gZXhwb3J0IGEgZ2dwbG90IGZpZ3VyZSB0byBhbiBpbWFnZSB1c2luZyB0aGUgYGdnc2F2ZWAgZnVuY3Rpb24uIEZvciBleGFtcGxlOg0KDQpgYGB7ciwgIGV2YWw9VH0NCnAxIDwtIGdncGxvdChkYXQxbDIsIGFlcyh4ID0gWWVhciwgeSA9IFlpZWxkLCBjb2xvciA9IENyb3ApKSArIGdlb21fbGluZSgpICsgDQogIGZhY2V0X3dyYXAoIH4gQ291bnRyeSwgbnJvdyA9IDEpICsNCiAgc2NhbGVfeV9jb250aW51b3VzKGxhYmVscyA9IHNjYWxlczo6Y29tbWFfZm9ybWF0KCkpDQoNCmdnc2F2ZSgiRmlndXJlcy9maWcwLnBuZyIsIHBsb3QgPSBwMSwgd2lkdGggPSA2LCBoZWlnaHQgPSAyLCB1bml0cyA9ICJpbiIsIGRldmljZSA9ICJwbmciKQ0KYGBgDQoNCg0KIVtdKEZpZ3VyZXMvZmlnMC5wbmcpDQoNClRoZSB3aWR0aCBhbmQgaGVpZ2h0IGFyZ3VtZW50cyBhcmUgZGVmaW5lZCBpbiB1bml0cyBvZiBpbmNoZXMsIGBpbmAuIFlvdSBjYW4gYWxzbyBzcGVjaWZ5IHRoZXNlIHBhcmFtZXRlcnMgaW4gdW5pdHMgb2YgY2VudGltZXRlcnMgYnkgc2V0dGluZyB1bml0cyBgPSAiY20iYC4gVGhlIGBkZXZpY2VgIGFyZ3VtZW50IGNvbnRyb2xzIHRoZSBpbWFnZSBmaWxlIHR5cGUuIE90aGVyIGZpbGUgdHlwZXMgaW5jbHVkZSBgImpwZWciYCwgYCJ0aWZmImAsIGAiYm1wImAgYW5kIGAic3ZnImAganVzdCB0byBuYW1lIGEgZmV3Lg0KDQpGb3IgZ3JlYXRlciBjb250cm9sIG9mIHRoZSBmb250IHNpemVzLCB5b3UgbmVlZCB0byBtYWtlIHVzZSBvZiB0aGUgYHRoZW1lYCBmdW5jdGlvbiB3aGVuIGJ1aWRpbmcgdGhlIHBsb3QuDQoNCmBgYHtyLCAgZXZhbD1UfQ0KcDIgPC0gZ2dwbG90KGRhdDFsMiwgYWVzKHggPSBZZWFyLCB5ID0gWWllbGQsIGNvbG9yID0gQ3JvcCkpICsgZ2VvbV9saW5lKCkgKyANCiAgZmFjZXRfd3JhcCggfiBDb3VudHJ5LCBucm93ID0gMSkgKw0KICBzY2FsZV95X2NvbnRpbnVvdXMobGFiZWxzID0gc2NhbGVzOjpjb21tYV9mb3JtYXQoKSkgKw0KICB0aGVtZShheGlzLnRleHQgICAgPSBlbGVtZW50X3RleHQoc2l6ZSA9IDgsIGZhbWlseSA9ICJtb25vIiksDQogICAgICAgIGF4aXMudGl0bGUgICA9IGVsZW1lbnRfdGV4dChzaXplID0gMTEsIGZhY2UgPSAiYm9sZCIpLA0KICAgICAgICBzdHJpcC50ZXh0ICAgPSBlbGVtZW50X3RleHQoc2l6ZSA9IDExLCBmYWNlPSJpdGFsaWMiLCBmYW1pbHkgPSAic2VyaWYiKSwNCiAgICAgICAgbGVnZW5kLnRpdGxlID0gZWxlbWVudF90ZXh0KHNpemUgPSAxMCwgZmFtaWx5ID0gInNhbnMiKSwNCiAgICAgICAgbGVnZW5kLnRleHQgID0gZWxlbWVudF90ZXh0KHNpemUgPSA4LCAgY29sb3IgPSAiZ3JleTQwIikpDQoNCmdnc2F2ZSgiRmlndXJlcy9maWcxLnBuZyIsIHBsb3QgPSBwMiwgd2lkdGggPSA2LCBoZWlnaHQgPSAyLCB1bml0cyA9ICJpbiIpDQpgYGANCg0KIVtdKEZpZ3VyZXMvZmlnMS5wbmcpDQoNCg0KVGhlIGBmYW1pbHlgIGFyZ3VtZW50IGNvbnRyb2xzIHRoZSBmb250IHR5cGUuIEl0IGRvZXMgbm90IGF1dG9tYXRpY2FsbHkgYWNjZXNzIGFsbCB0aGUgZm9udHMgaW4geW91ciBvcGVyYXRpbmcgc3lzdGVtLiBUaGUgdGhyZWUgUiBmb250cyBhY2Nlc3NpYmxlIGJ5IGRlZmF1bHQgYXJlICJgc2VyaWZgIiwgImBzYW5zYCIgYW5kICJgbW9ub2AiLiBUaGVzZSBhcmUgdXN1YWxseSBtYXBwZWQgdG8geW91ciBzeXN0ZW3igJlzIGZvbnRzLg0KDQpUbyBhY2Nlc3Mgb3RoZXIgZm9udHMgb24geW91ciBvcGVyYXRpbmcgc3lzdGVtLCB5b3Ugd2lsbCBuZWVkIHRvIG1ha2UgdXNlIG9mIHRoZSBgc2hvd3RleHRgIHBhY2thZ2UuIFRoZSBwYWNrYWdlIGlzIG5vdCBjb3ZlcmVkIGluIHRoaXMgdHV0b3JpYWwsIGluc3RlYWQsIHJlZmVyIHRvIHRoZSBwYWNrYWdl4oCZcyB3ZWJzaXRlIGZvciBpbnN0cnVjdGlvbnMgb24gdXNpbmcgdGhlIHBhY2thZ2UuDQoNCg==" download="graphics.Rmd">Download graphics.Rmd</a></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><a href="data:text/plain;base64,cGxvdChpcmlzJFBldGFsLkxlbmd0aCkgIyBpbmRleCBvYnNlcnZhdGlvbiBmb3IgUGV0YWwuTGVuZ3RoDQpwbG90KGlyaXMkUGV0YWwuV2lkdGgpICMgaW5kZXggb2JzZXJ2YXRpb24gZm9yIFBldGFsLldpZHRoDQoNCnBsb3QoUGV0YWwuTGVuZ3RoIH4gUGV0YWwuV2lkdGgsIGRhdGEgPSBpcmlzKSAjIHBhaXJ3aXNlDQoNCnBsb3QoaXJpcyRQZXRhbC5MZW5ndGggfiBpcmlzJFBldGFsLldpZHRoKSAjIHVzaW5nIHRoZSAkIG9wZXJhdG9yDQoNCiMgYWRkIGxhYmVscyB0byB4LSBhbmQgeS1heGVzLCB0aXRsZSANCnBsb3QoUGV0YWwuTGVuZ3RoIH4gUGV0YWwuV2lkdGgsIGRhdGEgPSBpcmlzLA0KICAgICB4bGFiID0gJ1BldGFsIHdpZHRoIChjbSknLCANCiAgICAgeWxhYiA9ICdQZXRhbCBsZW5ndGggKGNtKScsDQogICAgIG1haW4gPSAnUGV0YWwgd2lkdGggJiBsZW5ndGggb2YgaXJpcyBmbG93ZXInKSANCg0KcGxvdChQZXRhbC5MZW5ndGggfiBQZXRhbC5XaWR0aCwgZGF0YSA9IGlyaXMsDQogICAgIHhsYWIgPSAnUGV0YWwgd2lkdGggKGNtKScsIA0KICAgICB5bGFiID0gJ1BldGFsIGxlbmd0aCAoY20pJywgDQogICAgIG1haW4gPSAnUGV0YWwgd2lkdGggYW5kIGxlbmd0aCBvZiBpcmlzIGZsb3dlcicsDQogICAgIHBjaCA9IDE5LCBjZXg9MiwgDQogICAgIGNvbCA9IHJnYiAoMSwwLDAsMC4xMCkpDQoNCiMgY3JlYXRlIGEgdmVjdG9yIG9mIGNoYXJhY3RlciB3aXRoIGNvbG9yIG5hbWVzDQpjb2wuaXJpczwtaWZlbHNlKGlyaXMkU3BlY2llcz09J3NldG9zYScsJ3B1cnBsZScsaWZlbHNlKGlyaXMkU3BlY2llcz09J3ZlcnNpY29sb3InLCdibHVlJywncGluaycpKSANCmNvbC5pcmlzDQoNCmxpYnJhcnkoc2NhbGVzKQ0KcGxvdChQZXRhbC5MZW5ndGggfiBQZXRhbC5XaWR0aCwgZGF0YSA9IGlyaXMsDQogICAgIHhsYWIgPSAnUGV0YWwgd2lkdGggKGNtKScsIA0KICAgICB5bGFiID0gJ1BldGFsIGxlbmd0aCAoY20pJywgDQogICAgIG1haW4gPSAnUGV0YWwgd2lkdGggYW5kIGxlbmd0aCBvZiBpcmlzIGZsb3dlcicsDQogICAgIHBjaCA9IDE5LCBjZXg9MiwgDQogICAgIGNvbCA9IGFscGhhKGNvbC5pcmlzLCAwLjIpKQ0KDQpwbG90KFBldGFsLkxlbmd0aCB+IFBldGFsLldpZHRoLCBkYXQgPSBpcmlzLA0KICAgICB4bGFiID0gJ1BldGFsIHdpZHRoIChjbSknLCANCiAgICAgeWxhYiA9ICdQZXRhbCBsZW5ndGggKGNtKScsIA0KICAgICBtYWluID0gJ1BldGFsIHdpZHRoIGFuZCBsZW5ndGggb2YgaXJpcyBmbG93ZXInLA0KICAgICBwY2ggPSAxOSwgY2V4PTIsIA0KICAgICBjb2wgPSBhbHBoYShjb2wuaXJpcywgMC4yKSkNCg0KbGVnZW5kKHg9ImJvdHRvbXJpZ2h0IiwgcGNoPSAxOSwgY2V4PTEuNSwgbGVnZW5kPSBjKCJ2ZXJzaWNvbG9yIiwic2V0b3NhIiwgInZpcmdpbmljYSIpLCBjb2w9bGV2ZWxzKGFzLmZhY3RvcihhbHBoYShjb2wuaXJpcywgMC4yKSkpKQ0KICAgIA0KDQpwbG90KFBldGFsLkxlbmd0aCB+IFBldGFsLldpZHRoLCBkYXQgPSBpcmlzLA0KICAgICB4bGFiID0gJ1BldGFsIHdpZHRoIChjbSknLCANCiAgICAgeWxhYiA9ICdQZXRhbCBsZW5ndGggKGNtKScsIA0KICAgICBtYWluID0gJ1BldGFsIHdpZHRoIGFuZCBsZW5ndGggb2YgaXJpcyBmbG93ZXInLA0KICAgICBwY2ggPSAxOSwgY2V4PTIsIGxhcz0xLA0KICAgICBjb2wgPSBhbHBoYShjb2wuaXJpcywgMC4yKSkgDQoNCmxlZ2VuZCh4PSJib3R0b21yaWdodCIsIHBjaD0gMTksIGNleD0xLjUsIGxlZ2VuZD0gYygidmVyc2ljb2xvciIsInNldG9zYSIsICJ2aXJnaW5pY2EiKSwgY29sPWxldmVscyhhcy5mYWN0b3IoYWxwaGEoY29sLmlyaXMsIDAuMikpKSkNCg0KcGxvdChQZXRhbC5MZW5ndGggfiBQZXRhbC5XaWR0aCwgZGF0ID0gaXJpcywNCiAgICAgeGxhYiA9ICdQZXRhbCB3aWR0aCAoY20pJywgDQogICAgIHlsYWIgPSAnUGV0YWwgbGVuZ3RoIChjbSknLCANCiAgICAgbWFpbiA9ICdQZXRhbCB3aWR0aCBhbmQgbGVuZ3RoIG9mIGlyaXMgZmxvd2VyJywNCiAgICAgY2V4LmF4aXM9MS4wLCBjZXgubGFiPTEuNSwgY2V4Lm1haW49MS41LA0KICAgICBwY2ggPSAxOSwgY2V4PTIsIGxhcz0xLA0KICAgICBjb2wgPSBhbHBoYShjb2wuaXJpcywgMC4yKSkNCg0KbGVnZW5kKHg9ImJvdHRvbXJpZ2h0IiwgcGNoPSAxOSwgY2V4PTEuNSwgbGVnZW5kPSBjKCJ2ZXJzaWNvbG9yIiwic2V0b3NhIiwgInZpcmdpbmljYSIpLCBjb2w9bGV2ZWxzKGFzLmZhY3RvcihhbHBoYShjb2wuaXJpcywgMC4yKSkpKQ0KDQoNCnJhdGlvPC1pcmlzJFBldGFsLkxlbmd0aC9pcmlzJFNlcGFsLldpZHRoICAjIHJhdGlvIGJldHdlZW4gdGhlIGxlbmd0aCBvZiBwZXRhbCBhbmQgdGhlIHdpZHRoIG9mIFNlcGFsDQpwbG90KFBldGFsLkxlbmd0aCB+IFBldGFsLldpZHRoLCBkYXQgPSBpcmlzLA0KICAgICB4bGFiID0gJ1BldGFsIHdpZHRoIChjbSknLCANCiAgICAgeWxhYiA9ICdQZXRhbCBsZW5ndGggKGNtKScsIA0KICAgICBtYWluID0gJ1BldGFsIHdpZHRoIGFuZCBsZW5ndGggb2YgaXJpcyBmbG93ZXInLA0KICAgICBjZXguYXhpcz0xLjAsIGNleC5sYWI9MS41LCBjZXgubWFpbj0xLjUsDQogICAgIHBjaCA9IDE5LCBsYXM9MSwgY2V4PSByYXRpbyAqIDIsIA0KICAgICBjb2wgPSBhbHBoYShjb2wuaXJpcywgMC4yKSkNCg0KbGVnZW5kKHg9ImJvdHRvbXJpZ2h0IiwgcGNoPSAxOSwgY2V4PTEuNSwgbGVnZW5kPSBjKCJ2ZXJzaWNvbG9yIiwic2V0b3NhIiwgInZpcmdpbmljYSIpLCBjb2w9bGV2ZWxzKGFzLmZhY3RvcihhbHBoYShjb2wuaXJpcywgMC4yKSkpKQ0KDQpwYWlycyhpcmlzWzE6NF0sIHBjaD0xOSwgY29sID0gYWxwaGEoY29sLmlyaXMsIDAuMikpDQoNCiMgZ2VuZXJhdGUgYSBkYXRhIGZyYW1lIHdpdGggY2hyb25vbG9naWNhbCB2YXJpYWJsZQ0KYmxvc3NvbTwtTlVMTA0KYmxvc3NvbSR5ZWFyIDwtIDIwMTA6MjAxOSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyANCmJsb3Nzb20kY291bnQuYWxhc2thIDwtIGMoMywgMSwgNSwgMiwgMywgOCwgNCwgNywgNiwgOSkNCmJsb3Nzb20kY291bnQuY2FuYWRhIDwtIGMoNCwgNiwgNSwgNywgMTAsIDgsIDEwLCAxMSwgMTUsIDE3KQ0KYXMuZGF0YS5mcmFtZShibG9zc29tKQ0KcGxvdChjb3VudC5hbGFza2EgfiB5ZWFyLGRhdCA9IGJsb3Nzb20sIHR5cGU9J2wnLA0KICAgICAgeWxhYiA9ICJOby4gb2YgZmxvd2VyIGJsb3Nzb21pbmciKSANCg0KcGxvdChjb3VudC5hbGFza2EgfiB5ZWFyLGRhdCA9IGJsb3Nzb20sIHR5cGU9J2InLCBwY2g9MjAsDQogICAgICB5bGFiID0gIk5vLiBvZiBmbG93ZXIgYmxvc3NvbWluZyIpIA0KDQpwbG90KGNvdW50LmFsYXNrYSB+IHllYXIsZGF0ID0gYmxvc3NvbSwgdHlwZT0nYicsIHBjaD0yMCwNCiAgICAgbHR5PTIsIGx3ZD0wLjUsIGNvbD0ncmVkJywNCiAgICAgeWxhYiA9ICJOby4gb2YgZmxvd2VyIGJsb3Nzb21pbmciKSANCg0KcGxvdChjb3VudC5hbGFza2EgfiB5ZWFyLGRhdCA9IGJsb3Nzb20sIHR5cGU9J2InLCBwY2g9MjAsDQogICAgIGx0eT0yLCBsd2Q9MC41LCBjb2w9J3JlZCcsDQogICAgIHlsYWIgPSAiTm8uIG9mIGZsb3dlciBibG9zc29taW5nIikgDQpsaW5lcyhjb3VudC5jYW5hZGEgfiB5ZWFyLGRhdCA9IGJsb3Nzb20sIHR5cGU9J2InLCBwY2g9MjAsDQogICAgIGx0eT0zLCBsd2Q9MC41LCBjb2w9J2JsdWUnKQ0KDQp5LnJuZzwtcmFuZ2UoYyhibG9zc29tJGNvdW50LmFsYXNrYSwgYmxvc3NvbSRjb3VudC5jYW5hZGEpKQ0KDQpwbG90KGNvdW50LmFsYXNrYSB+IHllYXIsZGF0ID0gYmxvc3NvbSwgdHlwZT0nbCcsIHlsaW0gPSB5LnJuZywNCiAgICAgbHR5PTIsIGx3ZD0xLCBjb2w9J3JlZCcsDQogICAgIHlsYWIgPSAiTm8uIG9mIGZsb3dlciBibG9zc29taW5nIikgDQpsaW5lcyhjb3VudC5jYW5hZGEgfiB5ZWFyLGRhdCA9IGJsb3Nzb20sDQogICAgIGx0eT0xLCBsd2Q9MSwgY29sPSdibHVlJykNCg0KaXJpcy52ZXI8LSBzdWJzZXQoaXJpcywgU3BlY2llcyA9PSAidmVyc2ljb2xvciIpDQppcmlzLnZpcjwtIHN1YnNldChpcmlzLCBTcGVjaWVzID09ICJ2aXJnaW5pY2EiKQ0KDQp5LnJuZyA8LSByYW5nZSggYyhpcmlzLnZlciRQZXRhbC5MZW5ndGgsIGlyaXMudmlyJFBldGFsLkxlbmd0aCkgLCBuYS5ybSA9IFRSVUUpIA0KeC5ybmcgPC0gcmFuZ2UoIGMoaXJpcy52ZXIkUGV0YWwuV2lkdGgsIGlyaXMudmlyJFBldGFsLndpZHRoKSAsIG5hLnJtID0gVFJVRSkgDQoNCiMgUGxvdCBhbiBlbXB0eSBwbG90DQoNCnBsb3QoUGV0YWwuTGVuZ3RoIH4gUGV0YWwuV2lkdGgsIGRhdCA9IGlyaXMudmVyLA0KICAgICB4bGFiID0gJ1BldGFsIHdpZHRoIChjbSknLCANCiAgICAgeWxhYiA9ICdQZXRhbCBsZW5ndGggKGNtKScsIA0KICAgICBtYWluID0gJ1BldGFsIHdpZHRoIGFuZCBsZW5ndGggb2YgaXJpcyBmbG93ZXInLA0KICAgICBjZXguYXhpcz0xLjAsIGNleC5sYWI9MS41LCBjZXgubWFpbj0xLjUsIHR5cGU9J24nLA0KICAgICB4bGltPXgucm5nLCAgeWxpbT15LnJuZykNCg0KIyBBZGQgcG9pbnRzIGZvciB2ZXJzaWNvbG9yDQpwb2ludHMoUGV0YWwuTGVuZ3RoIH4gUGV0YWwuV2lkdGgsIGRhdCA9IGlyaXMudmVyLCBwY2ggPSAyMCxjZXg9MiwgDQogICAgICAgY29sID0gcmdiKDAsMCwxLDAuMTApKQ0KICAgICAgIA0KIyBBZGQgcG9pbnRzIGZvciB2ZXJzaWNvbG9yDQpwb2ludHMoUGV0YWwuTGVuZ3RoIH4gUGV0YWwuV2lkdGgsIGRhdCA9IGlyaXMudmlyLCBwY2ggPSAyMCxjZXg9MiwgDQogICAgICBjb2wgPSAgYWxwaGEoJyNmYzAzYzYnLCAwLjIpKQ0KDQojIEFkZCBsZWdlbmQNCmxlZ2VuZCgidG9wbGVmdCIsIGMoInZlcnNpY29sb3IiLCAidmlyZ2luaWNhIiksIHBjaCA9IDE5LCBjZXg9MS4yLA0KICAgICAgIGNvbCA9IGMocmdiKDAsMCwxLDAuMTApLCBhbHBoYSgnI2ZjMDNjNicsIDAuMikpKQ0KDQpib3hwbG90KGlyaXMkU2VwYWwuV2lkdGgsIG5hLnJtID0gVFJVRSkNCg0KYm94cGxvdChpcmlzJFNlcGFsLldpZHRoLGlyaXMkU2VwYWwuTGVuZ3RoLCBpcmlzJFBldGFsLldpZHRoLGlyaXMkUGV0YWwuTGVuZ3RoLCBuYW1lcyA9IGMoIlNlcGFsLldpZHRoIiwgIlNlcGFsLkxlbmd0aCIsICJQZXRhbC5MZW5ndGgiLCJQZXRhbC5XaWR0aCIpLCBtYWluID0gIklyaXMgZmxvd2VyIHRyYWl0cyIpDQoNCmJveHBsb3QoaXJpcyRTZXBhbC5XaWR0aCxpcmlzJFNlcGFsLkxlbmd0aCwgaXJpcyRQZXRhbC5XaWR0aCxpcmlzJFBldGFsLkxlbmd0aCwgbmFtZXMgPSBjKCJTZXBhbC5XaWR0aCIsICJTZXBhbC5MZW5ndGgiLCAiUGV0YWwuTGVuZ3RoIiwiUGV0YWwuV2lkdGgiKSwgbWFpbiA9ICJJcmlzIGZsb3dlciB0cmFpdHMiLG91dGxpbmUgPSBGQUxTRSwgaG9yaXpvbnRhbCA9IFRSVUUgKQ0KDQpib3hwbG90KFNlcGFsLldpZHRoIH4gU3BlY2llcyxpcmlzKSANCg0KaXJpcyRTcGVjaWVzLm9yZCA8LSByZW9yZGVyKGlyaXMkU3BlY2llcyxpcmlzJFNlcGFsLldpZHRoLCBtZWRpYW4pDQpsZXZlbHMoaXJpcyRTcGVjaWVzLm9yZCkNCmJveHBsb3QoU2VwYWwuV2lkdGggfiBTcGVjaWVzLm9yZCwgaXJpcykNCg0KaGlzdChpcmlzJFNlcGFsLldpZHRoLCB4bGFiID0gIldpZHRoIG9mIFNlcGFsIiwgbWFpbiA9IE5BKQ0KDQpoaXN0KGlyaXMkU2VwYWwuV2lkdGgsIHhsYWIgPSAiV2lkdGggb2YgU2VwYWwiLCBtYWluID0gTkEsIGJyZWFrcz0xMCkNCg0KbiA8LSAxMCAgIyBEZWZpbmUgdGhlIG51bWJlciBvZiBiaW4NCm1pbnggPC0gbWluKGlyaXMkU2VwYWwuV2lkdGgsIG5hLnJtID0gVFJVRSkNCm1heHggPC0gbWF4KGlyaXMkU2VwYWwuV2lkdGgsIG5hLnJtID0gVFJVRSkNCmJpbnMgPC0gc2VxKG1pbngsIG1heHgsIGxlbmd0aC5vdXQgPSBuICsxKQ0KaGlzdChpcmlzJFNlcGFsLldpZHRoLCB4bGFiID0gIldpZHRoIG9mIFNlcGFsIiwgbWFpbiA9IE5BLCBicmVha3MgPSBiaW5zKQ0KDQpkZW5zIDwtIGRlbnNpdHkoaXJpcyRTZXBhbC5XaWR0aCkNCnBsb3QoZGVucywgbWFpbiA9ICJEZW5zaXR5IGRpc3RyaWJ1dGlvbiBvZiB0aGUgd2lkdGggb2Ygc2VwYWwiKQ0KDQpkZW5zIDwtIGRlbnNpdHkoaXJpcyRTZXBhbC5XaWR0aCwgYnc9MC4wNSkNCnBsb3QoZGVucywgbWFpbiA9ICJEZW5zaXR5IGRpc3RyaWJ1dGlvbiBvZiB0aGUgd2lkdGggb2Ygc2VwYWwiKQ0KDQpxcW5vcm0oaXJpcyRTZXBhbC5XaWR0aCkNCnFxbGluZShpcmlzJFNlcGFsLldpZHRoKQ0KDQpyYWlydW9obzwtcmVhZC50YWJsZSgnRGF0YS9yYWlydW9oby50eHQnLGhlYWRlcj1ULCBzZXA9Ilx0IiwgZGVjPSIuIikNCnBsb3QoZGF5MyB+IGRheTcsZGF0PXJhaXJ1b2hvLA0KICAgIHhsYWIgPSAnTGVuZ3RoIGF0IGRheSAzJywgDQogICAgeWxhYiA9ICdMZW5ndGggYXQgZGF5IDcnLCANCiAgICBtYWluID0gJ1JlYWx0aW9uc2hpcCBiZXR3ZWVuIHRoZSBsZW5ndGggYXQgZGF5IDMgYW5kIGRheSA3JykNCmhpc3QocmFpcnVvaG8kZGF5NykNCmRlbnMucmFpIDwtIGRlbnNpdHkocmFpcnVvaG8kZGF5NywgYnc9NikNCnBsb3QoZGVucy5yYWksIG1haW4gPSAiRGVuc2l0eSBkaXN0cmlidXRpb24gb2YgdGhlIGxlbmd0aCBhdCBkYXkgNyIpDQpxcW5vcm0ocmFpcnVvaG8kZGF5NykNCnFxbGluZShyYWlydW9obyRkYXk3KQ0KYm94cGxvdChkYXk3fnRyZWF0bWVudCwgZGF0YT1yYWlydW9obykgDQpwYWlycyhyYWlydW9ob1ssMTo2XSkNCg0KcGFyKCkgIyBncmFwaGljYWwgb3B0aW9ucw0KDQojIGBsYXNgIHdpdGhpbiB0aGUgYHBsb3RgIGZ1bmN0aW9uDQpwbG90KFBldGFsLkxlbmd0aCB+IFBldGFsLldpZHRoLCBkYXQgPSBpcmlzLGxhcz0xKQ0KDQojIGBsYXNgIHNldCBhcyBhIGdyYXBoaWNhbCBzZXR0aW5nDQpwYXIobGFzPTEpIA0KcGxvdChQZXRhbC5MZW5ndGggfiBQZXRhbC5XaWR0aCwgZGF0ID0gaXJpcykNCg0KZGV2Lm9mZigpDQoNCnBhcihtZnJvdz1jKDEsMikpIyBkZWZpbmUgZ3JhcGhpY2FsIHBhcmFtZXRlcjogMSByb3csIDIgY29sdW1ucw0KcGxvdCAoMSwgMSwgY2V4PTE1LCBwY2g9MTUpICMgMXN0IHBsb3QNCnBsb3QgKDEsIDEsIGNleD0xNSwgcGNoPTE5KSAjIDJuZCBwbG90DQoNCnBhcihiZz0iI0ZDRThDNSIsIG1hcj1jKDQsNCw0LDQpLCBwY2ggPSAxOSwgbGFzPTEsIGNleD0xLjIsIGNleC5tYWluPTEuMiwgY2V4LmF4aXM9MSxjZXgubGFiPTEpDQoNCnBsb3QoUGV0YWwuTGVuZ3RoIH4gUGV0YWwuV2lkdGgsIGRhdCA9IGlyaXMsDQogICAgIHhsYWIgPSAnUGV0YWwgd2lkdGggKGNtKScsIA0KICAgICB5bGFiID0gJ1BldGFsIGxlbmd0aCAoY20pJywgDQogICAgIG1haW4gPSAnUGV0YWwgd2lkdGggYW5kIGxlbmd0aCBvZiBpcmlzIGZsb3dlcicsDQogICAgIGNvbCA9IGFscGhhKGNvbC5pcmlzLCAwLjIpKSAjIHNldCB1cCBzeW1ib2wgdHlwZXMgYW5kIHRoZWlyIGNvbG9yIA0KDQpsZWdlbmQoeD0iYm90dG9tcmlnaHQiLCBwY2g9IDE5LCBjZXg9MC44LCBsZWdlbmQ9IGMoInZlcnNpY29sb3IiLCJzZXRvc2EiLCAidmlyZ2luaWNhIiksIGNvbD1sZXZlbHMoYXMuZmFjdG9yKGFscGhhKGNvbC5pcmlzLCAwLjIpKSkpDQoNCnRpdGxlIChtYWluPSd0aXRsZScsIHlsYWI9J3ktYXhpcyB0aXRsZSIsIHhsYWIneC1heGlzIHRpdGxlJykNCg0KdGV4dCAoeD0xLCB5PTEsJ3RleHQnKQ0KbXRleHQgKCd0ZXh0Jywgc2lkZT0xLCBsaW5lPTEpDQoNCmFibGluZSAoaD0xKQ0KYWJsaW5lICh2PTEpDQoNCnRpZmYoZmlsZW5hbWUgPSAiRmlndXJlcy9pcmlzX3Bsb3QudGlmIiwgd2lkdGggPSA1LCBoZWlnaHQgPSA2LCB1bml0cyA9ICJpbiIsIGNvbXByZXNzaW9uID0gIm5vbmUiLCByZXMgPSAzMDApDQoNCnBhcihiZz0iI0ZDRThDNSIsIG1hcj1jKDQsNCw0LDQpLCBwY2ggPSAxOSwgbGFzPTEsIGNleD0xLjIsIGNleC5tYWluPTEuMiwgY2V4LmF4aXM9MSxjZXgubGFiPTEpDQoNCnBsb3QoUGV0YWwuTGVuZ3RoIH4gUGV0YWwuV2lkdGgsIGRhdCA9IGlyaXMsDQogICAgIHhsYWIgPSAnUGV0YWwgd2lkdGggKGNtKScsIA0KICAgICB5bGFiID0gJ1BldGFsIGxlbmd0aCAoY20pJywgDQogICAgIG1haW4gPSAnUGV0YWwgd2lkdGggYW5kIGxlbmd0aCBvZiBpcmlzIGZsb3dlcicsDQogICAgIGNvbCA9IGFscGhhKGNvbC5pcmlzLCAwLjIpKSAjIHNldCB1cCBzeW1ib2wgdHlwZXMgYW5kIHRoZWlyIGNvbG9yIA0KDQpsZWdlbmQoeD0iYm90dG9tcmlnaHQiLCBwY2g9IDE5LCBjZXg9MC44LCBsZWdlbmQ9IGMoInZlcnNpY29sb3IiLCJzZXRvc2EiLCAidmlyZ2luaWNhIiksIGNvbD1sZXZlbHMoYXMuZmFjdG9yKGFscGhhKGNvbC5pcmlzLCAwLjIpKSkpDQoNCmRldi5vZmYoKQ0KDQpwZGYoZmlsZT0gIkZpZ3VyZXMvaXJpc19wbG90LnBkZiIsIHdpZHRoID0gNSwgaGVpZ2h0ID0gNikNCg0KcGFyKGJnPSIjRkNFOEM1IiwgbWFyPWMoNCw0LDQsNCksIHBjaCA9IDE5LCBsYXM9MSwgY2V4PTEuMiwgY2V4Lm1haW49MS4yLCBjZXguYXhpcz0xLGNleC5sYWI9MSkNCg0KcGxvdChQZXRhbC5MZW5ndGggfiBQZXRhbC5XaWR0aCwgZGF0ID0gaXJpcywNCiAgICAgeGxhYiA9ICdQZXRhbCB3aWR0aCAoY20pJywgDQogICAgIHlsYWIgPSAnUGV0YWwgbGVuZ3RoIChjbSknLCANCiAgICAgbWFpbiA9ICdQZXRhbCB3aWR0aCBhbmQgbGVuZ3RoIG9mIGlyaXMgZmxvd2VyJywNCiAgICAgY29sID0gYWxwaGEoY29sLmlyaXMsIDAuMikpICMgc2V0IHVwIHN5bWJvbCB0eXBlcyBhbmQgdGhlaXIgY29sb3IgDQoNCmxlZ2VuZCh4PSJib3R0b21yaWdodCIsIHBjaD0gMTksIGNleD0wLjgsIGxlZ2VuZD0gYygidmVyc2ljb2xvciIsInNldG9zYSIsICJ2aXJnaW5pY2EiKSwgY29sPWxldmVscyhhcy5mYWN0b3IoYWxwaGEoY29sLmlyaXMsIDAuMikpKSkNCg0KZGV2Lm9mZigpDQoNCiNBcyB0aXRsZSwgY2FsbCBtZSBhbmQgc2hvdyBtZSB5b3VyIHBkZg0KDQpsaWJyYXJ5KGxhdHRpY2UpDQoNCmxpYnJhcnkobGF0dGljZSkNCmRlbnNpdHlwbG90KH4gUGV0YWwuTGVuZ3RoIHwgU3BlY2llcywgaXJpcywgcGxvdC5wb2ludHMgPSAiIiwgbGF5b3V0PWMoMSwzKSkNCg0KaGlzdG9ncmFtKH4gUGV0YWwuTGVuZ3RoIHwgU3BlY2llcywgaXJpcywgcGxvdC5wb2ludHMgPSAiIiwgbmludCA9IDIwLCBsYXlvdXQ9YygxLDMpKQ0KDQpxcW1hdGgofiBQZXRhbC5MZW5ndGggfCBTcGVjaWVzLCBpcmlzLCBwbG90LnBvaW50cyA9ICIiLCBuaW50ID0gMjAsIGxheW91dD1jKDMsMSkpDQoNCmlyaXMkdmFyaWV0eTwtcmVwKGMocmVwKCdwdXJlJywyNSksIHJlcCgnaHlicmlkJywyNSkpLDMpICMgZHVtbXkgdmFyaWFibGUNCmJ3cGxvdChQZXRhbC5MZW5ndGggfiAgdmFyaWV0eXxTcGVjaWVzLCBpcmlzKQ0KDQp4eXBsb3QoU2VwYWwuTGVuZ3RoICsgU2VwYWwuV2lkdGggfiBQZXRhbC5MZW5ndGggKyBQZXRhbC5XaWR0aCB8IFNwZWNpZXMsDQogICAgICAgZGF0YSA9IGlyaXMsIHNjYWxlcyA9ICJmcmVlIiwgbGF5b3V0ID0gYygyLCAyKSwgdHlwZT1jKCJwIiwiZyIpLA0KICAgICAgIGF1dG8ua2V5ID0gbGlzdCh4ID0gLjYsIHkgPSAuNywgY29ybmVyID0gYygwLCAwKSkpDQoNCnh5cGxvdChTZXBhbC5MZW5ndGggKyBTZXBhbC5XaWR0aCArIFBldGFsLldpZHRoIH4gUGV0YWwuTGVuZ3RoICB8IFNwZWNpZXMsDQogICAgICAgZGF0YSA9IGlyaXMsIHNjYWxlcyA9ICJmcmVlIiwgbGF5b3V0ID0gYygyLCAyKSwgdHlwZT1jKCJwIiwiciIpLA0KICAgICAgIGF1dG8ua2V5ID0gbGlzdCh4ID0gLjYsIHkgPSAuNywgY29ybmVyID0gYygwLCAwKSkpDQoNCnh5cGxvdChTZXBhbC5MZW5ndGggKyBTZXBhbC5XaWR0aCArIFBldGFsLldpZHRoIH4gUGV0YWwuTGVuZ3RoICB8IFNwZWNpZXMsDQogICAgICAgZGF0YSA9IGlyaXNbb3JkZXIoaXJpcyRQZXRhbC5MZW5ndGgpLF0sIHNjYWxlcyA9ICJmcmVlIiwgbGF5b3V0ID0gYygyLCAyKSwgDQogICAgICAgdHlwZT1jKCJsIiksIGF1dG8ua2V5ID0gbGlzdCh4ID0gLjYsIHkgPSAuNywgY29ybmVyID0gYygwLCAwKSkpDQoNCnh5cGxvdChTZXBhbC5MZW5ndGggKyBTZXBhbC5XaWR0aCArIFBldGFsLldpZHRoIH4gUGV0YWwuTGVuZ3RoICB8IHZhcmlldHkrU3BlY2llcywNCiAgICAgICBkYXRhID0gaXJpc1tvcmRlcihpcmlzJFBldGFsLkxlbmd0aCksXSwgc2NhbGVzID0gImZyZWUiLCBsYXlvdXQgPSBjKDMsIDIpLA0KICAgICAgIHR5cGU9YygibCIpLCBhdXRvLmtleSA9IFQpDQoNCnRyZWxsaXMucGFyLmdldCgpDQoNCmxpYnJhcnkoZ2dwbG90MikNCg0KbGlicmFyeSh0aWR5cikNCmxpYnJhcnkoZHBseXIpDQpkYXQxIDwtIHJlYWQuY3N2KCJEYXRhL0ZBT19ncmFpbnNfTkEuY3N2IiwgaGVhZGVyPVRSVUUpDQpkYXQxdyA8LSBkYXQxICU+JSBmaWx0ZXIoSW5mb3JtYXRpb24gPT0gIllpZWxkIChIZy9IYSkiLCBDb3VudHJ5ID09IlVuaXRlZCBTdGF0ZXMgb2YgQW1lcmljYSIsIENyb3AgJWluJSBjKCJPYXRzIiwgIk1haXplIiwgIkJhcmxleSIsICJCdWNrd2hlYXQiLCJSeWUiKSkgJT4lIHNlbGVjdCAoWWVhciwgQ3JvcCwgVmFsdWUpICU+JSBzcHJlYWQoa2V5ID0gQ3JvcCx2YWx1ZT0iVmFsdWUiKQ0KZGF0MWwgPC0gZGF0MXcgJT4lIHBpdm90X2xvbmdlcigyOjYsIG5hbWVzX3RvID0gIkNyb3AiLCB2YWx1ZXNfdG8gPSAiWWllbGQiKQ0KZGF0MWwyIDwtIGRhdDEgJT4lIGZpbHRlcihJbmZvcm1hdGlvbiA9PSAiWWllbGQgKEhnL0hhKSIsIENyb3AgJWluJSBjKCJPYXRzIiwgIk1haXplIiwgIkJhcmxleSIsICJCdWNrd2hlYXQiLCJSeWUiKSkgJT4lIHNlbGVjdCggWWVhciwgQ3JvcCwgQ291bnRyeSwgWWllbGQgPSBWYWx1ZSkgICMgTm90ZSB0aGF0IHdlIGFyZSByZW5hbWluZyB0aGUgVmFsdWUgZmllbGQNCg0KbGlicmFyeShzdHJpbmdyKQ0KZGF0MiA8LSByZWFkLmNzdigiRGF0YS9JbmNvbWVfZWR1Y2F0aW9uLmNzdiIsIGhlYWRlcj1UUlVFKQ0KRWR1LkdlbmQgPC0gZGF0YS5mcmFtZSggDQogICAgICAgICAgICAgICB2YXJpYWJsZSA9IHBhc3RlKCJCMjAwMDQwIiwgc3RyX3BhZCgxOjE4LCB3aWR0aD0yICwgcGFkPSIwIiksc2VwPSIiICksDQogICAgICAgICAgICAgICBMZXZlbCA9IHJlcChjKCJBbGwiLCAiTm9IUyIsIkhTIiwiQUQiLCJCRCIsIkdyYWQiKSwgdGltZXM9MyksDQogICAgICAgICAgICAgICBHZW5kZXIgPSByZXAoYygiQWxsIiwgIk0iLCJGIiksIGVhY2g9NikpDQojIENyZWF0ZSBhIHJlZ2lvbi9zdGF0ZSBqb2luIHRhYmxlDQpzdC5yZWcgPC0gZGF0YS5mcmFtZShTdGF0ZSA9IHRvbG93ZXIoc3RhdGUuYWJiKSwgUmVnaW9uID0gc3RhdGUucmVnaW9uKQ0Kc3QucmVnIDwtIHJiaW5kKHN0LnJlZyAsIGRhdGEuZnJhbWUoU3RhdGU9ImRjIiwgUmVnaW9uPSJTb3V0aCIpKQ0KDQojIFN0YXJ0IHRoZSBwaXBpbmcgb3BlcmF0aW9ucw0KZGF0MmIgPC0gZGF0MiAlPiUNCiAgZ2F0aGVyKGtleSA9ICJ2YXJpYWJsZSIsIHZhbHVlID0gInZhbHVlIiwgLTE6LTIpICAlPiUNCiAgbGVmdF9qb2luKEVkdS5HZW5kLCBieT0idmFyaWFibGUiICkgICAgICAgICAgICAgICU+JQ0KICBzZWxlY3QoU3RhdGUsIENvdW50eSwgTGV2ZWwsIEdlbmRlciwgdmFsdWUpICAgICAgICU+JQ0KICBtdXRhdGUoTGV2ZWwgPSBmYWN0b3IoTGV2ZWwsIGxldmVscyA9IGMoIkFsbCIsIk5vSFMiLCJIUyIsICJBRCIsICJCRCIsICJHcmFkIikpKSAlPiUNCiAgbGVmdF9qb2luKHN0LnJlZyAsIGJ5PSJTdGF0ZSIpDQoNCmRhdDJjIDwtIHNwcmVhZChkYXQyYiwga2V5ID0gR2VuZGVyLCB2YWx1ZSA9IHZhbHVlICkNCg0KZ2dwbG90KGRhdDFsICwgYWVzKHggPSBZZWFyLCB5ID0gWWllbGQpKSArIGdlb21fcG9pbnQoKQ0KDQpnZ3Bsb3QoZGF0MWwgLCBhZXMoeCA9IFllYXIsIHkgPSBZaWVsZCwgY29sb3IgPSBDcm9wKSkgKyBnZW9tX3BvaW50KCkNCg0KZ2dwbG90KGRhdDFsICwgYWVzKHggPSBZZWFyLCB5ID0gWWllbGQsIGNvbG9yID0gQ3JvcCkpICsgZ2VvbV9saW5lKCkNCg0KZ2dwbG90KGRhdDFsICwgYWVzKFllYXIsIFlpZWxkLCBjb2xvciA9IENyb3ApKSArIGdlb21fbGluZSgpDQoNCmdncGxvdChkYXQxdywgYWVzKHggPSBZZWFyLCB5ID0gT2F0cykpICsgZ2VvbV9saW5lKCkgDQoNCmdncGxvdChkYXQxdywgYWVzKHggPSBZZWFyLCB5ID0gT2F0cykpICsgDQogIGdlb21fbGluZShsaW5ldHlwZSA9IDIsIGNvbG9yID0gImJsdWUiLCBzaXplPTAuNCkNCg0KZ2dwbG90KGRhdDIsIGFlcyh4ID0gQjIwMDA0MDEzLCB5ID0gQjIwMDA0MDA3KSkgKyBnZW9tX3BvaW50KGFscGhhID0gMC4zKSANCg0KZ2dwbG90KGRhdDIsIGFlcyh4ID0gQjIwMDA0MDEzLCB5ID0gQjIwMDA0MDA3KSkgKyANCiAgZ2VvbV9wb2ludChjb2xvdXIgPSAicmVkIiwgcGNoPTMgLCBhbHBoYSA9IDAuMywgY2V4PTAuNikNCg0KbGlicmFyeShoZXhiaW4pDQpnZ3Bsb3QoZGF0MiwgYWVzKHggPSBCMjAwMDQwMTMsIHkgPSBCMjAwMDQwMDcpKSArIA0KICBnZW9tX2hleChiaW53aWR0aCA9IGMoMTAwMCwgMTAwMCkpDQoNCmdncGxvdChkYXQxbCwgYWVzKHggPSBDcm9wLCB5ID0gWWllbGQpKSArIGdlb21fYm94cGxvdChmaWxsID0gImJpc3F1ZSIpIA0KDQpnZ3Bsb3QoZGF0MWwsIGFlcyh4ID0gIiIsIHkgPSBZaWVsZCkpICsgDQogIGdlb21fYm94cGxvdChmaWxsID0gImJpc3F1ZSIpICsgeGxhYigiQWxsIGNyb3BzIikNCg0KZ2dwbG90KGRhdDFsLCBhZXMoeCA9ICIiLCB5ID0gWWllbGQpKSArIGdlb21fdmlvbGluKGZpbGwgPSAiYmlzcXVlIikgDQoNCmdncGxvdChkYXQxdywgYWVzKHggPSBPYXRzKSkgKyBnZW9tX2hpc3RvZ3JhbShmaWxsID0gImdyZXk1MCIpDQoNCmdncGxvdChkYXQxdywgYWVzKHggPSBPYXRzKSkgKyANCiAgZ2VvbV9oaXN0b2dyYW0oZmlsbCA9ICJncmV5NTAiLCBiaW53aWR0aCA9IDEwMDApIA0KDQpnZ3Bsb3QoZGF0MXcsIGFlcyh4ID0gT2F0cykpICsgDQogIGdlb21faGlzdG9ncmFtKGZpbGwgPSAiZ3JleTUwIiwgYmlucyA9IDgpIA0KDQpnZ3Bsb3QoZGF0MiwgYWVzKFN0YXRlKSkgKyBnZW9tX2JhcigpDQoNCmxpYnJhcnkoZm9yY2F0cykNCmdncGxvdChkYXQyLCBhZXMoZmN0X2luZnJlcShTdGF0ZSxvcmRlcmVkID0gVFJVRSkpKSArIGdlb21fYmFyKCkNCg0KZ2dwbG90KGRhdDIsIGFlcyhmY3RfcmV2KGZjdF9pbmZyZXEoU3RhdGUsb3JkZXJlZCA9IFRSVUUpKSkpICsgZ2VvbV9iYXIoKQ0KDQpkYXQyLmN0IDwtIGRhdDIgJT4lIGdyb3VwX2J5KFN0YXRlKSAlPiUgDQogICAgICAgICAgICAgICAgc3VtbWFyaXplKENvdW50aWVzID0gbigpKQ0KaGVhZChkYXQyLmN0KQ0KDQpnZ3Bsb3QoZGF0Mi5jdCwgYWVzKHg9ZmN0X3Jlb3JkZXIoU3RhdGUsIENvdW50aWVzLCAuZnVuID0gbWVkaWFuKSwgeSA9IENvdW50aWVzKSkgKyBnZW9tX2JhcihzdGF0ID0gImlkZW50aXR5IikNCg0KZ2dwbG90KGRhdDIuY3QgLCBhZXMoeCA9IENvdW50aWVzLCB5ID0gU3RhdGUpKSArIGdlb21fcG9pbnQoKQ0KDQpnZ3Bsb3QoZGF0Mi5jdCAsIGFlcyh4ID0gQ291bnRpZXMsIHkgPSBmY3RfcmVvcmRlcihTdGF0ZSwgQ291bnRpZXMsIC5mdW4gPSBtZWRpYW4pKSkgKyBnZW9tX3BvaW50KCkNCg0KZ2dwbG90KGRhdDIsIGFlcyh4ID0gQjIwMDA0MDEzLCB5ID0gQjIwMDA0MDA3KSkgKyANCiAgZ2VvbV9wb2ludChhbHBoYSA9IDAuMywgY29sb3I9JyM0ZjRiNGInKSArIA0KICBnZW9tX3Ntb290aChtZXRob2QgPSAibG0iLCBjb2xvcj0nZ3JlZW4nKQ0KDQpnZ3Bsb3QoZGF0MiwgYWVzKHggPSBCMjAwMDQwMTMsIHkgPSBCMjAwMDQwMDcpKSArIA0KICBnZW9tX3BvaW50KGFscGhhID0gMC4zLCBjb2xvcj0nIzRmNGI0YicpICsNCiAgZ2VvbV9zbW9vdGgobWV0aG9kID0gImxvZXNzIiwgY29sb3I9J2dyZWVuJykNCg0KZ2dwbG90KGRhdDIsIGFlcyhTdGF0ZSkpICsgZ2VvbV9iYXIoKSArIGdndGl0bGUoIk51bWJlciBvZiBjb3VudGllcyBieSBzdGF0ZSIpDQoNCmdncGxvdChkYXQyLCBhZXMoeCA9IEIyMDAwNDAxMywgeSA9IEIyMDAwNDAwNykpICsgZ2VvbV9wb2ludChhbHBoYSA9IDAuMykgKyB4bGFiKCJGZW1hbGUgaW5jb21lICgkKSIpICsgeWxhYigiTWFsZSBpbmNvbWUgKCQpIikNCg0KZ2dwbG90KGRhdDIsIGFlcyh4ID0gQjIwMDA0MDEzLCB5ID0gQjIwMDA0MDA3KSkrIA0KICBnZW9tX3BvaW50KGFscGhhID0gMC4zKSArDQogIHhsYWIoIkZlbWFsZSBpbmNvbWUgKCQpIikgKyANCiAgeWxhYigiTWFsZSBpbmNvbWUgKCQpIikgKw0KICBzY2FsZV94X2NvbnRpbnVvdXMoYnJlYWtzID0gYygxMDAwMCwgMzAwMDAsIDUwMDAwKSxsYWJlbHMgPSBjKCIkMTAsMDAwIiwgIiQzMCwwMDAiLCAiJDUwLDAwMCIpKQ0KDQpnZ3Bsb3QoZGF0MiwgYWVzKHg9QjIwMDA0MDEzLCB5PUIyMDAwNDAwNykpICsgZ2VvbV9wb2ludChhbHBoYT0wLjMpICsNCiAgIHhsYWIoIkZlbWFsZSBpbmNvbWUgKCQpIikgKyB5bGFiKCJNYWxlIGluY29tZSAoJCkiKSArDQogICBzY2FsZV94X2NvbnRpbnVvdXMobGFiZWxzPXNjYWxlczo6dW5pdF9mb3JtYXQoc3VmZml4PSJrIixzY2FsZT0wLjAwMSwgc2VwPSIiKSkgKw0KICAgc2NhbGVfeV9jb250aW51b3VzKGxhYmVscz1zY2FsZXM6OnVuaXRfZm9ybWF0KHN1ZmZpeD0iayIsIHNjYWxlPTAuMDAxLCBzZXA9IiIpKQ0KDQpnZ3Bsb3QoZGF0MiwgYWVzKHg9QjIwMDA0MDEzLCB5PUIyMDAwNDAwNykpICsgZ2VvbV9wb2ludChhbHBoYT0wLjMpICsNCiAgIHhsYWIoIkZlbWFsZSBpbmNvbWUgKCQpIikgKyB5bGFiKCJNYWxlIGluY29tZSAoJCkiKSArDQogICBzY2FsZV94X2NvbnRpbnVvdXMobGFiZWxzPXNjYWxlczo6dW5pdF9mb3JtYXQoc3VmZml4PSJrIiwgc2NhbGU9MC4wMDEsIHNlcD0iIikpICsNCiAgIHNjYWxlX3lfY29udGludW91cyhsYWJlbHM9c2NhbGVzOjp1bml0X2Zvcm1hdChzdWZmaXg9ImsiLCBzY2FsZT0wLjAwMSwgc2VwPSIiKSkgKw0KICAgdGhlbWUoYXhpcy50ZXh0LnggPSBlbGVtZW50X3RleHQoYW5nbGUgPSA0NSwgaGp1c3QgPSAxKSkgDQoNCmdncGxvdChkYXQyLCBhZXMoeCA9IEIyMDAwNDAxMywgeSA9IEIyMDAwNDAwNykpICsgZ2VvbV9wb2ludChhbHBoYSA9IDAuMykgKw0KICAgICAgIHhsYWIoIkZlbWFsZSBpbmNvbWUgKCQpIikgKyB5bGFiKCJNYWxlIGluY29tZSAoJCkiKSArDQogICAgICAgeGxpbSgxMDAwMCwgNzUwMDApICsgeWxpbSgxMDAwMCwgNzUwMDApDQoNCmdncGxvdChkYXQyLCBhZXMoeCA9IEIyMDAwNDAxMywgeSA9IEIyMDAwNDAwNykpICsgZ2VvbV9wb2ludChhbHBoYSA9IDAuMykgKw0KICAgeGxhYigiRmVtYWxlIGluY29tZSAoJCkiKSArIHlsYWIoIk1hbGUgaW5jb21lICgkKSIpICsNCiAgIHNjYWxlX3hfY29udGludW91cyhsaW1pdCAgPSBjKDEwMDAwLCA3NTAwMCksbGFiZWxzID0gc2NhbGVzOjpjb21tYV9mb3JtYXQoKSkgKw0KICAgc2NhbGVfeV9jb250aW51b3VzKGxpbWl0ICA9IGMoMTAwMDAsIDc1MDAwKSwgbGFiZWxzID0gc2NhbGVzOjpjb21tYV9mb3JtYXQoKSkNCg0KZ2dwbG90KGRhdDIsIGFlcyh4ID0gQjIwMDA0MDEzLCB5ID0gQjIwMDA0MDA3KSkgKyBnZW9tX3BvaW50KGFscGhhID0gMC4zKSArDQogICB4bGFiKCJGZW1hbGUgaW5jb21lICgkKSIpICsgeWxhYigiTWFsZSBpbmNvbWUgKCQpIikgKw0KICAgc2NhbGVfeF9jb250aW51b3VzKGxpbWl0ICA9IGMoMTAwMDAsIDc1MDAwKSxsYWJlbHMgPSBzY2FsZXM6OmNvbW1hX2Zvcm1hdCgpLGJyZWFrcyA9IGMoMTAwMDAsIDMwMDAwLCA1MDAwMCwgNzAwMDApKSArDQogICBzY2FsZV95X2NvbnRpbnVvdXMobGltaXQgID0gYygxMDAwMCwgNzUwMDApLGxhYmVscyA9IHNjYWxlczo6Y29tbWFfZm9ybWF0KCksYnJlYWtzID0gYygxMDAwMCwgMzAwMDAsIDUwMDAwLCA3MDAwMCkpDQoNCmdncGxvdChkYXQyLCBhZXMoeCA9IEIyMDAwNDAxMywgeSA9IEIyMDAwNDAwNykpICsgZ2VvbV9wb2ludChhbHBoYSA9IDAuMykgKw0KICAgICAgIHhsYWIoIkZlbWFsZSBpbmNvbWUgKCQpIikgKyB5bGFiKCJNYWxlIGluY29tZSAoJCkiKSArDQogICAgICAgY29vcmRfdHJhbnMoeCA9ICJsb2ciKQ0KDQpnZ3Bsb3QoZGF0MiwgYWVzKHggPSBCMjAwMDQwMTMsIHkgPSBCMjAwMDQwMDcpKSArIGdlb21fcG9pbnQoYWxwaGEgPSAwLjMpICsNCiAgICAgICB4bGFiKCJGZW1hbGUgaW5jb21lICgkKSIpICsgeWxhYigiTWFsZSBpbmNvbWUgKCQpIikgKw0KICAgICAgIGNvb3JkX3RyYW5zKHggPSBzY2FsZXM6OmJveGNveF90cmFucygtMC4zKSkNCg0KZ2dwbG90KGRhdDIsIGFlcyh4ID0gQjIwMDA0MDEzLCB5ID0gQjIwMDA0MDA3KSkgKyBnZW9tX3BvaW50KGFscGhhID0gMC4zKSArDQogICAgICAgZ2VvbV9zbW9vdGgobWV0aG9kID0gImxtIiwgc2UgPSBGQUxTRSkgKw0KICAgICAgIHhsYWIoIkZlbWFsZSBpbmNvbWUgKCQpIikgKyB5bGFiKCJNYWxlIGluY29tZSAoJCkiKSArDQogICAgICAgc2NhbGVfeF9jb250aW51b3VzKHRyYW5zID0gImxvZyIsIGJyZWFrcyA9IHNlcSgxMDAwMCw2MDAwMCwxMDAwMCkpDQoNCmdncGxvdChkYXQyLCBhZXMoeCA9IEIyMDAwNDAxMywgeSA9IEIyMDAwNDAwNykpICsgZ2VvbV9wb2ludChhbHBoYSA9IDAuMykgKw0KICAgICAgIGdlb21fc21vb3RoKG1ldGhvZCA9ICJsbSIpICsNCiAgICAgICB4bGFiKCJGZW1hbGUgaW5jb21lICgkKSIpICsgeWxhYigiTWFsZSBpbmNvbWUgKCQpIikgKw0KICAgICAgIGNvb3JkX2VxdWFsKHJhdGlvID0gMSkNCg0KZGF0Mi5jdDIgPC0gZGF0MiAlPiUgZ3JvdXBfYnkoU3RhdGUpICU+JSBzdW1tYXJpemUoQ291bnRpZXMgPSBuKCksIEluY29tZSA9IG1lZGlhbihCMjAwMDQwMDEpKQ0KDQpnZ3Bsb3QoZGF0Mi5jdDIsIGFlcyh4ID0gZmN0X3Jlb3JkZXIoU3RhdGUsIENvdW50aWVzKSwgeSA9IENvdW50aWVzLCBmaWxsID0gSW5jb21lKSkgKw0KICAgZ2VvbV9iYXIoc3RhdCA9ICJpZGVudGl0eSIpICsgDQogICBzY2FsZV9maWxsX2dyYWRpZW50KGxvdyA9ICJncmVlbiIsIGhpZ2ggPSAicmVkIikNCg0KZ2dwbG90KGRhdDIuY3QyLCBhZXMoeCA9IGZjdF9yZW9yZGVyKFN0YXRlLCBDb3VudGllcyksIHkgPSBDb3VudGllcywgZmlsbCA9IEluY29tZSkpICsNCiAgIGdlb21fYmFyKHN0YXQgPSAiaWRlbnRpdHkiKSArIA0KICAgc2NhbGVfZmlsbF9ncmFkaWVudDIobG93ID0gImRhcmtyZWQiLCBtaWQgPSAid2hpdGUiLCAgaGlnaCA9ICJkYXJrZ3JlZW4iLCBtaWRwb2ludCA9IDMwODkyKQ0KDQpnZ3Bsb3QoZGF0Mi5jdDIsIGFlcyh5ID0gZmN0X3Jlb3JkZXIoU3RhdGUsIENvdW50aWVzKSwgeCA9IENvdW50aWVzLCBjb2wgPSBJbmNvbWUpKSArDQogICBnZW9tX3BvaW50KCkgKw0KICAgc2NhbGVfY29sb3VyX2dyYWRpZW50Mihsb3cgPSAiZGFya3JlZCIsIG1pZCA9ICJ3aGl0ZSIsICBoaWdoID0gImRhcmtncmVlbiIsIG1pZHBvaW50ID0gMzA4OTIpDQoNCmdncGxvdChkYXQxbCwgYWVzKFllYXIsIFlpZWxkLCBjb2wgPSBDcm9wKSkgKyANCiAgICAgICBnZW9tX2xpbmUoKSArDQogICAgICAgc2NhbGVfY29sb3VyX21hbnVhbCh2YWx1ZXMgPSBjKCJyZWQiLCAib3JhbmdlIiwgImdyZWVuIiwgImJsdWUiLCAieWVsbG93IikpDQoNCmdncGxvdChkYXQxbCwgYWVzKFllYXIsIFlpZWxkLCBjb2wgPSBDcm9wKSkgKyANCiAgICAgICAgICAgICAgZ2VvbV9saW5lKCkgKw0KICAgICAgICAgICAgICBzY2FsZV9jb2xvdXJfYnJld2VyKHBhbGV0dGUgPSAiRGFyazIiKQ0KDQpnZ3Bsb3QoZGF0MWwsIGFlcyhZZWFyLCBZaWVsZCwgY29sID0gcmVvcmRlcihDcm9wLCBZaWVsZCwgbWVkaWFuKSkpICsgDQogICAgICAgICAgICAgIGdlb21fbGluZSgpICsNCiAgICAgICAgICAgICAgZ3VpZGVzKGNvbG91ciA9IGd1aWRlX2xlZ2VuZCh0aXRsZSA9ICJDcm9wcyIpKSArICANCiAgICAgICAgICAgICAgc2NhbGVfY29sb3VyX2JyZXdlcihwYWxldHRlID0gIlJlZHMiKSANCg0KZ2dwbG90KGRhdDIsIGFlcyh4ID0gQjIwMDA0MDEzXjAuMzMzLCB5ID0gc3FydChCMjAwMDQwMDcpKSkgKyBnZW9tX3BvaW50KGFscGhhID0gMC4zKSArDQogICAgICAgeGxhYiggZXhwcmVzc2lvbigoIkZlbWFsZSBpbmNvbWUiKSBeIGZyYWMoMSwzKSkpICsgDQogICAgICAgeWxhYiggZXhwcmVzc2lvbihzcXJ0KCJNYWxlIGluY29tZSIpKSkNCg0KZ2dwbG90KGRhdDFsMiwgYWVzKHggPSBZZWFyLCB5ID0gWWllbGQsIGNvbG9yID0gQ3JvcCkpICsgZ2VvbV9saW5lKCkgKyANCiAgICAgICBmYWNldF93cmFwKCB+IENvdW50cnksIG5yb3cgPSAxKQ0KDQpnZ3Bsb3QoZGF0MWwyLCBhZXMoeCA9IFllYXIsIHk9WWllbGQpKSArIGdlb21fbGluZSgpICsNCiAgICB0aGVtZShheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChhbmdsZSA9IDkwLCB2anVzdCA9IDAuNSwgaGp1c3QgPSAxKSkgKw0KICAgIGZhY2V0X3dyYXAoQ3JvcCB+IENvdW50cnksIG5yb3cgPSAxKQ0KDQpnZ3Bsb3QoZGF0MWwyLCBhZXMoeCA9IFllYXIsIHk9WWllbGQpKSArIGdlb21fbGluZSgpICsNCiAgdGhlbWUoYXhpcy50ZXh0LnggPSBlbGVtZW50X3RleHQoYW5nbGUgPSA5MCwgdmp1c3QgPSAwLjUsIGhqdXN0ID0gMSkpICsNCiAgZmFjZXRfd3JhcChDcm9wIH4gQ291bnRyeSwgbnJvdyA9IDEsIGxhYmVsbGVyID0gbGFiZWxfd3JhcF9nZW4od2lkdGggPSAxMikpDQoNCmdncGxvdChkYXQxbDIsIGFlcyh4ID0gWWVhciwgeSA9IFlpZWxkKSkgKyBnZW9tX2xpbmUoKSArIA0KICAgICAgIGZhY2V0X2dyaWQoIENyb3AgfiBDb3VudHJ5KQ0KDQpkYXQyYyRpbmNybmcgPC0gY3V0KGRhdDJjJEYgLCBicmVha3MgPSBjKDAsIDI1MDAwLCA1MDAwMCwgNzUwMDAsIDEwMDAwMCkgKQ0KDQpzdW1tYXJ5KGRhdDJjJGluY3JuZykNCg0KZGF0MmMgPC0gbmEub21pdChkYXQyYykNCg0KbGV2ZWxzKGRhdDJjJGluY3JuZykgDQoNCmxldmVscyhkYXQyYyRpbmNybmcpIDwtICBjKCJVbmRlciAyNWsiLCAiMjVrLTUwayIsICI1MGstNzVrIiwgIjc1ay0xMDBrIikNCmhlYWQoZGF0MmMpDQoNCmdncGxvdChkYXQyYywgYWVzKHggPSBGLCB5ID0gTSkpICsgZ2VvbV9wb2ludChhbHBoYT0wLjIsIHBjaD0yMCkgKw0KICAgICAgIGdlb21fc21vb3RoKG1ldGhvZCA9ICJsbSIsIGNvbCA9ICJyZWQiKSArDQogICAgICAgZmFjZXRfZ3JpZCggLiB+IGluY3JuZykgDQoNCnAxIDwtIGdncGxvdChkYXQxbDIsIGFlcyh4ID0gWWVhciwgeSA9IFlpZWxkLCBjb2xvciA9IENyb3ApKSArIGdlb21fbGluZSgpICsgDQogIGZhY2V0X3dyYXAoIH4gQ291bnRyeSwgbnJvdyA9IDEpICsNCiAgc2NhbGVfeV9jb250aW51b3VzKGxhYmVscyA9IHNjYWxlczo6Y29tbWFfZm9ybWF0KCkpDQoNCmdnc2F2ZSgiRmlndXJlcy9maWcwLnBuZyIsIHBsb3QgPSBwMSwgd2lkdGggPSA2LCBoZWlnaHQgPSAyLCB1bml0cyA9ICJpbiIsIGRldmljZSA9ICJwbmciKQ0KDQpwMiA8LSBnZ3Bsb3QoZGF0MWwyLCBhZXMoeCA9IFllYXIsIHkgPSBZaWVsZCwgY29sb3IgPSBDcm9wKSkgKyBnZW9tX2xpbmUoKSArIA0KICBmYWNldF93cmFwKCB+IENvdW50cnksIG5yb3cgPSAxKSArDQogIHNjYWxlX3lfY29udGludW91cyhsYWJlbHMgPSBzY2FsZXM6OmNvbW1hX2Zvcm1hdCgpKSArDQogIHRoZW1lKGF4aXMudGV4dCAgICA9IGVsZW1lbnRfdGV4dChzaXplID0gOCwgZmFtaWx5ID0gIm1vbm8iKSwNCiAgICAgICAgYXhpcy50aXRsZSAgID0gZWxlbWVudF90ZXh0KHNpemUgPSAxMSwgZmFjZSA9ICJib2xkIiksDQogICAgICAgIHN0cmlwLnRleHQgICA9IGVsZW1lbnRfdGV4dChzaXplID0gMTEsIGZhY2U9Iml0YWxpYyIsIGZhbWlseSA9ICJzZXJpZiIpLA0KICAgICAgICBsZWdlbmQudGl0bGUgPSBlbGVtZW50X3RleHQoc2l6ZSA9IDEwLCBmYW1pbHkgPSAic2FucyIpLA0KICAgICAgICBsZWdlbmQudGV4dCAgPSBlbGVtZW50X3RleHQoc2l6ZSA9IDgsICBjb2xvciA9ICJncmV5NDAiKSkNCg0KZ2dzYXZlKCJGaWd1cmVzL2ZpZzEucG5nIiwgcGxvdCA9IHAyLCB3aWR0aCA9IDYsIGhlaWdodCA9IDIsIHVuaXRzID0gImluIikNCmBgYHsuciAuZGlzdGlsbC1mb3JjZS1oaWdobGlnaHRpbmctY3NzfQ0KYGBgDQo=" download="graphics.R">Download graphics.R</a></p>
</div>
<h1 id="base-plot"><code>base</code> plot</h1>
<h2 id="point-and-line-plots">Point and line plots</h2>
<h3 id="basics">Basics</h3>
<p>The most intuitive plot function in R is <code>plot</code> which generates both points and line plots. For example, to plot <code>Petal.Length</code>, <code>Petal.Width</code>, or <code>Petal.Length</code> vs <code>Petal.Width</code> we can do:</p>
<ul>
<li>Index observations</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>iris</span><span class='op'>$</span><span class='va'>Petal.Length</span><span class='op'>)</span> <span class='co'># index observation for Petal.Length</span>
</code></pre>
</div>
<img src="graphics_files/figure-html5/unnamed-chunk-4-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>iris</span><span class='op'>$</span><span class='va'>Petal.Width</span><span class='op'>)</span> <span class='co'># index observation for Petal.Width</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-4-2.png" width="624" /></p>
</div>
<ul>
<li>Scatter plots</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>Petal.Length</span> <span class='op'>~</span> <span class='va'>Petal.Width</span>, data <span class='op'>=</span> <span class='va'>iris</span><span class='op'>)</span> <span class='co'># pairwise</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-5-1.png" width="624" /></p>
</div>
<h3 id="customization">Customization</h3>
<p>The latest takes two arguments: Petal.Length ~ Petal.Width which is to be read as plotting the variable <code>Petal.Length</code> as a function of <code>Petal.Width</code>. <strong>Argument</strong> <code>data</code> indicates the plot function from which data frame to extract the variables Another way to call this command is to type:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>iris</span><span class='op'>$</span><span class='va'>Petal.Length</span> <span class='op'>~</span> <span class='va'>iris</span><span class='op'>$</span><span class='va'>Petal.Width</span><span class='op'>)</span> <span class='co'># using the $ operator</span>
</code></pre>
</div>
</div>
<p>The <code>plot</code> function can take on many other arguments to help customize the default plot options. For example, we may want to change the axis labels to something more descriptive than the simple variable name:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># add labels to x- and y-axes, title </span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>Petal.Length</span> <span class='op'>~</span> <span class='va'>Petal.Width</span>, data <span class='op'>=</span> <span class='va'>iris</span>,
     xlab <span class='op'>=</span> <span class='st'>'Petal width (cm)'</span>, 
     ylab <span class='op'>=</span> <span class='st'>'Petal length (cm)'</span>,
     main <span class='op'>=</span> <span class='st'>'Petal width &amp; length of iris flower'</span><span class='op'>)</span> 
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-7-1.png" width="624" /></p>
</div>
<p>We can change the symbole type using argument <code>pch</code> (<strong>p</strong>lotting <strong>ch</strong>aracter’, see <code>?pch</code> for options). <code>pch = 19</code> will produce a solid circle. The argument <code>cex</code> will control his size (character <strong>exp</strong>ansion). We can also set its <strong>col</strong>ors to be 90% transparent (10% opaque) using expression <code>col = rgb (0,0,0,0.10)</code>. The <code>rgb</code> function defines the intensity for each of the display primary colors (on a scale of 0 to 1). The primary colors are <strong>red</strong>, <strong>green</strong> and <strong>blue</strong>. The forth value is optional and provides the fraction opaqueness (or transparency) with a value of 1 being completely opaque.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>Petal.Length</span> <span class='op'>~</span> <span class='va'>Petal.Width</span>, data <span class='op'>=</span> <span class='va'>iris</span>,
     xlab <span class='op'>=</span> <span class='st'>'Petal width (cm)'</span>, 
     ylab <span class='op'>=</span> <span class='st'>'Petal length (cm)'</span>, 
     main <span class='op'>=</span> <span class='st'>'Petal width and length of iris flower'</span>,
     pch <span class='op'>=</span> <span class='fl'>19</span>, cex<span class='op'>=</span><span class='fl'>2</span>, 
     col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/rgb.html'>rgb</a></span> <span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0.10</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-8-1.png" width="624" /></p>
</div>
<p>Now it is time to combine this with what we previously learned on conditional selection. How to add different colors for the three different species. Remember the <code>ifelse</code>?</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># create a vector of character with color names</span>
<span class='va'>col.iris</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>iris</span><span class='op'>$</span><span class='va'>Species</span><span class='op'>==</span><span class='st'>'setosa'</span>,<span class='st'>'purple'</span>,<span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>iris</span><span class='op'>$</span><span class='va'>Species</span><span class='op'>==</span><span class='st'>'versicolor'</span>,<span class='st'>'blue'</span>,<span class='st'>'pink'</span><span class='op'>)</span><span class='op'>)</span> 
<span class='va'>col.iris</span>
</code></pre>
</div>
<pre><code>  [1] &quot;purple&quot; &quot;purple&quot; &quot;purple&quot; &quot;purple&quot; &quot;purple&quot; &quot;purple&quot; &quot;purple&quot;
  [8] &quot;purple&quot; &quot;purple&quot; &quot;purple&quot; &quot;purple&quot; &quot;purple&quot; &quot;purple&quot; &quot;purple&quot;
 [15] &quot;purple&quot; &quot;purple&quot; &quot;purple&quot; &quot;purple&quot; &quot;purple&quot; &quot;purple&quot; &quot;purple&quot;
 [22] &quot;purple&quot; &quot;purple&quot; &quot;purple&quot; &quot;purple&quot; &quot;purple&quot; &quot;purple&quot; &quot;purple&quot;
 [29] &quot;purple&quot; &quot;purple&quot; &quot;purple&quot; &quot;purple&quot; &quot;purple&quot; &quot;purple&quot; &quot;purple&quot;
 [36] &quot;purple&quot; &quot;purple&quot; &quot;purple&quot; &quot;purple&quot; &quot;purple&quot; &quot;purple&quot; &quot;purple&quot;
 [43] &quot;purple&quot; &quot;purple&quot; &quot;purple&quot; &quot;purple&quot; &quot;purple&quot; &quot;purple&quot; &quot;purple&quot;
 [50] &quot;purple&quot; &quot;blue&quot;   &quot;blue&quot;   &quot;blue&quot;   &quot;blue&quot;   &quot;blue&quot;   &quot;blue&quot;  
 [57] &quot;blue&quot;   &quot;blue&quot;   &quot;blue&quot;   &quot;blue&quot;   &quot;blue&quot;   &quot;blue&quot;   &quot;blue&quot;  
 [64] &quot;blue&quot;   &quot;blue&quot;   &quot;blue&quot;   &quot;blue&quot;   &quot;blue&quot;   &quot;blue&quot;   &quot;blue&quot;  
 [71] &quot;blue&quot;   &quot;blue&quot;   &quot;blue&quot;   &quot;blue&quot;   &quot;blue&quot;   &quot;blue&quot;   &quot;blue&quot;  
 [78] &quot;blue&quot;   &quot;blue&quot;   &quot;blue&quot;   &quot;blue&quot;   &quot;blue&quot;   &quot;blue&quot;   &quot;blue&quot;  
 [85] &quot;blue&quot;   &quot;blue&quot;   &quot;blue&quot;   &quot;blue&quot;   &quot;blue&quot;   &quot;blue&quot;   &quot;blue&quot;  
 [92] &quot;blue&quot;   &quot;blue&quot;   &quot;blue&quot;   &quot;blue&quot;   &quot;blue&quot;   &quot;blue&quot;   &quot;blue&quot;  
 [99] &quot;blue&quot;   &quot;blue&quot;   &quot;pink&quot;   &quot;pink&quot;   &quot;pink&quot;   &quot;pink&quot;   &quot;pink&quot;  
[106] &quot;pink&quot;   &quot;pink&quot;   &quot;pink&quot;   &quot;pink&quot;   &quot;pink&quot;   &quot;pink&quot;   &quot;pink&quot;  
[113] &quot;pink&quot;   &quot;pink&quot;   &quot;pink&quot;   &quot;pink&quot;   &quot;pink&quot;   &quot;pink&quot;   &quot;pink&quot;  
[120] &quot;pink&quot;   &quot;pink&quot;   &quot;pink&quot;   &quot;pink&quot;   &quot;pink&quot;   &quot;pink&quot;   &quot;pink&quot;  
[127] &quot;pink&quot;   &quot;pink&quot;   &quot;pink&quot;   &quot;pink&quot;   &quot;pink&quot;   &quot;pink&quot;   &quot;pink&quot;  
[134] &quot;pink&quot;   &quot;pink&quot;   &quot;pink&quot;   &quot;pink&quot;   &quot;pink&quot;   &quot;pink&quot;   &quot;pink&quot;  
[141] &quot;pink&quot;   &quot;pink&quot;   &quot;pink&quot;   &quot;pink&quot;   &quot;pink&quot;   &quot;pink&quot;   &quot;pink&quot;  
[148] &quot;pink&quot;   &quot;pink&quot;   &quot;pink&quot;  </code></pre>
</div>
<p>We can insert this color vector in the argument <code>col</code> and controlling its opacity with the <code>alpha</code> function from the package <code>scales</code>. You can guess the argument <code>col</code> can accept a vector of character with just the name of color instead of a <code>rgb</code> code.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://scales.r-lib.org'>scales</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>Petal.Length</span> <span class='op'>~</span> <span class='va'>Petal.Width</span>, data <span class='op'>=</span> <span class='va'>iris</span>,
     xlab <span class='op'>=</span> <span class='st'>'Petal width (cm)'</span>, 
     ylab <span class='op'>=</span> <span class='st'>'Petal length (cm)'</span>, 
     main <span class='op'>=</span> <span class='st'>'Petal width and length of iris flower'</span>,
     pch <span class='op'>=</span> <span class='fl'>19</span>, cex<span class='op'>=</span><span class='fl'>2</span>, 
     col <span class='op'>=</span> <span class='fu'><a href='https://scales.r-lib.org/reference/alpha.html'>alpha</a></span><span class='op'>(</span><span class='va'>col.iris</span>, <span class='fl'>0.2</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-10-1.png" width="624" /></p>
</div>
<p>We now must add a legend to our plot. Observe the conversion of the color list into a factor, and the extraction of levels in the <code>col</code> argument.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>Petal.Length</span> <span class='op'>~</span> <span class='va'>Petal.Width</span>, dat <span class='op'>=</span> <span class='va'>iris</span>,
     xlab <span class='op'>=</span> <span class='st'>'Petal width (cm)'</span>, 
     ylab <span class='op'>=</span> <span class='st'>'Petal length (cm)'</span>, 
     main <span class='op'>=</span> <span class='st'>'Petal width and length of iris flower'</span>,
     pch <span class='op'>=</span> <span class='fl'>19</span>, cex<span class='op'>=</span><span class='fl'>2</span>, 
     col <span class='op'>=</span> <span class='fu'><a href='https://scales.r-lib.org/reference/alpha.html'>alpha</a></span><span class='op'>(</span><span class='va'>col.iris</span>, <span class='fl'>0.2</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='st'>"bottomright"</span>, pch<span class='op'>=</span> <span class='fl'>19</span>, cex<span class='op'>=</span><span class='fl'>1.5</span>, legend<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"versicolor"</span>,<span class='st'>"setosa"</span>, <span class='st'>"virginica"</span><span class='op'>)</span>, col<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='fu'><a href='https://scales.r-lib.org/reference/alpha.html'>alpha</a></span><span class='op'>(</span><span class='va'>col.iris</span>, <span class='fl'>0.2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-11-1.png" width="624" /></p>
</div>
<p>The argument <code>las=1</code> will rotate y-axis labels. This is often a requirement for publication quality plots.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>Petal.Length</span> <span class='op'>~</span> <span class='va'>Petal.Width</span>, dat <span class='op'>=</span> <span class='va'>iris</span>,
     xlab <span class='op'>=</span> <span class='st'>'Petal width (cm)'</span>, 
     ylab <span class='op'>=</span> <span class='st'>'Petal length (cm)'</span>, 
     main <span class='op'>=</span> <span class='st'>'Petal width and length of iris flower'</span>,
     pch <span class='op'>=</span> <span class='fl'>19</span>, cex<span class='op'>=</span><span class='fl'>2</span>, las<span class='op'>=</span><span class='fl'>1</span>,
     col <span class='op'>=</span> <span class='fu'><a href='https://scales.r-lib.org/reference/alpha.html'>alpha</a></span><span class='op'>(</span><span class='va'>col.iris</span>, <span class='fl'>0.2</span><span class='op'>)</span><span class='op'>)</span> 

<span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='st'>"bottomright"</span>, pch<span class='op'>=</span> <span class='fl'>19</span>, cex<span class='op'>=</span><span class='fl'>1.5</span>, legend<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"versicolor"</span>,<span class='st'>"setosa"</span>, <span class='st'>"virginica"</span><span class='op'>)</span>, col<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='fu'><a href='https://scales.r-lib.org/reference/alpha.html'>alpha</a></span><span class='op'>(</span><span class='va'>col.iris</span>, <span class='fl'>0.2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-12-1.png" width="624" /></p>
</div>
<p>The size of the main title, axis, labels is also control with <code>cex</code> arguments</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>Petal.Length</span> <span class='op'>~</span> <span class='va'>Petal.Width</span>, dat <span class='op'>=</span> <span class='va'>iris</span>,
     xlab <span class='op'>=</span> <span class='st'>'Petal width (cm)'</span>, 
     ylab <span class='op'>=</span> <span class='st'>'Petal length (cm)'</span>, 
     main <span class='op'>=</span> <span class='st'>'Petal width and length of iris flower'</span>,
     cex.axis<span class='op'>=</span><span class='fl'>1.0</span>, cex.lab<span class='op'>=</span><span class='fl'>1.5</span>, cex.main<span class='op'>=</span><span class='fl'>1.5</span>,
     pch <span class='op'>=</span> <span class='fl'>19</span>, cex<span class='op'>=</span><span class='fl'>2</span>, las<span class='op'>=</span><span class='fl'>1</span>,
     col <span class='op'>=</span> <span class='fu'><a href='https://scales.r-lib.org/reference/alpha.html'>alpha</a></span><span class='op'>(</span><span class='va'>col.iris</span>, <span class='fl'>0.2</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='st'>"bottomright"</span>, pch<span class='op'>=</span> <span class='fl'>19</span>, cex<span class='op'>=</span><span class='fl'>1.5</span>, legend<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"versicolor"</span>,<span class='st'>"setosa"</span>, <span class='st'>"virginica"</span><span class='op'>)</span>, col<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='fu'><a href='https://scales.r-lib.org/reference/alpha.html'>alpha</a></span><span class='op'>(</span><span class='va'>col.iris</span>, <span class='fl'>0.2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-13-1.png" width="624" /></p>
</div>
<p>The size of the points can be set as a proportion of a given continuous variable</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ratio</span><span class='op'>&lt;-</span><span class='va'>iris</span><span class='op'>$</span><span class='va'>Petal.Length</span><span class='op'>/</span><span class='va'>iris</span><span class='op'>$</span><span class='va'>Sepal.Width</span>  <span class='co'># ratio between the length of petal and the width of Sepal</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>Petal.Length</span> <span class='op'>~</span> <span class='va'>Petal.Width</span>, dat <span class='op'>=</span> <span class='va'>iris</span>,
     xlab <span class='op'>=</span> <span class='st'>'Petal width (cm)'</span>, 
     ylab <span class='op'>=</span> <span class='st'>'Petal length (cm)'</span>, 
     main <span class='op'>=</span> <span class='st'>'Petal width and length of iris flower'</span>,
     cex.axis<span class='op'>=</span><span class='fl'>1.0</span>, cex.lab<span class='op'>=</span><span class='fl'>1.5</span>, cex.main<span class='op'>=</span><span class='fl'>1.5</span>,
     pch <span class='op'>=</span> <span class='fl'>19</span>, las<span class='op'>=</span><span class='fl'>1</span>, cex<span class='op'>=</span> <span class='va'>ratio</span> <span class='op'>*</span> <span class='fl'>2</span>, 
     col <span class='op'>=</span> <span class='fu'><a href='https://scales.r-lib.org/reference/alpha.html'>alpha</a></span><span class='op'>(</span><span class='va'>col.iris</span>, <span class='fl'>0.2</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='st'>"bottomright"</span>, pch<span class='op'>=</span> <span class='fl'>19</span>, cex<span class='op'>=</span><span class='fl'>1.5</span>, legend<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"versicolor"</span>,<span class='st'>"setosa"</span>, <span class='st'>"virginica"</span><span class='op'>)</span>, col<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='fu'><a href='https://scales.r-lib.org/reference/alpha.html'>alpha</a></span><span class='op'>(</span><span class='va'>col.iris</span>, <span class='fl'>0.2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-14-1.png" width="624" /></p>
</div>
<p>It looks like the variable<code>Sepal.Width</code> is poorly informative in discriminating the three species.</p>
<p>The function <code>pairs</code> allows a quick examination of the relationship among variables of interest: a scatterplot matrix.</p>
<h3 id="types">Types</h3>
<h4 id="panel-plot">Panel plot</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/pairs.html'>pairs</a></span><span class='op'>(</span><span class='va'>iris</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>4</span><span class='op'>]</span>, pch<span class='op'>=</span><span class='fl'>19</span>, col <span class='op'>=</span> <span class='fu'><a href='https://scales.r-lib.org/reference/alpha.html'>alpha</a></span><span class='op'>(</span><span class='va'>col.iris</span>, <span class='fl'>0.2</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-15-1.png" width="624" /></p>
</div>
<h4 id="line-plot">Line plot</h4>
<p>A conversion to a line plot is easily made by specifying the <code>type</code> of plot.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># generate a data frame with chronological variable</span>
<span class='va'>blossom</span><span class='op'>&lt;-</span><span class='cn'>NULL</span>
<span class='va'>blossom</span><span class='op'>$</span><span class='va'>year</span> <span class='op'>&lt;-</span> <span class='fl'>2010</span><span class='op'>:</span><span class='fl'>2019</span>                                               <span class='co'># </span>
<span class='va'>blossom</span><span class='op'>$</span><span class='va'>count.alaska</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>, <span class='fl'>1</span>, <span class='fl'>5</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>8</span>, <span class='fl'>4</span>, <span class='fl'>7</span>, <span class='fl'>6</span>, <span class='fl'>9</span><span class='op'>)</span>
<span class='va'>blossom</span><span class='op'>$</span><span class='va'>count.canada</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4</span>, <span class='fl'>6</span>, <span class='fl'>5</span>, <span class='fl'>7</span>, <span class='fl'>10</span>, <span class='fl'>8</span>, <span class='fl'>10</span>, <span class='fl'>11</span>, <span class='fl'>15</span>, <span class='fl'>17</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='va'>blossom</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>   year count.alaska count.canada
1  2010            3            4
2  2011            1            6
3  2012            5            5
4  2013            2            7
5  2014            3           10
6  2015            8            8
7  2016            4           10
8  2017            7           11
9  2018            6           15
10 2019            9           17</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>count.alaska</span> <span class='op'>~</span> <span class='va'>year</span>,dat <span class='op'>=</span> <span class='va'>blossom</span>, type<span class='op'>=</span><span class='st'>'l'</span>,
      ylab <span class='op'>=</span> <span class='st'>"No. of flower blossoming"</span><span class='op'>)</span> 
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-16-1.png" width="624" /></p>
</div>
<p>To plot both points and line, set the type parameter to “b” (for both). We’ll also set the point symbol to 20.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>count.alaska</span> <span class='op'>~</span> <span class='va'>year</span>,dat <span class='op'>=</span> <span class='va'>blossom</span>, type<span class='op'>=</span><span class='st'>'b'</span>, pch<span class='op'>=</span><span class='fl'>20</span>,
      ylab <span class='op'>=</span> <span class='st'>"No. of flower blossoming"</span><span class='op'>)</span> 
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-17-1.png" width="624" /></p>
</div>
<p>We can rotate the axis, increase the width of the line, change its type and color:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>count.alaska</span> <span class='op'>~</span> <span class='va'>year</span>,dat <span class='op'>=</span> <span class='va'>blossom</span>, type<span class='op'>=</span><span class='st'>'b'</span>, pch<span class='op'>=</span><span class='fl'>20</span>,
     lty<span class='op'>=</span><span class='fl'>2</span>, lwd<span class='op'>=</span><span class='fl'>0.5</span>, col<span class='op'>=</span><span class='st'>'red'</span>,
     ylab <span class='op'>=</span> <span class='st'>"No. of flower blossoming"</span><span class='op'>)</span> 
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-18-1.png" width="624" /></p>
</div>
<p>We can add the other variable by adding a line of another type and color:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>count.alaska</span> <span class='op'>~</span> <span class='va'>year</span>,dat <span class='op'>=</span> <span class='va'>blossom</span>, type<span class='op'>=</span><span class='st'>'b'</span>, pch<span class='op'>=</span><span class='fl'>20</span>,
     lty<span class='op'>=</span><span class='fl'>2</span>, lwd<span class='op'>=</span><span class='fl'>0.5</span>, col<span class='op'>=</span><span class='st'>'red'</span>,
     ylab <span class='op'>=</span> <span class='st'>"No. of flower blossoming"</span><span class='op'>)</span> 
<span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>count.canada</span> <span class='op'>~</span> <span class='va'>year</span>,dat <span class='op'>=</span> <span class='va'>blossom</span>, type<span class='op'>=</span><span class='st'>'b'</span>, pch<span class='op'>=</span><span class='fl'>20</span>,
     lty<span class='op'>=</span><span class='fl'>3</span>, lwd<span class='op'>=</span><span class='fl'>0.5</span>, col<span class='op'>=</span><span class='st'>'blue'</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-19-1.png" width="624" /></p>
</div>
<p>The plot is a static object meaning that we need to define the axes limits before calling the original plot function. Both axes limits can be set using the <code>xlim</code> and <code>ylim</code> parameters. We don’t need to set the x-axis range since both variables cover the same year range. We will therefore only focus on the y-axis limits. We can grab both the minimum and maximum values for the variables <code>count.alaska</code> and <code>count.canada</code> using the <code>range</code> function, then pass the range to the <code>ylim</code> parameter in the call to plot.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>y.rng</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>blossom</span><span class='op'>$</span><span class='va'>count.alaska</span>, <span class='va'>blossom</span><span class='op'>$</span><span class='va'>count.canada</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>count.alaska</span> <span class='op'>~</span> <span class='va'>year</span>,dat <span class='op'>=</span> <span class='va'>blossom</span>, type<span class='op'>=</span><span class='st'>'l'</span>, ylim <span class='op'>=</span> <span class='va'>y.rng</span>,
     lty<span class='op'>=</span><span class='fl'>2</span>, lwd<span class='op'>=</span><span class='fl'>1</span>, col<span class='op'>=</span><span class='st'>'red'</span>,
     ylab <span class='op'>=</span> <span class='st'>"No. of flower blossoming"</span><span class='op'>)</span> 
<span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>count.canada</span> <span class='op'>~</span> <span class='va'>year</span>,dat <span class='op'>=</span> <span class='va'>blossom</span>,
     lty<span class='op'>=</span><span class='fl'>1</span>, lwd<span class='op'>=</span><span class='fl'>1</span>, col<span class='op'>=</span><span class='st'>'blue'</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-20-1.png" width="624" /></p>
</div>
<p>Note: point plots from different variables can also be combined into a single plot using the <code>points</code> function instead of the <code>lines</code> function. Let’s get back to our iris dataset and build our plot sequentially for two species.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>iris.ver</span><span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>iris</span>, <span class='va'>Species</span> <span class='op'>==</span> <span class='st'>"versicolor"</span><span class='op'>)</span>
<span class='va'>iris.vir</span><span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>iris</span>, <span class='va'>Species</span> <span class='op'>==</span> <span class='st'>"virginica"</span><span class='op'>)</span>

<span class='va'>y.rng</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>iris.ver</span><span class='op'>$</span><span class='va'>Petal.Length</span>, <span class='va'>iris.vir</span><span class='op'>$</span><span class='va'>Petal.Length</span><span class='op'>)</span> , na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> 
<span class='va'>x.rng</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>iris.ver</span><span class='op'>$</span><span class='va'>Petal.Width</span>, <span class='va'>iris.vir</span><span class='op'>$</span><span class='va'>Petal.width</span><span class='op'>)</span> , na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> 

<span class='co'># Plot an empty plot</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>Petal.Length</span> <span class='op'>~</span> <span class='va'>Petal.Width</span>, dat <span class='op'>=</span> <span class='va'>iris.ver</span>,
     xlab <span class='op'>=</span> <span class='st'>'Petal width (cm)'</span>, 
     ylab <span class='op'>=</span> <span class='st'>'Petal length (cm)'</span>, 
     main <span class='op'>=</span> <span class='st'>'Petal width and length of iris flower'</span>,
     cex.axis<span class='op'>=</span><span class='fl'>1.0</span>, cex.lab<span class='op'>=</span><span class='fl'>1.5</span>, cex.main<span class='op'>=</span><span class='fl'>1.5</span>, type<span class='op'>=</span><span class='st'>'n'</span>,
     xlim<span class='op'>=</span><span class='va'>x.rng</span>,  ylim<span class='op'>=</span><span class='va'>y.rng</span><span class='op'>)</span>

<span class='co'># Add points for versicolor</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='va'>Petal.Length</span> <span class='op'>~</span> <span class='va'>Petal.Width</span>, dat <span class='op'>=</span> <span class='va'>iris.ver</span>, pch <span class='op'>=</span> <span class='fl'>20</span>,cex<span class='op'>=</span><span class='fl'>2</span>, 
       col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/rgb.html'>rgb</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>0.10</span><span class='op'>)</span><span class='op'>)</span>
       
<span class='co'># Add points for versicolor</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='va'>Petal.Length</span> <span class='op'>~</span> <span class='va'>Petal.Width</span>, dat <span class='op'>=</span> <span class='va'>iris.vir</span>, pch <span class='op'>=</span> <span class='fl'>20</span>,cex<span class='op'>=</span><span class='fl'>2</span>, 
      col <span class='op'>=</span>  <span class='fu'><a href='https://scales.r-lib.org/reference/alpha.html'>alpha</a></span><span class='op'>(</span><span class='st'>'#fc03c6'</span>, <span class='fl'>0.2</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># Add legend</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span><span class='op'>(</span><span class='st'>"topleft"</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"versicolor"</span>, <span class='st'>"virginica"</span><span class='op'>)</span>, pch <span class='op'>=</span> <span class='fl'>19</span>, cex<span class='op'>=</span><span class='fl'>1.2</span>,
       col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/grDevices/rgb.html'>rgb</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>0.10</span><span class='op'>)</span>, <span class='fu'><a href='https://scales.r-lib.org/reference/alpha.html'>alpha</a></span><span class='op'>(</span><span class='st'>'#fc03c6'</span>, <span class='fl'>0.2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-21-1.png" width="624" /></p>
</div>
<p>Note 1: that <code>na.rm=T</code> is added in the <code>range</code> function to prevent <code>NA</code> value in the data from returning an <code>NA</code> value in the range.</p>
<p>Note 2: You can define the color using the <code>rgb</code> function, or by color name such as <code>col = "red"</code> or <code>col = "bisque"</code>. For a full list of color names, type colors() at a command prompt. You can also the hexadecimal code of the color. Google “color picker”. Color gradient can easily be created and personalized <a href="https://www.webfx.com/web-design/color-picker/">here</a> and in many other websites.</p>
<h4 id="box-plot">Box plot</h4>
<p>A boxplot is one of many graphical tools used to summarize the distribution of a data batch: behind the simple visualization, it inform on the data themselves. The graphic consists of a “box” that depicts the range covered by 50% of the data (<em>aka</em> the interquartile range, IQR), a horizontal line that displays the median, and “whiskers” that depict 1.5 times the IQR or the largest (for the top half) or smallest (for the bottom half) values.</p>
<p>For example, we can summarize the width of the sepal for all individuals in our iris dataset:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/boxplot.html'>boxplot</a></span><span class='op'>(</span><span class='va'>iris</span><span class='op'>$</span><span class='va'>Sepal.Width</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-22-1.png" width="624" /></p>
</div>
<p>Several variables can be summarized on the same plot.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/boxplot.html'>boxplot</a></span><span class='op'>(</span><span class='va'>iris</span><span class='op'>$</span><span class='va'>Sepal.Width</span>,<span class='va'>iris</span><span class='op'>$</span><span class='va'>Sepal.Length</span>, <span class='va'>iris</span><span class='op'>$</span><span class='va'>Petal.Width</span>,<span class='va'>iris</span><span class='op'>$</span><span class='va'>Petal.Length</span>, names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Sepal.Width"</span>, <span class='st'>"Sepal.Length"</span>, <span class='st'>"Petal.Length"</span>,<span class='st'>"Petal.Width"</span><span class='op'>)</span>, main <span class='op'>=</span> <span class='st'>"Iris flower traits"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-23-1.png" width="624" /></p>
</div>
<p>The <code>names</code> argument labels the x-axis and the <code>main</code> argument labels the plot title. The outliers can be removed from the plot, if desired, by setting the <code>outline</code> parameter to FALSE. The boxplot graph can also be plotted horizontally by setting the <code>horizontal</code> parameter to <code>TRUE</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/boxplot.html'>boxplot</a></span><span class='op'>(</span><span class='va'>iris</span><span class='op'>$</span><span class='va'>Sepal.Width</span>,<span class='va'>iris</span><span class='op'>$</span><span class='va'>Sepal.Length</span>, <span class='va'>iris</span><span class='op'>$</span><span class='va'>Petal.Width</span>,<span class='va'>iris</span><span class='op'>$</span><span class='va'>Petal.Length</span>, names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Sepal.Width"</span>, <span class='st'>"Sepal.Length"</span>, <span class='st'>"Petal.Length"</span>,<span class='st'>"Petal.Width"</span><span class='op'>)</span>, main <span class='op'>=</span> <span class='st'>"Iris flower traits"</span>,outline <span class='op'>=</span> <span class='cn'>FALSE</span>, horizontal <span class='op'>=</span> <span class='cn'>TRUE</span> <span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-24-1.png" width="624" /></p>
</div>
<p>Using a long version of a table (<code>pivot_longer</code>), the variable can be summarized by the levels of a factor, here the <code>Species</code> levels</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/boxplot.html'>boxplot</a></span><span class='op'>(</span><span class='va'>Sepal.Width</span> <span class='op'>~</span> <span class='va'>Species</span>,<span class='va'>iris</span><span class='op'>)</span> 
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-25-1.png" width="624" /></p>
</div>
<p>We can <code>reorder</code> the boxplots based on the median value. By default, <code>boxplot</code> will order the boxplots following the factor’s level order.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>iris</span><span class='op'>$</span><span class='va'>Species.ord</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/reorder.factor.html'>reorder</a></span><span class='op'>(</span><span class='va'>iris</span><span class='op'>$</span><span class='va'>Species</span>,<span class='va'>iris</span><span class='op'>$</span><span class='va'>Sepal.Width</span>, <span class='va'>median</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='va'>iris</span><span class='op'>$</span><span class='va'>Species.ord</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;versicolor&quot; &quot;virginica&quot;  &quot;setosa&quot;    </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/boxplot.html'>boxplot</a></span><span class='op'>(</span><span class='va'>Sepal.Width</span> <span class='op'>~</span> <span class='va'>Species.ord</span>, <span class='va'>iris</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-26-1.png" width="624" /></p>
</div>
<h4 id="histogram-plot">Histogram plot</h4>
<p>The histogram is another form of data distribution visualization. It consists of partitioning a batch of values into intervals of equal length then tallying their count in each interval. The height of each bar represents these counts. For example, we can plot the histogram of the width od sepal using the <code>hist</code> function as follows:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span><span class='va'>iris</span><span class='op'>$</span><span class='va'>Sepal.Width</span>, xlab <span class='op'>=</span> <span class='st'>"Width of Sepal"</span>, main <span class='op'>=</span> <span class='cn'>NA</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-27-1.png" width="624" /></p>
</div>
<p>To control the number of bins add the <code>breaks</code> argument. The <code>breaks</code> argument can be passed different types of values. The simplest value is the desired number of bins. Note, however, that you might not necessarily get the number of bins defined with the <code>breaks</code> argument.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span><span class='va'>iris</span><span class='op'>$</span><span class='va'>Sepal.Width</span>, xlab <span class='op'>=</span> <span class='st'>"Width of Sepal"</span>, main <span class='op'>=</span> <span class='cn'>NA</span>, breaks<span class='op'>=</span><span class='fl'>10</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-28-1.png" width="624" /></p>
</div>
<p>The documentation states that the breaks value “<strong>is a suggestion only as the breakpoints will be set to <code>pretty</code> values</strong>”. <code>pretty</code> refers to a function that rounds values to powers of 1, 2 or 5 times a power of 10.</p>
<p>If you want total control of the bin numbers, manually create the breaks as follows:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>n</span> <span class='op'>&lt;-</span> <span class='fl'>10</span>  <span class='co'># Define the number of bin</span>
<span class='va'>minx</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>iris</span><span class='op'>$</span><span class='va'>Sepal.Width</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>maxx</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>iris</span><span class='op'>$</span><span class='va'>Sepal.Width</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>bins</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='va'>minx</span>, <span class='va'>maxx</span>, length.out <span class='op'>=</span> <span class='va'>n</span> <span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span><span class='va'>iris</span><span class='op'>$</span><span class='va'>Sepal.Width</span>, xlab <span class='op'>=</span> <span class='st'>"Width of Sepal"</span>, main <span class='op'>=</span> <span class='cn'>NA</span>, breaks <span class='op'>=</span> <span class='va'>bins</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-29-1.png" width="624" /></p>
</div>
<h4 id="density-plot">Density plot</h4>
<p>Histograms have their pitfalls. For example, the number of bins can drastically affect the appearance of a distribution. One alternative is the density plot which, for a series of x-values, computes the density of observations at each x-value. This generates a “smoothed” distribution of values.</p>
<p>Unlike the other plotting functions, <code>density</code> does not generate a plot but a list object instead. But the output of <code>density</code> can be wrapped with a <code>plot</code> function to generate the plot.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dens</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span><span class='op'>(</span><span class='va'>iris</span><span class='op'>$</span><span class='va'>Sepal.Width</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>dens</span>, main <span class='op'>=</span> <span class='st'>"Density distribution of the width of sepal"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-30-1.png" width="624" /></p>
</div>
<p>You can control the bandwidth using the <code>bw</code> argument. For example:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dens</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span><span class='op'>(</span><span class='va'>iris</span><span class='op'>$</span><span class='va'>Sepal.Width</span>, bw<span class='op'>=</span><span class='fl'>0.05</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>dens</span>, main <span class='op'>=</span> <span class='st'>"Density distribution of the width of sepal"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-31-1.png" width="624" /></p>
</div>
<p>The bandwidth parameter adopts the variable’s units.</p>
<h4 id="qq-plot">QQ plot</h4>
<p>This is an important plot called by the function <code>qqnorm</code> to examine the normality of a variable. A <code>qqline</code> can be added to represent a “theoretical”, by default normal, quantile-quantile plot.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/qqnorm.html'>qqnorm</a></span><span class='op'>(</span><span class='va'>iris</span><span class='op'>$</span><span class='va'>Sepal.Width</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/qqnorm.html'>qqline</a></span><span class='op'>(</span><span class='va'>iris</span><span class='op'>$</span><span class='va'>Sepal.Width</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p class="comment">
<strong>Practice 1:</strong> Using <code>rairuoho</code> dataset, examine the relationship between the length of the plant at <code>day3</code> and the length at <code>day7</code>: create a scatterplot. Examine if the length at <code>day7</code> is pretty normal (i.e. following a normal distribution, not just your feeling): you will use <code>hist</code>, a <code>density</code> plot and <code>qqnorm</code>. How does the<code>treatment</code> affect the length at day7: make a <code>boxplot</code>.Make a comparison of the length of the plant between each day using function <code>pairs</code>.
</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show Solution
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>rairuoho</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.table</a></span><span class='op'>(</span><span class='st'>'Data/rairuoho.txt'</span>,header<span class='op'>=</span><span class='cn'>T</span>, sep<span class='op'>=</span><span class='st'>"\t"</span>, dec<span class='op'>=</span><span class='st'>"."</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>day3</span> <span class='op'>~</span> <span class='va'>day7</span>,dat<span class='op'>=</span><span class='va'>rairuoho</span>,
    xlab <span class='op'>=</span> <span class='st'>'Length at day 3'</span>, 
    ylab <span class='op'>=</span> <span class='st'>'Length at day 7'</span>, 
    main <span class='op'>=</span> <span class='st'>'Realtionship between the length at day 3 and day 7'</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span><span class='va'>rairuoho</span><span class='op'>$</span><span class='va'>day7</span><span class='op'>)</span>
<span class='va'>dens.rai</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span><span class='op'>(</span><span class='va'>rairuoho</span><span class='op'>$</span><span class='va'>day7</span>, bw<span class='op'>=</span><span class='fl'>6</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>dens.rai</span>, main <span class='op'>=</span> <span class='st'>"Density distribution of the length at day 7"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/qqnorm.html'>qqnorm</a></span><span class='op'>(</span><span class='va'>rairuoho</span><span class='op'>$</span><span class='va'>day7</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/qqnorm.html'>qqline</a></span><span class='op'>(</span><span class='va'>rairuoho</span><span class='op'>$</span><span class='va'>day7</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/boxplot.html'>boxplot</a></span><span class='op'>(</span><span class='va'>day7</span><span class='op'>~</span><span class='va'>treatment</span>, data<span class='op'>=</span><span class='va'>rairuoho</span><span class='op'>)</span> 
<span class='fu'><a href='https://rdrr.io/r/graphics/pairs.html'>pairs</a></span><span class='op'>(</span><span class='va'>rairuoho</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>:</span><span class='fl'>6</span><span class='op'>]</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h1 id="settings">Settings</h1>
<p>See the current graphical settings using:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span><span class='op'>)</span> <span class='co'># graphical options</span>
</code></pre>
</div>
<pre><code>$xlog
[1] FALSE

$ylog
[1] FALSE

$adj
[1] 0.5

$ann
[1] TRUE

$ask
[1] FALSE

$bg
[1] &quot;white&quot;

$bty
[1] &quot;o&quot;

$cex
[1] 1

$cex.axis
[1] 1

$cex.lab
[1] 1

$cex.main
[1] 1.2

$cex.sub
[1] 1

$cin
[1] 0.15 0.20

$col
[1] &quot;black&quot;

$col.axis
[1] &quot;black&quot;

$col.lab
[1] &quot;black&quot;

$col.main
[1] &quot;black&quot;

$col.sub
[1] &quot;black&quot;

$cra
[1] 28.8 38.4

$crt
[1] 0

$csi
[1] 0.2

$cxy
[1] 0.02851711 0.09259261

$din
[1] 6.499999 3.999999

$err
[1] 0

$family
[1] &quot;&quot;

$fg
[1] &quot;black&quot;

$fig
[1] 0 1 0 1

$fin
[1] 6.499999 3.999999

$font
[1] 1

$font.axis
[1] 1

$font.lab
[1] 1

$font.main
[1] 2

$font.sub
[1] 1

$lab
[1] 5 5 7

$las
[1] 0

$lend
[1] &quot;round&quot;

$lheight
[1] 1

$ljoin
[1] &quot;round&quot;

$lmitre
[1] 10

$lty
[1] &quot;solid&quot;

$lwd
[1] 1

$mai
[1] 1.02 0.82 0.82 0.42

$mar
[1] 5.1 4.1 4.1 2.1

$mex
[1] 1

$mfcol
[1] 1 1

$mfg
[1] 1 1 1 1

$mfrow
[1] 1 1

$mgp
[1] 3 1 0

$mkh
[1] 0.001

$new
[1] FALSE

$oma
[1] 0 0 0 0

$omd
[1] 0 1 0 1

$omi
[1] 0 0 0 0

$page
[1] TRUE

$pch
[1] 1

$pin
[1] 5.259999 2.159999

$plt
[1] 0.1261539 0.9353846 0.2550000 0.7950000

$ps
[1] 12

$pty
[1] &quot;m&quot;

$smo
[1] 1

$srt
[1] 0

$tck
[1] NA

$tcl
[1] -0.5

$usr
[1] 0 1 0 1

$xaxp
[1] 0 1 5

$xaxs
[1] &quot;r&quot;

$xaxt
[1] &quot;s&quot;

$xpd
[1] FALSE

$yaxp
[1] 0 1 5

$yaxs
[1] &quot;r&quot;

$yaxt
[1] &quot;s&quot;

$ylbias
[1] 0.2</code></pre>
</div>
<p>The <code>par</code> function allows you to set up graphical parameters (for all coming plots)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># `las` within the `plot` function</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>Petal.Length</span> <span class='op'>~</span> <span class='va'>Petal.Width</span>, dat <span class='op'>=</span> <span class='va'>iris</span>,las<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>

<span class='co'># `las` set as a graphical setting</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>las<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span> 
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>Petal.Length</span> <span class='op'>~</span> <span class='va'>Petal.Width</span>, dat <span class='op'>=</span> <span class='va'>iris</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>The latest will apply to all the following plots and until the graphical parameters are reinitialize using <code>dev.off()</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/grDevices/dev.html'>dev.off</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p><strong>Some useful settings control by the function <code>par</code>:</strong></p>
<ul>
<li><em>Text and symbol size</em></li>
</ul>
<p><code>cex</code> point and text size</p>
<p><code>cex.axis</code> axis tick label size</p>
<p><code>cex.lab</code> axis label size</p>
<p><code>cex.main</code> title size</p>
<p><code>cex.sub</code> subtitle size</p>
<ul>
<li><em>Plotting symbol (e.g., for scatter plots)</em></li>
</ul>
<p><code>pch</code> plotting symbol (<code>pch=19</code> or <code>pch="*"</code>)</p>
<ul>
<li><em>Lines (e.g., for line plots)</em></li>
</ul>
<p><code>lty</code> line type (1=solid,2.6=dashed or dotted)</p>
<p><code>lwd</code> line width</p>
<ul>
<li><em>Margins (have to be setup before plotting)</em></li>
</ul>
<p><code>mar</code> margins (in order: bottom, left, top, right)</p>
<ul>
<li><em>Panels (have to be setup before plotting)</em></li>
</ul>
<p><code>mfrow</code> no. of rows and column, e.g. <code>par(mfrow=c(2,2))</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='co'># define graphical parameter: 1 row, 2 columns</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span> <span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span>, cex<span class='op'>=</span><span class='fl'>15</span>, pch<span class='op'>=</span><span class='fl'>15</span><span class='op'>)</span> <span class='co'># 1st plot</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span> <span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span>, cex<span class='op'>=</span><span class='fl'>15</span>, pch<span class='op'>=</span><span class='fl'>19</span><span class='op'>)</span> <span class='co'># 2nd plot</span>
</code></pre>
</div>
</div>
<ul>
<li><em>Axis range</em></li>
</ul>
<p><code>xlim</code> min, max</p>
<p><code>ylim</code> min, max</p>
<p><strong>DEMO</strong></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>bg<span class='op'>=</span><span class='st'>"#FCE8C5"</span>, mar<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4</span>,<span class='fl'>4</span>,<span class='fl'>4</span>,<span class='fl'>4</span><span class='op'>)</span>, pch <span class='op'>=</span> <span class='fl'>19</span>, las<span class='op'>=</span><span class='fl'>1</span>, cex<span class='op'>=</span><span class='fl'>1.2</span>, cex.main<span class='op'>=</span><span class='fl'>1.2</span>, cex.axis<span class='op'>=</span><span class='fl'>1</span>,cex.lab<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>Petal.Length</span> <span class='op'>~</span> <span class='va'>Petal.Width</span>, dat <span class='op'>=</span> <span class='va'>iris</span>,
     xlab <span class='op'>=</span> <span class='st'>'Petal width (cm)'</span>, 
     ylab <span class='op'>=</span> <span class='st'>'Petal length (cm)'</span>, 
     main <span class='op'>=</span> <span class='st'>'Petal width and length of iris flower'</span>,
     col <span class='op'>=</span> <span class='fu'><a href='https://scales.r-lib.org/reference/alpha.html'>alpha</a></span><span class='op'>(</span><span class='va'>col.iris</span>, <span class='fl'>0.2</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># set up symbol types and their color </span>

<span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='st'>"bottomright"</span>, pch<span class='op'>=</span> <span class='fl'>19</span>, cex<span class='op'>=</span><span class='fl'>0.8</span>, legend<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"versicolor"</span>,<span class='st'>"setosa"</span>, <span class='st'>"virginica"</span><span class='op'>)</span>, col<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='fu'><a href='https://scales.r-lib.org/reference/alpha.html'>alpha</a></span><span class='op'>(</span><span class='va'>col.iris</span>, <span class='fl'>0.2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-38-1.png" width="624" /></p>
</div>
<p>Extra elements to add in a plot can be entered seperately:</p>
<ul>
<li>Title and labels <code>title</code></li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span> (<span class="at">main=</span><span class="st">&#39;title&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;y-axis title&quot;, xlab&#39;</span>x<span class="sc">-</span>axis title<span class="st">&#39;)</span></span></code></pre></div>
</div>
<ul>
<li>Text annotation <code>text</code> or in the margin using <code>mtext</code></li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/text.html'>text</a></span> <span class='op'>(</span>x<span class='op'>=</span><span class='fl'>1</span>, y<span class='op'>=</span><span class='fl'>1</span>,<span class='st'>'text'</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/mtext.html'>mtext</a></span> <span class='op'>(</span><span class='st'>'text'</span>, side<span class='op'>=</span><span class='fl'>1</span>, line<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<ul>
<li>Horizontal or vertical line <code>abline</code></li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span> <span class='op'>(</span>h<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span> <span class='op'>(</span>v<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<ul>
<li>Already mentioned: <code>line</code>, <code>points</code>, <code>legend</code>, etc.</li>
</ul>
<h1 id="exporting">Exporting</h1>
<p>You might need to export your plots as standalone image files for publications. R can export to many different <strong>raster</strong> image file formats such as jpg, png, gif and tiff, and several <strong>vector</strong> file formats such as PostScript, svg and PDF. You can specify the image resolution (in dpi), the image height and width, and the size of the margins.</p>
<p>The following example saves the last plot as an uncompressed tiff file with a 5“x6” dimension and a resolution of 300 dpi. This is accomplished by simply book-ending the plotting routines between the <code>tiff</code> and <code>dev.off</code>functions:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/grDevices/png.html'>tiff</a></span><span class='op'>(</span>filename <span class='op'>=</span> <span class='st'>"Figures/iris_plot.tif"</span>, width <span class='op'>=</span> <span class='fl'>5</span>, height <span class='op'>=</span> <span class='fl'>6</span>, units <span class='op'>=</span> <span class='st'>"in"</span>, compression <span class='op'>=</span> <span class='st'>"none"</span>, res <span class='op'>=</span> <span class='fl'>300</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>bg<span class='op'>=</span><span class='st'>"#FCE8C5"</span>, mar<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4</span>,<span class='fl'>4</span>,<span class='fl'>4</span>,<span class='fl'>4</span><span class='op'>)</span>, pch <span class='op'>=</span> <span class='fl'>19</span>, las<span class='op'>=</span><span class='fl'>1</span>, cex<span class='op'>=</span><span class='fl'>1.2</span>, cex.main<span class='op'>=</span><span class='fl'>1.2</span>, cex.axis<span class='op'>=</span><span class='fl'>1</span>,cex.lab<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>Petal.Length</span> <span class='op'>~</span> <span class='va'>Petal.Width</span>, dat <span class='op'>=</span> <span class='va'>iris</span>,
     xlab <span class='op'>=</span> <span class='st'>'Petal width (cm)'</span>, 
     ylab <span class='op'>=</span> <span class='st'>'Petal length (cm)'</span>, 
     main <span class='op'>=</span> <span class='st'>'Petal width and length of iris flower'</span>,
     col <span class='op'>=</span> <span class='fu'><a href='https://scales.r-lib.org/reference/alpha.html'>alpha</a></span><span class='op'>(</span><span class='va'>col.iris</span>, <span class='fl'>0.2</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># set up symbol types and their color </span>

<span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='st'>"bottomright"</span>, pch<span class='op'>=</span> <span class='fl'>19</span>, cex<span class='op'>=</span><span class='fl'>0.8</span>, legend<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"versicolor"</span>,<span class='st'>"setosa"</span>, <span class='st'>"virginica"</span><span class='op'>)</span>, col<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='fu'><a href='https://scales.r-lib.org/reference/alpha.html'>alpha</a></span><span class='op'>(</span><span class='va'>col.iris</span>, <span class='fl'>0.2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/grDevices/dev.html'>dev.off</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>png 
  2 </code></pre>
</div>
<p>To save the same plot to a pdf file format, simply substitute <code>tiff</code> with <code>pdf</code> and adjust the relevant parameters:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/grDevices/pdf.html'>pdf</a></span><span class='op'>(</span>file<span class='op'>=</span> <span class='st'>"Figures/iris_plot.pdf"</span>, width <span class='op'>=</span> <span class='fl'>5</span>, height <span class='op'>=</span> <span class='fl'>6</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>bg<span class='op'>=</span><span class='st'>"#FCE8C5"</span>, mar<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4</span>,<span class='fl'>4</span>,<span class='fl'>4</span>,<span class='fl'>4</span><span class='op'>)</span>, pch <span class='op'>=</span> <span class='fl'>19</span>, las<span class='op'>=</span><span class='fl'>1</span>, cex<span class='op'>=</span><span class='fl'>1.2</span>, cex.main<span class='op'>=</span><span class='fl'>1.2</span>, cex.axis<span class='op'>=</span><span class='fl'>1</span>,cex.lab<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>Petal.Length</span> <span class='op'>~</span> <span class='va'>Petal.Width</span>, dat <span class='op'>=</span> <span class='va'>iris</span>,
     xlab <span class='op'>=</span> <span class='st'>'Petal width (cm)'</span>, 
     ylab <span class='op'>=</span> <span class='st'>'Petal length (cm)'</span>, 
     main <span class='op'>=</span> <span class='st'>'Petal width and length of iris flower'</span>,
     col <span class='op'>=</span> <span class='fu'><a href='https://scales.r-lib.org/reference/alpha.html'>alpha</a></span><span class='op'>(</span><span class='va'>col.iris</span>, <span class='fl'>0.2</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># set up symbol types and their color </span>

<span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='st'>"bottomright"</span>, pch<span class='op'>=</span> <span class='fl'>19</span>, cex<span class='op'>=</span><span class='fl'>0.8</span>, legend<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"versicolor"</span>,<span class='st'>"setosa"</span>, <span class='st'>"virginica"</span><span class='op'>)</span>, col<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='fu'><a href='https://scales.r-lib.org/reference/alpha.html'>alpha</a></span><span class='op'>(</span><span class='va'>col.iris</span>, <span class='fl'>0.2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/grDevices/dev.html'>dev.off</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>png 
  2 </code></pre>
</div>
<p class="comment">
<strong>Practice 2:</strong> Export your previous <code>rairuoho</code> scatterplot. Make it more informative by adding as many elements you think it needs and by customizing graphical options. Make the y-axis starting at <strong>exactly</strong> 0 and ending at 130. Save your plot as a <code>pdf</code>, ready for publication!
</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show Me The Solution
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#As title, call me and show me your pdf</span>
</code></pre>
</div>
</details>
</div>
<h1 id="package-lattice">Package <code>lattice</code></h1>
<p>The <code>lattice</code> package is an implementation of the <strong>Trellis</strong> display (or multi-panel display) used to visualize multivariate data or, more specifically, to visualize the dependencies and interactions between multiple variables.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://lattice.r-forge.r-project.org/'>lattice</a></span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h2 id="univariate-data-set">Univariate data set</h2>
<p>Let’s look at a simple example where the density distribution of <code>Petal.Length</code> is conditioned by Species.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://lattice.r-forge.r-project.org/'>lattice</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/lattice/man/histogram.html'>densityplot</a></span><span class='op'>(</span><span class='op'>~</span> <span class='va'>Petal.Length</span> <span class='op'>|</span> <span class='va'>Species</span>, <span class='va'>iris</span>, plot.points <span class='op'>=</span> <span class='st'>""</span>, layout<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-46-1.png" width="624" /></p>
</div>
<p>The <code>layout=c(1,3)</code> parameter instructs the lattice function to layout the panels along 1 column and 3 row. If you wanted the plots to be displayed in 1 rows and 3 column you would simply type <code>layout=c(3,1)</code> which is the default option.</p>
<p>The first thing to note is that the x-scale axis range is the same for all five plots. At first, this may seem as an inefficient use of the range of x values–for example, the <code>setosa</code> density plot is squeezed in the left-hand side of the plot, but it is important to understand the purpose of a trellis plot: to facilitate comparison of plots. By ensuring that all scale ranges remain the same, we can easily compare the plot shape. In the above plot, it is clear that the <code>petal.length</code> differs among <code>Species</code>.</p>
<p>The <code>lattice</code> packages also has a <code>histogram</code> function</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/lattice/man/histogram.html'>histogram</a></span><span class='op'>(</span><span class='op'>~</span> <span class='va'>Petal.Length</span> <span class='op'>|</span> <span class='va'>Species</span>, <span class='va'>iris</span>, plot.points <span class='op'>=</span> <span class='st'>""</span>, nint <span class='op'>=</span> <span class='fl'>20</span>, layout<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-47-1.png" width="624" /></p>
</div>
<p>Note the importance of having a table shaped in <strong>long format</strong>. The density plots are conditioned on <strong>species</strong> which requires that species be treated as different values of a same variable (i.e. column <code>Species</code> in <code>iris</code>). The above plot could not be generated if the various <strong>species</strong> were treated as separate variables (i.e. columns).</p>
<p>You can also compare the distributions to a normal distribution using <code>qqmath</code> (i.e. a Q-Q plot):</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/lattice/man/qqmath.html'>qqmath</a></span><span class='op'>(</span><span class='op'>~</span> <span class='va'>Petal.Length</span> <span class='op'>|</span> <span class='va'>Species</span>, <span class='va'>iris</span>, plot.points <span class='op'>=</span> <span class='st'>""</span>, nint <span class='op'>=</span> <span class='fl'>20</span>, layout<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-48-1.png" width="624" /></p>
</div>
<p><strong>Boxplots</strong> are another popular way to view the distribution of values. In the following example, we create boxplots of Petal Length as a function of a dummy variable <code>variety</code> (<code>Petal.Length ~  variety</code>) created fro the purpose of this demo. We condition this comparison using species information (<code>|Species</code>)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>iris</span><span class='op'>$</span><span class='va'>variety</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>'pure'</span>,<span class='fl'>25</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>'hybrid'</span>,<span class='fl'>25</span><span class='op'>)</span><span class='op'>)</span>,<span class='fl'>3</span><span class='op'>)</span> <span class='co'># dummy variable</span>
<span class='fu'><a href='https://rdrr.io/pkg/lattice/man/xyplot.html'>bwplot</a></span><span class='op'>(</span><span class='va'>Petal.Length</span> <span class='op'>~</span>  <span class='va'>variety</span><span class='op'>|</span><span class='va'>Species</span>, <span class='va'>iris</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-49-1.png" width="624" /></p>
</div>
<h2 id="multivariate-data-set">Multivariate data set</h2>
<h3 id="scatter-plots">Scatter plots</h3>
<p>The <code>lattice</code> package allows logically to plot several variables on a same plot. For example, we can plot <code>Sepal.Length + Sepal.Width</code> vs <code>Petal.Length + Petal.Width</code> for each <code>Species</code> on a same plot:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/lattice/man/xyplot.html'>xyplot</a></span><span class='op'>(</span><span class='va'>Sepal.Length</span> <span class='op'>+</span> <span class='va'>Sepal.Width</span> <span class='op'>~</span> <span class='va'>Petal.Length</span> <span class='op'>+</span> <span class='va'>Petal.Width</span> <span class='op'>|</span> <span class='va'>Species</span>,
       data <span class='op'>=</span> <span class='va'>iris</span>, scales <span class='op'>=</span> <span class='st'>"free"</span>, layout <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>2</span><span class='op'>)</span>, type<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"p"</span>,<span class='st'>"g"</span><span class='op'>)</span>,
       auto.key <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>.6</span>, y <span class='op'>=</span> <span class='fl'>.7</span>, corner <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-50-1.png" width="624" /></p>
</div>
<p>The <code>xyplot</code> function is passed several parameters. The parameter <code>type = c("p","g")</code> instructs the function to generate both points, <code>"p"</code>, and a background grid <code>"g"</code>. Parameter <code>type</code> can accept many other options, a few are listed in the following table:</p>
<table>
<thead>
<tr class="header">
<th>Option</th>
<th>Adds</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>"p"</code></td>
<td><code>Points</code></td>
</tr>
<tr class="even">
<td><code>"l"</code></td>
<td><code>Lines</code></td>
</tr>
<tr class="odd">
<td><code>"b"</code></td>
<td><code>Both points and lines</code></td>
</tr>
<tr class="even">
<td><code>"o"</code></td>
<td><code>Both points and lines</code></td>
</tr>
<tr class="odd">
<td><code>"r"</code></td>
<td><code>Regression line</code></td>
</tr>
<tr class="even">
<td><code>"g"</code></td>
<td><code>Reference grid</code></td>
</tr>
<tr class="odd">
<td><code>"smooth"</code></td>
<td><code>LOESS fit</code></td>
</tr>
<tr class="even">
<td><code>"spline"</code></td>
<td><code>Cubic spline fit</code></td>
</tr>
</tbody>
</table>
<p>Let’s check how <code>Petal.Length</code> is related to other variables in each species</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/lattice/man/xyplot.html'>xyplot</a></span><span class='op'>(</span><span class='va'>Sepal.Length</span> <span class='op'>+</span> <span class='va'>Sepal.Width</span> <span class='op'>+</span> <span class='va'>Petal.Width</span> <span class='op'>~</span> <span class='va'>Petal.Length</span>  <span class='op'>|</span> <span class='va'>Species</span>,
       data <span class='op'>=</span> <span class='va'>iris</span>, scales <span class='op'>=</span> <span class='st'>"free"</span>, layout <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>2</span><span class='op'>)</span>, type<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"p"</span>,<span class='st'>"r"</span><span class='op'>)</span>,
       auto.key <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>.6</span>, y <span class='op'>=</span> <span class='fl'>.7</span>, corner <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-51-1.png" width="624" /></p>
</div>
<h3 id="line-plots">Line plots</h3>
<p>After <code>order</code> my data <code>iris</code> by <code>Petal.Length</code>!</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/lattice/man/xyplot.html'>xyplot</a></span><span class='op'>(</span><span class='va'>Sepal.Length</span> <span class='op'>+</span> <span class='va'>Sepal.Width</span> <span class='op'>+</span> <span class='va'>Petal.Width</span> <span class='op'>~</span> <span class='va'>Petal.Length</span>  <span class='op'>|</span> <span class='va'>Species</span>,
       data <span class='op'>=</span> <span class='va'>iris</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='va'>iris</span><span class='op'>$</span><span class='va'>Petal.Length</span><span class='op'>)</span>,<span class='op'>]</span>, scales <span class='op'>=</span> <span class='st'>"free"</span>, layout <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>2</span><span class='op'>)</span>, 
       type<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"l"</span><span class='op'>)</span>, auto.key <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>.6</span>, y <span class='op'>=</span> <span class='fl'>.7</span>, corner <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-52-1.png" width="624" /></p>
</div>
<p>The parameters <code>pch</code> and <code>cex</code> define the symbol shape and size. The parameter <code>col.symbol</code> defines the point color. The parameter <code>aspect="iso"</code> sets the aspect ratio in such a way that a unit of measure along x matches that of y. The parameter <code>abline=c(0,1)</code> generated a 45° line. Etc.</p>
<p>We can take this a step further. We could condition the previous relationship by species and variety.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/lattice/man/xyplot.html'>xyplot</a></span><span class='op'>(</span><span class='va'>Sepal.Length</span> <span class='op'>+</span> <span class='va'>Sepal.Width</span> <span class='op'>+</span> <span class='va'>Petal.Width</span> <span class='op'>~</span> <span class='va'>Petal.Length</span>  <span class='op'>|</span> <span class='va'>variety</span><span class='op'>+</span><span class='va'>Species</span>,
       data <span class='op'>=</span> <span class='va'>iris</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='va'>iris</span><span class='op'>$</span><span class='va'>Petal.Length</span><span class='op'>)</span>,<span class='op'>]</span>, scales <span class='op'>=</span> <span class='st'>"free"</span>, layout <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>, <span class='fl'>2</span><span class='op'>)</span>,
       type<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"l"</span><span class='op'>)</span>, auto.key <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-53-1.png" width="624" /></p>
</div>
<h2 id="customization-1">Customization</h2>
<p>As the <code>par</code> function mentioned earlier, Various elements of a trellis plot can be customized by passing the graphic parameters to the <code>trellis.par.set</code> function. To get the list of graphic parameters and their values call:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/lattice/man/trellis.par.get.html'>trellis.par.get</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>It gives you an idea about how many parameters can be customized. Those defaults can be store in an object to further restore them. Many tutorials are available online on the <code>lattice</code> package in order to customize your plots as you need. However, the <code>lattice</code> package is not always easy to use, and inspire the main author of another package <code>ggplot</code> that now becomes the “reference” in matter of graphics in R.</p>
<h1 id="package-ggplot">Package <code>ggplot</code></h1>
<p><em>Tutorial from Manny Gimond (2020)</em></p>
<h2 id="basic-grammar">Basic grammar</h2>
<p>The <code>ggplot2</code> package is designed around the idea that statistical graphics can be decomposed into a formal system of grammatical rules. The <code>ggplot2</code> learning curve is steep but once you mastered you will have a great control over graphical design. For an up-to-date list of <code>ggplot2</code> functions, you may want to refer to ggplot2’s <a href="https://ggplot2.tidyverse.org/reference/">website</a>.</p>
<p>A plot in <code>ggplot2</code> consists of different <strong>primary layering components</strong>, with the three primary components being:</p>
<ul>
<li>The <strong>dataset</strong> that houses the data to be plotted;</li>
<li>The <strong>aesthetics</strong> which describe how data are to be mapped to the geometric elements (color, shape, size, etc..);</li>
<li>The <strong>geometric elements</strong> to use in the plot (i.e. points, lines, rectangles, etc…).</li>
</ul>
<p><strong>Additional (optional) layering components</strong> include:</p>
<ul>
<li><strong>Statistical</strong> elements such as smoothing, binning or transforming the variable</li>
<li><strong>Facets</strong> for conditional or trellis plots</li>
<li><strong>Coordinate systems</strong> for defining the plots shape (i.e. Cartesian, polar, spatial map projections, etc…)</li>
</ul>
<p>To access <code>ggplot2</code> functions, you will need to load its library:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Today, we will use the following data sets (examine objects created) :</p>
<ol type="1">
<li><code>dat1</code>: [grain harvest for North-America] (<a href="http://www.fao.org/faostat/en/#data/QC" class="uri">http://www.fao.org/faostat/en/#data/QC</a>) + several long and wide versions of this dataset. Examine objects created.</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyr.tidyverse.org'>tidyr</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span>
<span class='va'>dat1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span><span class='st'>"Data/FAO_grains_NA.csv"</span>, header<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>dat1w</span> <span class='op'>&lt;-</span> <span class='va'>dat1</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Information</span> <span class='op'>==</span> <span class='st'>"Yield (Hg/Ha)"</span>, <span class='va'>Country</span> <span class='op'>==</span><span class='st'>"United States of America"</span>, <span class='va'>Crop</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Oats"</span>, <span class='st'>"Maize"</span>, <span class='st'>"Barley"</span>, <span class='st'>"Buckwheat"</span>,<span class='st'>"Rye"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span> <span class='op'>(</span><span class='va'>Year</span>, <span class='va'>Crop</span>, <span class='va'>Value</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://tidyr.tidyverse.org/reference/spread.html'>spread</a></span><span class='op'>(</span>key <span class='op'>=</span> <span class='va'>Crop</span>,value<span class='op'>=</span><span class='st'>"Value"</span><span class='op'>)</span>
<span class='va'>dat1l</span> <span class='op'>&lt;-</span> <span class='va'>dat1w</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>:</span><span class='fl'>6</span>, names_to <span class='op'>=</span> <span class='st'>"Crop"</span>, values_to <span class='op'>=</span> <span class='st'>"Yield"</span><span class='op'>)</span>
<span class='va'>dat1l2</span> <span class='op'>&lt;-</span> <span class='va'>dat1</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Information</span> <span class='op'>==</span> <span class='st'>"Yield (Hg/Ha)"</span>, <span class='va'>Crop</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Oats"</span>, <span class='st'>"Maize"</span>, <span class='st'>"Barley"</span>, <span class='st'>"Buckwheat"</span>,<span class='st'>"Rye"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span> <span class='va'>Year</span>, <span class='va'>Crop</span>, <span class='va'>Country</span>, Yield <span class='op'>=</span> <span class='va'>Value</span><span class='op'>)</span>  <span class='co'># Note that we are renaming the Value field</span>
</code></pre>
</div>
</div>
<ol start="2" type="1">
<li><code>dat2</code>: [income/education census data] (<a href="https://www.socialexplorer.com/data/ACS2016/metadata/?ds=ACS16&amp;table=B20004" class="uri">https://www.socialexplorer.com/data/ACS2016/metadata/?ds=ACS16&amp;table=B20004</a>) for the US and its long version (only for advance use later).</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://stringr.tidyverse.org'>stringr</a></span><span class='op'>)</span>
<span class='va'>dat2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span><span class='st'>"Data/Income_education.csv"</span>, header<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>Edu.Gend</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span> 
               variable <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"B200040"</span>, <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_pad.html'>str_pad</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>18</span>, width<span class='op'>=</span><span class='fl'>2</span> , pad<span class='op'>=</span><span class='st'>"0"</span><span class='op'>)</span>,sep<span class='op'>=</span><span class='st'>""</span> <span class='op'>)</span>,
               Level <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"All"</span>, <span class='st'>"NoHS"</span>,<span class='st'>"HS"</span>,<span class='st'>"AD"</span>,<span class='st'>"BD"</span>,<span class='st'>"Grad"</span><span class='op'>)</span>, times<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span>,
               Gender <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"All"</span>, <span class='st'>"M"</span>,<span class='st'>"F"</span><span class='op'>)</span>, each<span class='op'>=</span><span class='fl'>6</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># Create a region/state join table</span>
<span class='va'>st.reg</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>State <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/chartr.html'>tolower</a></span><span class='op'>(</span><span class='va'>state.abb</span><span class='op'>)</span>, Region <span class='op'>=</span> <span class='va'>state.region</span><span class='op'>)</span>
<span class='va'>st.reg</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>st.reg</span> , <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>State<span class='op'>=</span><span class='st'>"dc"</span>, Region<span class='op'>=</span><span class='st'>"South"</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># Start the piping operations</span>
<span class='va'>dat2b</span> <span class='op'>&lt;-</span> <span class='va'>dat2</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/gather.html'>gather</a></span><span class='op'>(</span>key <span class='op'>=</span> <span class='st'>"variable"</span>, value <span class='op'>=</span> <span class='st'>"value"</span>, <span class='op'>-</span><span class='fl'>1</span><span class='op'>:</span><span class='op'>-</span><span class='fl'>2</span><span class='op'>)</span>  <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>Edu.Gend</span>, by<span class='op'>=</span><span class='st'>"variable"</span> <span class='op'>)</span>              <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>State</span>, <span class='va'>County</span>, <span class='va'>Level</span>, <span class='va'>Gender</span>, <span class='va'>value</span><span class='op'>)</span>       <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Level <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>Level</span>, levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"All"</span>,<span class='st'>"NoHS"</span>,<span class='st'>"HS"</span>, <span class='st'>"AD"</span>, <span class='st'>"BD"</span>, <span class='st'>"Grad"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>st.reg</span> , by<span class='op'>=</span><span class='st'>"State"</span><span class='op'>)</span>

<span class='va'>dat2c</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tidyr.tidyverse.org/reference/spread.html'>spread</a></span><span class='op'>(</span><span class='va'>dat2b</span>, key <span class='op'>=</span> <span class='va'>Gender</span>, value <span class='op'>=</span> <span class='va'>value</span> <span class='op'>)</span>
</code></pre>
</div>
</div>
<p>From a ggplot <strong>grammatical perspective</strong>, a scientific graph is the conversion of <em>data</em> to <strong>aesthetic</strong> attributes and <strong>geometric</strong> objects. This is an important concept to grasp since it underlies the construction of all graphics in <code>ggplot2</code>.</p>
<p>For example, if we want to generate a point plot of crop yield as a function of year using the <code>dat1l</code> data frame, we type:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat1l</span> , <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Year</span>, y <span class='op'>=</span> <span class='va'>Yield</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-58-1.png" width="624" /></p>
</div>
<p>where the function, <code>ggplot</code> will pass the data frame name whose content will be mapped; the <code>aes</code> function is given data-to-geometry mapping instructions (<code>Year</code> is mapped to the x-axis and <code>Yield</code> is mapped to the y-axis); and <code>geom_point</code> is the geometry type.</p>
<p><img src="images/ggplot_1.png" /></p>
<p>If we wanted to include a third variable, crop type, to the map, we would need to map its aesthetics: here we’ll map <code>Crop</code> to the color element of the geom.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat1l</span> , <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Year</span>, y <span class='op'>=</span> <span class='va'>Yield</span>, color <span class='op'>=</span> <span class='va'>Crop</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-59-1.png" width="624" /></p>
</div>
<p>The parameter color acts as a grouping parameter whereby the groups are assigned unique colors.</p>
<p><img src="images/ggplot_2.png" /></p>
<p>If we want to plot lines instead of points, simply substitute the geometry type with the <code>geom_line</code> geometry.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat1l</span> , <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Year</span>, y <span class='op'>=</span> <span class='va'>Yield</span>, color <span class='op'>=</span> <span class='va'>Crop</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-60-1.png" width="624" /></p>
</div>
<p>Note that the aesthetics are still mapped in the same way with <code>Year</code> mapped to the x coordinate, <code>Yield</code> mapped to the y coordinate and <code>Crop</code> mapped to the geom’s color.</p>
<p>Note that the parameters <code>x=</code> and <code>y=</code> can be omitted from the syntax reducing the line of code to:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat1l</span> , <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>Year</span>, <span class='va'>Yield</span>, color <span class='op'>=</span> <span class='va'>Crop</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-61-1.png" width="624" /></p>
</div>
<h2 id="geometries">Geometries</h2>
<p>Examples of a few available geometric elements follow.</p>
<h3 id="geom_line"><code>geom_line</code></h3>
<p><code>geom_line</code> generates line geometries. We’ll use data from <code>dat1w</code> to generate a simple plot of oat yield as a function of year.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat1w</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Year</span>, y <span class='op'>=</span> <span class='va'>Oats</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='op'>)</span> 
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-62-1.png" width="624" /></p>
</div>
<p>Parameters such as color and linetype can be passed directly to the <code>geom_line</code> function:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat1w</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Year</span>, y <span class='op'>=</span> <span class='va'>Oats</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span>linetype <span class='op'>=</span> <span class='fl'>2</span>, color <span class='op'>=</span> <span class='st'>"blue"</span>, size<span class='op'>=</span><span class='fl'>0.4</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-63-1.png" width="624" /></p>
</div>
<p>Note the difference in how <code>color=</code> is implemented here. It’s no longer <strong>mapping</strong> a variable’s levels to a range of colors as when it’s called inside of the <code>aes</code> function, instead, it’s <strong>setting</strong> the line color to blue.</p>
<h3 id="geom_point"><code>geom_point</code></h3>
<p>This generates point geometries. This is often used in generating scatterplots. For example, using <code>dat</code> dataste to plot female income (variable <code>B20004013</code>) vs male income (variable <code>B20004007</code>):</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat2</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>B20004013</span>, y <span class='op'>=</span> <span class='va'>B20004007</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span> 
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-64-1.png" width="624" /></p>
</div>
<p>As did earlier, we modify the point’s transparency by passing the <code>alpha=0.3</code> parameter to the <code>geom_point</code> function. Other parameters that can be passed to point geoms include <code>colour</code>, <code>pch</code> and <code>cex</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat2</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>B20004013</span>, y <span class='op'>=</span> <span class='va'>B20004007</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='st'>"red"</span>, pch<span class='op'>=</span><span class='fl'>3</span> , alpha <span class='op'>=</span> <span class='fl'>0.3</span>, cex<span class='op'>=</span><span class='fl'>0.6</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-65-1.png" width="624" /></p>
</div>
<h3 id="geom_hex"><code>geom_hex</code></h3>
<p>When a bivariate scatter plot has too many overlapping points, it may be helpful to bin the observations into regular hexagons. This provides the number of observations per bin.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/edzer/hexbin'>hexbin</a></span><span class='op'>)</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat2</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>B20004013</span>, y <span class='op'>=</span> <span class='va'>B20004007</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_hex.html'>geom_hex</a></span><span class='op'>(</span>binwidth <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1000</span>, <span class='fl'>1000</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-66-1.png" width="624" /></p>
</div>
<p>The <code>binwidth</code> argument defines the width and height of each bin in the variables’ axes units.</p>
<h3 id="geom_boxplot"><code>geom_boxplot</code></h3>
<p>In the following example, a boxplot of <code>Yield</code> is generated for each <code>Crop</code> type.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat1l</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Crop</span>, y <span class='op'>=</span> <span class='va'>Yield</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_boxplot.html'>geom_boxplot</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"bisque"</span><span class='op'>)</span> 
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-67-1.png" width="624" /></p>
</div>
<p>If we want to generate a single boxplot (for example for all yields irrespective of crop type) we need to pass a dummy variable to <code>x=</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat1l</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>""</span>, y <span class='op'>=</span> <span class='va'>Yield</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_boxplot.html'>geom_boxplot</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"bisque"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"All crops"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-68-1.png" width="624" /></p>
</div>
<h3 id="geom_violin"><code>geom_violin</code></h3>
<p>A violin plot is a symmetrical version of a density plot which provides even greater detail of a sample’s distribution than a boxplot.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat1l</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>""</span>, y <span class='op'>=</span> <span class='va'>Yield</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_violin.html'>geom_violin</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"bisque"</span><span class='op'>)</span> 
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-69-1.png" width="624" /></p>
</div>
<h3 id="geom_histogram"><code>geom_histogram</code></h3>
<p>Histograms can be plotted for single variables only (unless faceting is used) as can be noted by the absence of a <code>y=</code> parameter in <code>aes</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat1w</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Oats</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_histogram.html'>geom_histogram</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"grey50"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-70-1.png" width="624" /></p>
</div>
<p>The bin widths can be specified in terms of the value’s units. In our example, the unit is yield of oats (in hg/Ha). So if we want to generate bin widths that cover 1000 hg/Ha (= 100 kg / Ha), we can type:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat1w</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Oats</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_histogram.html'>geom_histogram</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"grey50"</span>, binwidth <span class='op'>=</span> <span class='fl'>1000</span><span class='op'>)</span> 
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-71-1.png" width="624" /></p>
</div>
<p>If you want to control the number of bins, use the parameter <code>bins=</code> instead. For example, to set the number of bins to 8, modify the above code chunk as follows:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat1w</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Oats</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_histogram.html'>geom_histogram</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"grey50"</span>, bins <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> 
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-72-1.png" width="624" /></p>
</div>
<h3 id="geom_bar"><code>geom_bar</code></h3>
<p>Bar plots are used to summaries the counts of a categorical value. For example, to plot the number of counties in each state (note that each record in <code>dat2</code> is assigned a county):</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat2</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>State</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_bar</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-73-1.png" width="624" /></p>
</div>
<p>To sort the bars by length we need to rearrange the State factor level order based on the number of counties in each state (which is the number of times a state appears in the data frame). We’ll make use of <code>forcats</code>’s <code>fct_infreq</code> function to reorder the State factor levels based on frequency.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://forcats.tidyverse.org'>forcats</a></span><span class='op'>)</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat2</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='fu'><a href='https://forcats.tidyverse.org/reference/fct_inorder.html'>fct_infreq</a></span><span class='op'>(</span><span class='va'>State</span>,ordered <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_bar</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-74-1.png" width="624" /></p>
</div>
<p>If we want to reverse the order (i.e. plot from smallest number of counties to greatest), wrap the <code>fct_infreq</code> function with <code>fct_rev</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat2</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='fu'><a href='https://forcats.tidyverse.org/reference/fct_rev.html'>fct_rev</a></span><span class='op'>(</span><span class='fu'><a href='https://forcats.tidyverse.org/reference/fct_inorder.html'>fct_infreq</a></span><span class='op'>(</span><span class='va'>State</span>,ordered <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_bar</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-75-1.png" width="624" /></p>
</div>
<p>The <code>geom_bar</code> function can also be used with count values (i.e. variable already summarized by count). First, we’ll summaries the number of counties by state using the dplyr package. This will generate a data frame with just 51 records: one for each of the 50 states and the District of Columbia.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dat2.ct</span> <span class='op'>&lt;-</span> <span class='va'>dat2</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>State</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarize</a></span><span class='op'>(</span>Counties <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>dat2.ct</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 6 x 2
  State Counties
  &lt;chr&gt;    &lt;int&gt;
1 ak          29
2 al          67
3 ar          75
4 az          15
5 ca          58
6 co          64</code></pre>
</div>
<p>When using summarized data, we must pass the parameter <code>stat="identity"</code> to the <code>geom_bar</code> function. We must also explicitly map the <em>x</em> and <em>y</em> axes geometries. Note that since we are now generating bar heights from a value field and not a frequency, we will need to use another <code>forcats</code> ordering function called <code>fct_reorder</code>. This function takes three parameters: the variable to be ordered (<code>State</code>), the variable whose values will determine the order (<code>Counties</code>) and the function, <code>fun=</code>, which defines the statistic used to summaries the sorting variable. Since there is just one value per state, we can use any summary statistic such as <code>median</code>, <code>mean</code>, <code>sum</code>, <code>min</code> or <code>max</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat2.ct</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fu'><a href='https://forcats.tidyverse.org/reference/fct_reorder.html'>fct_reorder</a></span><span class='op'>(</span><span class='va'>State</span>, <span class='va'>Counties</span>, .fun <span class='op'>=</span> <span class='va'>median</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='va'>Counties</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_bar</a></span><span class='op'>(</span>stat <span class='op'>=</span> <span class='st'>"identity"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-77-1.png" width="624" /></p>
</div>
<p>Note that you can replace <code>fct_reorder</code> from the <code>forcats</code> packages with the <code>base</code> function <code>reorder</code> mentioned ealier in the class.</p>
<h3 id="dot-plot">dot plot</h3>
<p>The dot plot is an alternative way to visualize counts as a function of a categorical variable. Instead of mapping <code>State</code> to the x-axis, we’ll map it to the y-axis.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat2.ct</span> , <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Counties</span>, y <span class='op'>=</span> <span class='va'>State</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-78-1.png" width="624" /></p>
</div>
<p>Dot plot graphics benefit from sorting–more so then bar plots. Here, we’ll make use of <strong><code>forcats::fct_reorder</code></strong> function (note on this notation: it is to call a function from a specific package, such as it can avoid conflicts).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat2.ct</span> , <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Counties</span>, y <span class='op'>=</span> <span class='fu'><a href='https://forcats.tidyverse.org/reference/fct_reorder.html'>fct_reorder</a></span><span class='op'>(</span><span class='va'>State</span>, <span class='va'>Counties</span>, .fun <span class='op'>=</span> <span class='va'>median</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-79-1.png" width="624" /></p>
</div>
<h3 id="combining-geometries">Combining geometries</h3>
<p>Obviously, geometries can be layered. For example, to overlay a linear regression line to the data we can add a <code>geom_smooth</code> layer:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat2</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>B20004013</span>, y <span class='op'>=</span> <span class='va'>B20004007</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.3</span>, color<span class='op'>=</span><span class='st'>'#4f4b4b'</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"lm"</span>, color<span class='op'>=</span><span class='st'>'green'</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-80-1.png" width="624" /></p>
</div>
<p>The <code>geom_smooth</code> can be used to fit other <em>lines</em> such as a loess line:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat2</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>B20004013</span>, y <span class='op'>=</span> <span class='va'>B20004007</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.3</span>, color<span class='op'>=</span><span class='st'>'#4f4b4b'</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"loess"</span>, color<span class='op'>=</span><span class='st'>'green'</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-81-1.png" width="624" /></p>
</div>
<p>The confidence interval can be removed from the smooth geometry by specifying <code>se = FALSE</code>.</p>
<h2 id="tweaking-a-ggplot2-graph">Tweaking a <code>ggplot2</code> graph</h2>
<p>Little trick for data visualization with <code>ggplot2</code> summarized <a href="https://rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf">here</a>. You will have to spend quite a lot of time to get all the functionality off the <code>ggplot2</code>. Happily, many documentations are available online . Check the <a href="https://www.r-graph-gallery.com/">R gallery</a>.</p>
<h3 id="plot-title">Plot title</h3>
<p>You can add a plot title using the <code>ggtile</code> function.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat2</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>State</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_bar</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Number of counties by state"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-82-1.png" width="624" /></p>
</div>
<h3 id="axes-titles">Axes titles</h3>
<p>Axes titles can be explicitly defined using the <code>xlab</code> and <code>ylab</code> functions.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat2</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>B20004013</span>, y <span class='op'>=</span> <span class='va'>B20004007</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Female income ($)"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Male income ($)"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-83-1.png" width="624" /></p>
</div>
<p>To remove axis labels, simply pass NULL to the functions as in <code>xlab(NULL)</code> and <code>ylab(NULL)</code></p>
<h3 id="axes-labels">Axes labels</h3>
<p>You can customize an axis’ label elements. If you are mapping continuous values along the x and y axes, use the <code>scale_x_continuous</code> and <code>scale_y_continuous</code> functions. For example, to specify where to place the tics and the accompanying labels, type:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat2</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>B20004013</span>, y <span class='op'>=</span> <span class='va'>B20004007</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Female income ($)"</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Male income ($)"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span>breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10000</span>, <span class='fl'>30000</span>, <span class='fl'>50000</span><span class='op'>)</span>,labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"$10,000"</span>, <span class='st'>"$30,000"</span>, <span class='st'>"$50,000"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-84-1.png" width="624" /></p>
</div>
<p>You change the label formats whereby the numbers are truncated to a thousandth of their original value, you can make use of <code>unit_format</code> from the <code>scales</code> package:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat2</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>B20004013</span>, y<span class='op'>=</span><span class='va'>B20004007</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>alpha<span class='op'>=</span><span class='fl'>0.3</span><span class='op'>)</span> <span class='op'>+</span>
   <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Female income ($)"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Male income ($)"</span><span class='op'>)</span> <span class='op'>+</span>
   <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span>labels<span class='op'>=</span><span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org/reference/unit_format.html'>unit_format</a></span><span class='op'>(</span>suffix<span class='op'>=</span><span class='st'>"k"</span>,scale<span class='op'>=</span><span class='fl'>0.001</span>, sep<span class='op'>=</span><span class='st'>""</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
   <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>labels<span class='op'>=</span><span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org/reference/unit_format.html'>unit_format</a></span><span class='op'>(</span>suffix<span class='op'>=</span><span class='st'>"k"</span>, scale<span class='op'>=</span><span class='fl'>0.001</span>, sep<span class='op'>=</span><span class='st'>""</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-85-1.png" width="624" /></p>
</div>
<p>You can rotate axes labels using the theme function.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat2</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>B20004013</span>, y<span class='op'>=</span><span class='va'>B20004007</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>alpha<span class='op'>=</span><span class='fl'>0.3</span><span class='op'>)</span> <span class='op'>+</span>
   <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Female income ($)"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Male income ($)"</span><span class='op'>)</span> <span class='op'>+</span>
   <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span>labels<span class='op'>=</span><span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org/reference/unit_format.html'>unit_format</a></span><span class='op'>(</span>suffix<span class='op'>=</span><span class='st'>"k"</span>, scale<span class='op'>=</span><span class='fl'>0.001</span>, sep<span class='op'>=</span><span class='st'>""</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
   <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>labels<span class='op'>=</span><span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org/reference/unit_format.html'>unit_format</a></span><span class='op'>(</span>suffix<span class='op'>=</span><span class='st'>"k"</span>, scale<span class='op'>=</span><span class='fl'>0.001</span>, sep<span class='op'>=</span><span class='st'>""</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
   <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>angle <span class='op'>=</span> <span class='fl'>45</span>, hjust <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> 
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-86-1.png" width="624" /></p>
</div>
<p>The <code>hjust</code> argument justifies the values horizontally. Its value ranges from <code>0</code> to <code>1</code> where <code>0</code> is completely left-justified and <code>1</code> is completely right-justified. Note that the justification is <em>relative</em> to the text’s orientation and <em>not</em> to the axis. So it may be best to first rotate the label values, then to adjust justification based on the plot’s look as needed.</p>
<p>If you want the label values rotated 90° you might also need to justify vertically (relative to the text’s orientation) using the <code>vjust</code> argument where <code>0</code> is completely top-justified and <code>1</code> is completely bottom-justified.</p>
<h3 id="axes-limits">Axes limits</h3>
<p>The axis range can be set using <code>xlim</code> and <code>ylim</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat2</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>B20004013</span>, y <span class='op'>=</span> <span class='va'>B20004007</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span> <span class='op'>+</span>
       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Female income ($)"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Male income ($)"</span><span class='op'>)</span> <span class='op'>+</span>
       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/lims.html'>xlim</a></span><span class='op'>(</span><span class='fl'>10000</span>, <span class='fl'>75000</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/lims.html'>ylim</a></span><span class='op'>(</span><span class='fl'>10000</span>, <span class='fl'>75000</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-87-1.png" width="624" /></p>
</div>
<p>However, if you are calling the <code>scale_x_continuous</code> and <code>scale_y_continuous</code> functions, you do not want to use <code>xlim</code> and <code>ylim</code>. Instead, you should set the <code>limit=</code> argument to the aforementioned functions. For example:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat2</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>B20004013</span>, y <span class='op'>=</span> <span class='va'>B20004007</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span> <span class='op'>+</span>
   <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Female income ($)"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Male income ($)"</span><span class='op'>)</span> <span class='op'>+</span>
   <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span>limit  <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10000</span>, <span class='fl'>75000</span><span class='op'>)</span>,labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org/reference/label_number.html'>comma_format</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
   <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>limit  <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10000</span>, <span class='fl'>75000</span><span class='op'>)</span>, labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org/reference/label_number.html'>comma_format</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-88-1.png" width="624" /></p>
</div>
<p>Note the use of the function <code>comma_format</code> from the <code>scale</code> that will add commas to large numbers</p>
<h3 id="axes-breaks">Axes breaks</h3>
<p>You can explicitly define the breaks with the <code>breaks</code> argument. Continuing with the last example, we get:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat2</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>B20004013</span>, y <span class='op'>=</span> <span class='va'>B20004007</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span> <span class='op'>+</span>
   <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Female income ($)"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Male income ($)"</span><span class='op'>)</span> <span class='op'>+</span>
   <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span>limit  <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10000</span>, <span class='fl'>75000</span><span class='op'>)</span>,labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org/reference/label_number.html'>comma_format</a></span><span class='op'>(</span><span class='op'>)</span>,breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10000</span>, <span class='fl'>30000</span>, <span class='fl'>50000</span>, <span class='fl'>70000</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
   <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>limit  <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10000</span>, <span class='fl'>75000</span><span class='op'>)</span>,labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org/reference/label_number.html'>comma_format</a></span><span class='op'>(</span><span class='op'>)</span>,breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10000</span>, <span class='fl'>30000</span>, <span class='fl'>50000</span>, <span class='fl'>70000</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-89-1.png" width="624" /></p>
</div>
<p>Note that the <code>breaks</code> argument can be used in conjunction with other arguments (as shown in this example), or by itself.</p>
<h3 id="axes-and-data-transformations">Axes and data transformations</h3>
<p>If you wish to apply a non-linear transformation to either axes (while preserving the untransformed axis values) add the <code>coord_trans</code> function as follows:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat2</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>B20004013</span>, y <span class='op'>=</span> <span class='va'>B20004007</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span> <span class='op'>+</span>
       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Female income ($)"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Male income ($)"</span><span class='op'>)</span> <span class='op'>+</span>
       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_trans.html'>coord_trans</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"log"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-90-1.png" width="624" /></p>
</div>
<p>You can also transform the y-axis by specifying the parameter <code>y=</code>. The <code>log</code> transformation defaults to the natural log. For a log base 10, use”<code>log10</code>” instead. For a square root transformation, use “<code>sqrt</code>”. For the inverse use “<code>reciprocal</code>”.</p>
<p>Advanced transformations can be called via the <code>scales</code> package. For example, to implement the box-cox transformation (with a power of <code>-0.3</code>), type:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat2</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>B20004013</span>, y <span class='op'>=</span> <span class='va'>B20004007</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span> <span class='op'>+</span>
       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Female income ($)"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Male income ($)"</span><span class='op'>)</span> <span class='op'>+</span>
       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_trans.html'>coord_trans</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org/reference/boxcox_trans.html'>boxcox_trans</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.3</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-91-1.png" width="624" /></p>
</div>
<p>Note that any statistical geom (such as the regression line) will be applied to the <em>un-transformed</em> data. So a linear model may end up looking non-linear after an axis transformation. If a linear fit is to be applied to the transformed data, a better alternative is to transform the values instead of the axes. The transformation can be done on the original data or it can be implemented in ggplot using the <code>scale_x_continuous</code> and <code>scale_y_continuous</code> functions such as:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat2</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>B20004013</span>, y <span class='op'>=</span> <span class='va'>B20004007</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span> <span class='op'>+</span>
       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"lm"</span>, se <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>+</span>
       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Female income ($)"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Male income ($)"</span><span class='op'>)</span> <span class='op'>+</span>
       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span>trans <span class='op'>=</span> <span class='st'>"log"</span>, breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>10000</span>,<span class='fl'>60000</span>,<span class='fl'>10000</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-92-1.png" width="624" /></p>
</div>
<p>The <code>scale_x_continuous</code> and <code>scale_y_continuous</code> functions will accept <code>scales</code> transformation parameters–e.g. <code>scale_x_continuous(trans = scales::boxcox_trans(-0.3))</code>. Note that the parameter <code>breaks</code> is not required but is used here to highlight the transformed nature of the axis.</p>
<h3 id="aspect-ratio">Aspect ratio</h3>
<p>You can impose an aspect ratio to your plot using the <code>coord_equal</code> function. For example, to set the axes units equal (in length) to one another set <code>ratio=1</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat2</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>B20004013</span>, y <span class='op'>=</span> <span class='va'>B20004007</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span> <span class='op'>+</span>
       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"lm"</span><span class='op'>)</span> <span class='op'>+</span>
       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Female income ($)"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Male income ($)"</span><span class='op'>)</span> <span class='op'>+</span>
       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_fixed.html'>coord_equal</a></span><span class='op'>(</span>ratio <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-93-1.png" width="624" /></p>
</div>
<h3 id="colors">Colors</h3>
<p>You can customize geom colors using one of two sets of color schemes: one for continuous values, the other for categorical (discrete) values.</p>
<table>
<thead>
<tr class="header">
<th>Continous</th>
<th>Categorical</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>scale_colour_gradient</td>
<td>scale_colour_hue</td>
</tr>
<tr class="even">
<td>scale_colour_gradient2</td>
<td>scale_colour_grey</td>
</tr>
<tr class="odd">
<td>scale_color_distiller</td>
<td>scale_colour_manual</td>
</tr>
<tr class="even">
<td>scale_fill_gradient2</td>
<td>scale_colour_brewer</td>
</tr>
<tr class="odd">
<td>scale_fill_gradient</td>
<td></td>
</tr>
<tr class="even">
<td>scale_fill_distiller</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="continuous-color-schemes">Continuous color schemes</h4>
<p>The following chunk of code summarizes dat2 by tallying the number of counties in each state and by computing the median county income values.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dat2.ct2</span> <span class='op'>&lt;-</span> <span class='va'>dat2</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>State</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarize</a></span><span class='op'>(</span>Counties <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span>, Income <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/median.html'>median</a></span><span class='op'>(</span><span class='va'>B20004001</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>The following chunk applies a green to red color gradient fill to each bar based on the median county incomes. Note that we are using the summarized count table (and not the original dat2 table). Recall that when plotting bars from counts that are already tabulated we must specify <code>stat="identity"</code> in the <code>geom_bar</code> function.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat2.ct2</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://forcats.tidyverse.org/reference/fct_reorder.html'>fct_reorder</a></span><span class='op'>(</span><span class='va'>State</span>, <span class='va'>Counties</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='va'>Counties</span>, fill <span class='op'>=</span> <span class='va'>Income</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
   <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_bar</a></span><span class='op'>(</span>stat <span class='op'>=</span> <span class='st'>"identity"</span><span class='op'>)</span> <span class='op'>+</span> 
   <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_gradient.html'>scale_fill_gradient</a></span><span class='op'>(</span>low <span class='op'>=</span> <span class='st'>"green"</span>, high <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-95-1.png" width="624" /></p>
</div>
<p>The following chunk applies a divergent color scheme while allowing one to specify the central value of this scheme. Note that the colors are symmetrical about the midpoint which may result in only a partial range of the full possible gradient of colors.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat2.ct2</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://forcats.tidyverse.org/reference/fct_reorder.html'>fct_reorder</a></span><span class='op'>(</span><span class='va'>State</span>, <span class='va'>Counties</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='va'>Counties</span>, fill <span class='op'>=</span> <span class='va'>Income</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
   <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_bar</a></span><span class='op'>(</span>stat <span class='op'>=</span> <span class='st'>"identity"</span><span class='op'>)</span> <span class='op'>+</span> 
   <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_gradient.html'>scale_fill_gradient2</a></span><span class='op'>(</span>low <span class='op'>=</span> <span class='st'>"darkred"</span>, mid <span class='op'>=</span> <span class='st'>"white"</span>,  high <span class='op'>=</span> <span class='st'>"darkgreen"</span>, midpoint <span class='op'>=</span> <span class='fl'>30892</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-96-1.png" width="624" /></p>
</div>
<p>In the last two chunk, we <em>filled</em> the bars with colors (note the use of functions with the string <code>_fill_</code>). When assigning color to point or line symbols, use the function with the <code>_colour_</code> string. For example:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat2.ct2</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='fu'><a href='https://forcats.tidyverse.org/reference/fct_reorder.html'>fct_reorder</a></span><span class='op'>(</span><span class='va'>State</span>, <span class='va'>Counties</span><span class='op'>)</span>, x <span class='op'>=</span> <span class='va'>Counties</span>, col <span class='op'>=</span> <span class='va'>Income</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
   <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
   <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_gradient.html'>scale_colour_gradient2</a></span><span class='op'>(</span>low <span class='op'>=</span> <span class='st'>"darkred"</span>, mid <span class='op'>=</span> <span class='st'>"white"</span>,  high <span class='op'>=</span> <span class='st'>"darkgreen"</span>, midpoint <span class='op'>=</span> <span class='fl'>30892</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-97-1.png" width="624" /></p>
</div>
<h4 id="discrete-color-schemes">Discrete color schemes</h4>
<p>In the following chunk, we assign colors manually to each level in the variable <code>Yield</code>. The order of the color names mirror the order of the variable levels.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat1l</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>Year</span>, <span class='va'>Yield</span>, col <span class='op'>=</span> <span class='va'>Crop</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"red"</span>, <span class='st'>"orange"</span>, <span class='st'>"green"</span>, <span class='st'>"blue"</span>, <span class='st'>"yellow"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-98-1.png" width="624" /></p>
</div>
<p>The following chunk applies a predefined discrete color scheme using one of Brewer’s preset qualitative colors, palette <code>Dark2</code>, to each level.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat1l</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>Year</span>, <span class='va'>Yield</span>, col <span class='op'>=</span> <span class='va'>Crop</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
              <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
              <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_brewer.html'>scale_colour_brewer</a></span><span class='op'>(</span>palette <span class='op'>=</span> <span class='st'>"Dark2"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-99-1.png" width="624" /></p>
</div>
<p>You can also apply sequential or divergent “Brewer” color schemes to variables having an implied order.</p>
<p>Let’s assume that there is an implied order to the crop types. For example, we’ll reorder the crop types based on their median yield (this creates an ordered factor from the <code>Crop</code> variable). We can then use one of Brewer’s sequential color schemes such as <code>Reds</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat1l</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>Year</span>, <span class='va'>Yield</span>, col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/reorder.factor.html'>reorder</a></span><span class='op'>(</span><span class='va'>Crop</span>, <span class='va'>Yield</span>, <span class='va'>median</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
              <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
              <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guides.html'>guides</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guide_legend.html'>guide_legend</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Crops"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>  
              <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_brewer.html'>scale_colour_brewer</a></span><span class='op'>(</span>palette <span class='op'>=</span> <span class='st'>"Reds"</span><span class='op'>)</span> 
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-100-1.png" width="624" /></p>
</div>
<p>Note that we’ve added a <code>guides</code> function to rename the legend title. This is not needed to generate the sequential colors.</p>
<p>To reverse the color scheme, set the <code>direction</code> argument to <code>-1</code> in the function <code>scale_colour_brewer</code></p>
<p>You can view a list of predifined Brewer color schemes using <code>RColorBrewer::display.brewer.all()</code>.</p>
<h3 id="adding-mathematical-symbols-to-a-plot">Adding mathematical symbols to a plot</h3>
<p>You can embed math symbols using <code>plotmath</code>’s mathematical expressions by wrapping these expressions in an <code>expression</code> function. For example:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat2</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>B20004013</span><span class='op'>^</span><span class='fl'>0.333</span>, y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>B20004007</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span> <span class='op'>+</span>
       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span> <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='op'>(</span><span class='st'>"Female income"</span><span class='op'>)</span> <span class='op'>^</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/plotmath.html'>frac</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span> <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='st'>"Male income"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-101-1.png" width="624" /></p>
</div>
<p>To view the full list of mathematical expressions, call for help <code>?plotmath</code>.</p>
<h2 id="faceting">Faceting</h2>
<p>The functionality of the <code>lattice</code> package are also available in <code>ggplot2</code>. It is called <em>faceting</em></p>
<h3 id="faceting-by-categorical-variables">Faceting by categorical variables</h3>
<h4 id="facet_wrap"><code>facet_wrap</code></h4>
<p>Faceting (or conditioning on a variable) can be implemented in <code>ggplot2</code> using the <code>facet_wrap</code> function.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat1l2</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Year</span>, y <span class='op'>=</span> <span class='va'>Yield</span>, color <span class='op'>=</span> <span class='va'>Crop</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_wrap.html'>facet_wrap</a></span><span class='op'>(</span> <span class='op'>~</span> <span class='va'>Country</span>, nrow <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-102-1.png" width="624" /></p>
</div>
<p>The parameter <code>~ Country</code> tells ggplot to condition the plots on country. If we wanted the plots to be stacked, we would set <code>nrow</code> to <code>2</code>.</p>
<p>We can also condition the plots on two variables such as <code>Crop</code> and <code>Country</code>. In essence, this stacks the categories (Note that we will also rotate the x-axis labels to prevent overlaps).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat1l2</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Year</span>, y<span class='op'>=</span><span class='va'>Yield</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>angle <span class='op'>=</span> <span class='fl'>90</span>, vjust <span class='op'>=</span> <span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_wrap.html'>facet_wrap</a></span><span class='op'>(</span><span class='va'>Crop</span> <span class='op'>~</span> <span class='va'>Country</span>, nrow <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-103-1.png" width="624" /></p>
</div>
<p>You can wrap the facet headers using the <code>label_wrap_gen</code> function as an argument value to <code>labeler</code>. For example, to wrap the <code>United States of America</code> value, we’ll specify the maximum number of characters per line using the <code>width</code> argument:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat1l2</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Year</span>, y<span class='op'>=</span><span class='va'>Yield</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>angle <span class='op'>=</span> <span class='fl'>90</span>, vjust <span class='op'>=</span> <span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_wrap.html'>facet_wrap</a></span><span class='op'>(</span><span class='va'>Crop</span> <span class='op'>~</span> <span class='va'>Country</span>, nrow <span class='op'>=</span> <span class='fl'>1</span>, labeller <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labellers.html'>label_wrap_gen</a></span><span class='op'>(</span>width <span class='op'>=</span> <span class='fl'>12</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-104-1.png" width="624" /></p>
</div>
<h4 id="facet_grid"><code>facet_grid</code></h4>
<p>The above <code>facet_wrap</code> example generated unique combinations of the variables <code>Crop</code> and <code>Country</code>. But such plots are usually best represented in a grid structure where one variable is spread along one axis and the other variable is spread along another axis of the plot layout. This can be accomplished using the <code>facet_grid</code> function:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat1l2</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Year</span>, y <span class='op'>=</span> <span class='va'>Yield</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_grid.html'>facet_grid</a></span><span class='op'>(</span> <span class='va'>Crop</span> <span class='op'>~</span> <span class='va'>Country</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-105-1.png" width="624" /></p>
</div>
<h3 id="faceting-by-continous-variables-advance">Faceting by continous variables (advance)</h3>
<p>In the above examples, we are faceting the plots based on a categorical variable: <code>Country</code> and/or <code>crop</code>. But what if we want to facet the plots based on a continuous variable? For example, we might be interested in comparing male and female incomes across different female income ranges. This requires that a new categorical field (a factor) be created assigning to each case (row) an income group. We can use the <code>cut</code> function to accomplish this task (we’ll also omit all values greater than 100,000):</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dat2c</span><span class='op'>$</span><span class='va'>incrng</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cut.html'>cut</a></span><span class='op'>(</span><span class='va'>dat2c</span><span class='op'>$</span><span class='cn'>F</span> , breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>25000</span>, <span class='fl'>50000</span>, <span class='fl'>75000</span>, <span class='fl'>100000</span><span class='op'>)</span> <span class='op'>)</span>
</code></pre>
</div>
</div>
<p>In this chunk of code, we create a new variable, <code>incrng</code>, which is assigned an income category group depending on which range <code>dat2c$F</code> (female income) falls into. The income interval breaks are defined in <code>breaks=</code>. In the output, you will note that the factor <code>incrng</code> defines a range of incomes (e.g. (<code>0</code> , <code>2.5e+04</code>]) where the parenthesis <code>(</code> indicates that the left-most value is exclusive and the bracket <code>]</code> indicates that the right-most value is inclusive.</p>
<p>However, because we did not create categories that covered all income values in <code>dat2c$F</code> we ended up with a few <code>NA</code>’s in the <code>incrng</code> column:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>dat2c</span><span class='op'>$</span><span class='va'>incrng</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>    (0,2.5e+04] (2.5e+04,5e+04] (5e+04,7.5e+04] (7.5e+04,1e+05] 
           9670            7633            1446              34 
           NA&#39;s 
             75 </code></pre>
</div>
<p>We will remove all rows associated with missing <code>incrng</code> values:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dat2c</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/na.fail.html'>na.omit</a></span><span class='op'>(</span><span class='va'>dat2c</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>We can list all unique levels in our newly created factor using the levels() function.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='va'>dat2c</span><span class='op'>$</span><span class='va'>incrng</span><span class='op'>)</span> 
</code></pre>
</div>
<pre><code>[1] &quot;(0,2.5e+04]&quot;     &quot;(2.5e+04,5e+04]&quot; &quot;(5e+04,7.5e+04]&quot;
[4] &quot;(7.5e+04,1e+05]&quot;</code></pre>
</div>
<p>The intervals are not meaningful displayed as is (particularly when scientific notation is adopted). So we will assign more meaningful names to our factor levels as follows:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='va'>dat2c</span><span class='op'>$</span><span class='va'>incrng</span><span class='op'>)</span> <span class='op'>&lt;-</span>  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Under 25k"</span>, <span class='st'>"25k-50k"</span>, <span class='st'>"50k-75k"</span>, <span class='st'>"75k-100k"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>dat2c</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>  State                 County Level Region   All     F     M
1    ak Aleutians East Borough   All   West 21953 20164 22940
2    ak Aleutians East Borough  NoHS   West 21953 19250 22885
3    ak Aleutians East Borough    HS   West 20770 19671 21192
4    ak Aleutians East Borough    AD   West 26383 26750 26352
5    ak Aleutians East Borough    BD   West 22431 19592 27875
6    ak Aleutians East Borough  Grad   West 74000 74000 71250
     incrng
1 Under 25k
2 Under 25k
3 Under 25k
4   25k-50k
5 Under 25k
6   50k-75k</code></pre>
</div>
<p>Note that the order in which the names are passed must match that of the original breaks.</p>
<p>Now we can facet male vs. female scatter plots by income ranges. We will also throw in a best fit line to the plots.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat2c</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='cn'>F</span>, y <span class='op'>=</span> <span class='va'>M</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>alpha<span class='op'>=</span><span class='fl'>0.2</span>, pch<span class='op'>=</span><span class='fl'>20</span><span class='op'>)</span> <span class='op'>+</span>
       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"lm"</span>, col <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span> <span class='op'>+</span>
       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_grid.html'>facet_grid</a></span><span class='op'>(</span> <span class='va'>.</span> <span class='op'>~</span> <span class='va'>incrng</span><span class='op'>)</span> 
</code></pre>
</div>
<p><img src="graphics_files/figure-html5/unnamed-chunk-111-1.png" width="624" /></p>
</div>
<p>One reason we would want to explore our data across different ranges of value is to assess the consistency in relationship between variables. In our example, this plot helps assess whether the relationship between male and female income is consistent across income groups.</p>
<h2 id="exporting-to-an-image">Exporting to an image</h2>
<p>you can export a ggplot figure to an image using the <code>ggsave</code> function. For example:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>p1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat1l2</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Year</span>, y <span class='op'>=</span> <span class='va'>Yield</span>, color <span class='op'>=</span> <span class='va'>Crop</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_wrap.html'>facet_wrap</a></span><span class='op'>(</span> <span class='op'>~</span> <span class='va'>Country</span>, nrow <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org/reference/label_number.html'>comma_format</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsave.html'>ggsave</a></span><span class='op'>(</span><span class='st'>"Figures/fig0.png"</span>, plot <span class='op'>=</span> <span class='va'>p1</span>, width <span class='op'>=</span> <span class='fl'>6</span>, height <span class='op'>=</span> <span class='fl'>2</span>, units <span class='op'>=</span> <span class='st'>"in"</span>, device <span class='op'>=</span> <span class='st'>"png"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p><img src="Figures/fig0.png" /></p>
<p>The width and height arguments are defined in units of inches, <code>in</code>. You can also specify these parameters in units of centimeters by setting units <code>= "cm"</code>. The <code>device</code> argument controls the image file type. Other file types include <code>"jpeg"</code>, <code>"tiff"</code>, <code>"bmp"</code> and <code>"svg"</code> just to name a few.</p>
<p>For greater control of the font sizes, you need to make use of the <code>theme</code> function when buiding the plot.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>p2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat1l2</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Year</span>, y <span class='op'>=</span> <span class='va'>Yield</span>, color <span class='op'>=</span> <span class='va'>Crop</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_wrap.html'>facet_wrap</a></span><span class='op'>(</span> <span class='op'>~</span> <span class='va'>Country</span>, nrow <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org/reference/label_number.html'>comma_format</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.text    <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>8</span>, family <span class='op'>=</span> <span class='st'>"mono"</span><span class='op'>)</span>,
        axis.title   <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>11</span>, face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span>,
        strip.text   <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>11</span>, face<span class='op'>=</span><span class='st'>"italic"</span>, family <span class='op'>=</span> <span class='st'>"serif"</span><span class='op'>)</span>,
        legend.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>10</span>, family <span class='op'>=</span> <span class='st'>"sans"</span><span class='op'>)</span>,
        legend.text  <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>8</span>,  color <span class='op'>=</span> <span class='st'>"grey40"</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsave.html'>ggsave</a></span><span class='op'>(</span><span class='st'>"Figures/fig1.png"</span>, plot <span class='op'>=</span> <span class='va'>p2</span>, width <span class='op'>=</span> <span class='fl'>6</span>, height <span class='op'>=</span> <span class='fl'>2</span>, units <span class='op'>=</span> <span class='st'>"in"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p><img src="Figures/fig1.png" /></p>
<p>The <code>family</code> argument controls the font type. It does not automatically access all the fonts in your operating system. The three R fonts accessible by default are “<code>serif</code>”, “<code>sans</code>” and “<code>mono</code>”. These are usually mapped to your system’s fonts.</p>
<p>To access other fonts on your operating system, you will need to make use of the <code>showtext</code> package. The package is not covered in this tutorial, instead, refer to the package’s website for instructions on using the package.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="reuse">Reuse</h3>
<p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
